{"ast":null,"code":"var _jsxFileName = \"d:\\\\formulario de horas\\\\FormularioHoras Version 1\\\\frontend\\\\src\\\\components\\\\FormularioHoras.tsx\",\n  _s = $RefreshSig$();\n// FormularioHoras.tsx\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\nimport { toast, Toaster } from 'sonner';\nimport { Calendar as CalendarIcon, Briefcase, Save, Pencil, ListChecks, ClipboardList, XCircle, PlusCircle, Loader2, Folder, Star, Minus, Plus, Info, Undo2, Clock } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { cn } from '../lib/utils';\nimport { Dialog, DialogContent, DialogTrigger, DialogHeader, DialogTitle, DialogDescription } from './ui/dialog';\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\nimport TablaHoras from './TablaHoras';\nimport { submitHours, getProjects, getProjectStages, getDisciplinesByStage, getActivitiesByDiscipline, getDailyActivities, deleteHour, updateHour } from '../api/horasApi';\n\n// Props e interfaces\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialFormData = employeeId => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '0',\n  note: ''\n});\nconst DRAFT_KEY = 'fh_form_draft_v1';\n\n// Helper: ordenar A-Z / 0-9\nconst sortAZ = arr => [...arr].sort((a, b) => a.localeCompare(b, 'es', {\n  numeric: true,\n  sensitivity: 'base'\n}));\n\n// Comparator: primero letras, luego números\nconst projectComparator = (a, b) => {\n  var _a$code, _b$code;\n  const aCode = ((_a$code = a.code) !== null && _a$code !== void 0 ? _a$code : '').trim();\n  const bCode = ((_b$code = b.code) !== null && _b$code !== void 0 ? _b$code : '').trim();\n  const aStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(aCode);\n  const bStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(bCode);\n  if (aStartsWithLetter !== bStartsWithLetter) return aStartsWithLetter ? -1 : 1;\n  // dentro del mismo grupo, ordenar natural A-Z/0-9\n  return aCode.localeCompare(bCode, 'es', {\n    numeric: true,\n    sensitivity: 'base'\n  });\n};\nconst FormularioHoras = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout,\n  onShowPowerBI\n}) => {\n  _s();\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState([]);\n  const [projects, setProjects] = useState([]);\n  const [stages, setStages] = useState([]);\n  const [disciplines, setDisciplines] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [editingActivityId, setEditingActivityId] = useState(null);\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\n  const [favorites, setFavorites] = useState([]);\n  const [sortDir, setSortDir] = useState('asc');\n  const [isTableModalOpen, setIsTableModalOpen] = useState(false);\n  const [isDirty, setIsDirty] = useState(false);\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null\n  });\n  const hoursInputRef = useRef(null);\n  const undoTimerRef = useRef(null);\n  const favScrollRef = useRef(null);\n  const handleFavWheel = useCallback(e => {\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n      e.preventDefault();\n      e.stopPropagation();\n      e.currentTarget.scrollLeft += e.deltaY;\n    }\n  }, []);\n  const selectedProjectName = useMemo(() => {\n    var _projects$find;\n    return ((_projects$find = projects.find(p => p.code === formData.project_code)) === null || _projects$find === void 0 ? void 0 : _projects$find.name) || '';\n  }, [formData.project_code, projects]);\n  const hoursNumber = useMemo(() => {\n    var _formData$hours;\n    const raw = String((_formData$hours = formData.hours) !== null && _formData$hours !== void 0 ? _formData$hours : '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n  const totalHoursToday = useMemo(() => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0), [dailyActivities]);\n  const [errors, setErrors] = useState({});\n  useEffect(() => {\n    const newErrors = {};\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\n    setErrors(newErrors);\n  }, [formData, hoursNumber]);\n  useEffect(() => {\n    const raw = localStorage.getItem(DRAFT_KEY);\n    if (raw) {\n      try {\n        const draft = JSON.parse(raw);\n        setFormData(prev => ({\n          ...prev,\n          ...draft,\n          employee_id: String(employeeId)\n        }));\n      } catch {}\n    }\n  }, [employeeId]);\n  useEffect(() => {\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(formData));\n  }, [formData]);\n  useEffect(() => {\n    const raw = localStorage.getItem(FAV_KEY);\n    if (raw) try {\n      setFavorites(JSON.parse(raw));\n    } catch {}\n  }, [FAV_KEY]);\n  const saveFavorites = next => {\n    setFavorites(next);\n    localStorage.setItem(FAV_KEY, JSON.stringify(next));\n  };\n  const currentFavObj = useMemo(() => {\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\n    return {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity\n    };\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\n  const isCurrentFavorite = useMemo(() => {\n    if (!currentFavObj) return false;\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\n  }, [favorites, currentFavObj]);\n  const toggleFavorite = () => {\n    if (!currentFavObj) {\n      toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');\n      return;\n    }\n    if (isCurrentFavorite) {\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\n      saveFavorites(next);\n      toast.message('Eliminado de favoritos');\n    } else {\n      saveFavorites([...favorites, currentFavObj]);\n      toast.success('Guardado en favoritos');\n    }\n  };\n  const visibleActivities = useMemo(() => {\n    let list = [...dailyActivities];\n    list.sort((a, b) => (a.id || '').localeCompare(b.id || ''));\n    if (sortDir === 'desc') list.reverse();\n    return list;\n  }, [dailyActivities, sortDir]);\n  useEffect(() => {\n    const base = initialFormData(employeeId);\n    const changed = JSON.stringify({\n      ...formData,\n      employee_id: undefined\n    }) !== JSON.stringify({\n      ...base,\n      employee_id: undefined\n    });\n    setIsDirty(changed || Boolean(editingActivityId));\n  }, [formData, editingActivityId, employeeId]);\n  const refreshDailyActivities = useCallback(async (date, id) => {\n    setLoading(p => ({\n      ...p,\n      dailyActivities: true\n    }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (e) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(e);\n    } finally {\n      setLoading(p => ({\n        ...p,\n        dailyActivities: false\n      }));\n    }\n  }, []);\n  const fetchProjects = useCallback(async () => {\n    setLoading(p => ({\n      ...p,\n      projects: true\n    }));\n    try {\n      const data = await getProjects();\n      const sorted = [...data].sort(projectComparator); // letras primero, luego números\n      setProjects(sorted);\n    } catch (e) {\n      toast.error('Error al cargar proyectos.');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        projects: false\n      }));\n    }\n  }, []);\n  const fetchStages = useCallback(async projectCode => {\n    if (!projectCode) return [];\n    setLoading(p => ({\n      ...p,\n      stages: true\n    }));\n    try {\n      const data = await getProjectStages(projectCode);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setStages(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar etapas.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        stages: false\n      }));\n    }\n  }, []);\n  const fetchDisciplines = useCallback(async (projectCode, stage) => {\n    if (!projectCode || !stage) return [];\n    setLoading(p => ({\n      ...p,\n      disciplines: true\n    }));\n    try {\n      const data = await getDisciplinesByStage(projectCode, stage);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setDisciplines(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        disciplines: false\n      }));\n    }\n  }, []);\n  const fetchActivities = useCallback(async (projectCode, stage, discipline) => {\n    if (!projectCode || !stage || !discipline) return [];\n    setLoading(p => ({\n      ...p,\n      activities: true\n    }));\n    try {\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setActivities(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar actividades.');\n      setActivities([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        activities: false\n      }));\n    }\n  }, []);\n  const applyFavorite = useCallback(async fav => {\n    try {\n      setFormData(prev => ({\n        ...prev,\n        project_code: fav.project_code,\n        phase: '',\n        discipline: '',\n        activity: ''\n      }));\n      const st = await fetchStages(fav.project_code);\n      if (st && st.includes(fav.phase)) {\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\n        if (ds && ds.includes(fav.discipline)) {\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\n          if (ac && ac.includes(fav.activity)) {\n            setFormData({\n              employee_id: String(employeeId),\n              project_code: fav.project_code,\n              phase: fav.phase,\n              discipline: fav.discipline,\n              activity: fav.activity,\n              hours: '0',\n              note: ''\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo aplicar el favorito');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n  const handleDateChange = date => {\n    if (date) setSelectedDate(date);\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: v\n    }));\n  };\n  const handleNoteKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) e.preventDefault();\n  };\n  const handleSelectChange = async (name, value) => {\n    const updated = {\n      ...formData,\n      [name]: value\n    };\n    switch (name) {\n      case 'project_code':\n        updated.phase = '';\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n        if (value) await fetchStages(value);\n        break;\n      case 'phase':\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setDisciplines([]);\n        setActivities([]);\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\n        break;\n      case 'discipline':\n        updated.activity = '';\n        setFormData(updated);\n        setActivities([]);\n        if (value && updated.project_code && updated.phase) await fetchActivities(updated.project_code, updated.phase, value);\n        break;\n      default:\n        setFormData(updated);\n    }\n  };\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n  const handleEditActivity = useCallback(async activity => {\n    try {\n      var _activity$hours;\n      if (activity.date) {\n        try {\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\n          setSelectedDate(d);\n        } catch {}\n      }\n      if (activity.project_code) {\n        await fetchStages(activity.project_code);\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n      }\n      setFormData({\n        employee_id: String(employeeId),\n        project_code: activity.project_code || '',\n        phase: activity.phase || '',\n        discipline: activity.discipline || '',\n        activity: activity.activity || '',\n        hours: String((_activity$hours = activity.hours) !== null && _activity$hours !== void 0 ? _activity$hours : '0'),\n        note: activity.note || ''\n      });\n      setEditingActivityId(String(activity.id));\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    } catch (e) {\n      console.error(e);\n      toast.error('Error al cargar la actividad para edición');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n  const [undoData, setUndoData] = useState(null);\n  const triggerUndoBanner = activity => {\n    setUndoData(activity);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\n  };\n  const handleUndoDelete = async () => {\n    if (!undoData) return;\n    const a = undoData;\n    setUndoData(null);\n    try {\n      await submitHours({\n        project_code: a.project_code,\n        phase: a.phase,\n        discipline: a.discipline,\n        activity: a.activity,\n        hours: a.hours,\n        note: a.note || '',\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        employee_id: employeeId\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      toast.success('Registro restaurado');\n    } catch (e) {\n      toast.error('No se pudo restaurar');\n    }\n  };\n  const coreSubmit = async () => {\n    const submissionData = {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity,\n      hours: hoursNumber,\n      note: formData.note || '',\n      date: format(selectedDate, 'yyyy-MM-dd'),\n      employee_id: employeeId\n    };\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\n    setLoading(p => ({\n      ...p,\n      submit: true\n    }));\n    try {\n      if (editingActivityId) {\n        await updateHour(editingActivityId, submissionData);\n      } else {\n        await submitHours(submissionData);\n      }\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\n        id: toastId,\n        duration: 1800\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess();\n      return true;\n    } catch (e) {\n      console.error(e);\n      toast.error('Ocurrió un error al guardar.', {\n        id: toastId\n      });\n      return false;\n    } finally {\n      setLoading(p => ({\n        ...p,\n        submit: false\n      }));\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (Object.keys(errors).length) {\n      toast.error('Revisa los campos marcados');\n      return;\n    }\n    const ok = await coreSubmit();\n    if (ok) resetForm();\n  };\n  const handleDelete = async id => {\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\n    try {\n      setLoading(p => ({\n        ...p,\n        delete: id\n      }));\n      await deleteHour(id);\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      if (prev) triggerUndoBanner(prev);\n      toast.error('Actividad eliminada');\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo eliminar');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        delete: null\n      }));\n    }\n  };\n  const adjustHours = delta => {\n    const current = hoursNumber || 0;\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\n    setFormData(prev => ({\n      ...prev,\n      hours: String(next)\n    }));\n  };\n  useEffect(() => {\n    const onKey = e => {\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\n        e.preventDefault();\n        (async () => {\n          if (!loading.submit) {\n            const ok = await coreSubmit();\n            if (ok) resetForm();\n          }\n        })();\n      }\n      if (e.key === 'Escape') {\n        resetForm();\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [coreSubmit, loading.submit, resetForm]);\n\n  // Navegar a la vista de permisos\n  const handleNavigateToPermissions = () => {\n    // La lógica de navegación se maneja en App.tsx\n  };\n\n  // Navegar a la vista de horas\n  const handleNavigateToHours = () => {\n    // La lógica de navegación se maneja en App.tsx\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-[#f2f6fd] text-foreground\",\n    children: [/*#__PURE__*/_jsxDEV(Toaster, {\n      position: \"top-right\",\n      richColors: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      employeeName: employeeName,\n      onLogout: onLogout,\n      onShowPowerBI: onShowPowerBI,\n      onNavigateToHours: handleNavigateToHours,\n      onNavigateToPermissions: handleNavigateToPermissions,\n      currentView: \"hours\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\n\n        /* 👉 Fuerza saltos de línea en textos sin espacios y evita desbordes */\n        .text-wrap, .text-wrap *{\n          overflow-wrap: anywhere;\n          word-break: break-word;\n          hyphens: auto;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-auto container p-4 sm:p-6 lg:p-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\",\n        children: [/*#__PURE__*/_jsxDEV(\"main\", {\n          className: cn('lg:col-span-3'),\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"relative z-10 flex flex-col text-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              className: \"relative items-center text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center gap-2\",\n                children: [editingActivityId ? /*#__PURE__*/_jsxDEV(Pencil, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 40\n                }, this) : /*#__PURE__*/_jsxDEV(PlusCircle, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 73\n                }, this), /*#__PURE__*/_jsxDEV(CardTitle, {\n                  className: \"text-center\",\n                  children: editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 531,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 529,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute right-4 top-4 text-xs\",\n                children: editingActivityId ? /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-2 py-1 rounded-full bg-amber-100 text-amber-800\",\n                  children: \"Editando\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 537,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\",\n                  children: \"Creando\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 539,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 535,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mt-2 text-sm text-muted-foreground\",\n                children: \"Registra tus horas del d\\xEDa para el proyecto seleccionado.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 542,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3 text-xs sm:text-sm text-foreground/80 flex-wrap justify-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(Briefcase, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 548,\n                    columnNumber: 21\n                  }, this), \" \", formData.project_code || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 547,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(ListChecks, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 551,\n                    columnNumber: 21\n                  }, this), \" \", formData.phase || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 550,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(Pencil, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 554,\n                    columnNumber: 21\n                  }, this), \" \", formData.discipline || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 553,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 557,\n                    columnNumber: 21\n                  }, this), \" \", formData.activity || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 556,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 546,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 528,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 w-full sm:max-w-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"inline-flex items-center gap-1\",\n                    children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 567,\n                      columnNumber: 23\n                    }, this), \" Fecha\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 566,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 565,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Popover, {\n                  children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n                    asChild: true,\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"outline\",\n                      className: cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground'),\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: format(selectedDate, 'PPP', {\n                          locale: es\n                        })\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 573,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 572,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 571,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n                    className: \"w-auto p-0\",\n                    align: \"start\",\n                    children: /*#__PURE__*/_jsxDEV(Calendar, {\n                      mode: \"single\",\n                      selected: selectedDate,\n                      onSelect: handleDateChange,\n                      initialFocus: true,\n                      locale: es\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 577,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 576,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 570,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"C\\xF3digo de Proyecto\",\n                    name: \"project_code\",\n                    value: formData.project_code,\n                    onValueChange: handleSelectChange,\n                    options: projects.map(p => ({\n                      value: p.code,\n                      label: p.code,\n                      dropdownLabel: `${p.code} - ${p.name}`\n                    })),\n                    placeholder: \"Seleccione un proyecto\",\n                    loading: loading.projects,\n                    disabled: loading.projects,\n                    icon: /*#__PURE__*/_jsxDEV(Briefcase, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 595,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 586,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\",\n                    children: \"Elige el proyecto para cargar los demas campos.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 598,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 585,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2 text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Folder, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 606,\n                        columnNumber: 72\n                      }, this), \" Nombre del Proyecto\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 606,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 605,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Input, {\n                    value: selectedProjectName,\n                    readOnly: true,\n                    className: \"bg-muted/50\",\n                    \"aria-label\": \"Nombre de proyecto seleccionado\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 608,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 604,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Etapa\",\n                    name: \"phase\",\n                    value: formData.phase,\n                    onValueChange: handleSelectChange,\n                    options: stages.map(s => ({\n                      value: s,\n                      label: s\n                    })),\n                    placeholder: \"Seleccione una etapa\",\n                    loading: loading.stages,\n                    disabled: !formData.project_code || loading.stages,\n                    icon: /*#__PURE__*/_jsxDEV(ListChecks, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 622,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 613,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-xs text-muted-foreground\",\n                    children: \"Etapas disponibles para el proyecto elegido.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 625,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 612,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Disciplina\",\n                    name: \"discipline\",\n                    value: formData.discipline,\n                    onValueChange: handleSelectChange,\n                    options: disciplines.map(d => ({\n                      value: d,\n                      label: d\n                    })),\n                    placeholder: \"Seleccione una disciplina\",\n                    loading: loading.disciplines,\n                    disabled: !formData.phase || loading.disciplines,\n                    icon: /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 639,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 630,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-xs text-muted-foreground\",\n                    children: \"Se filtran seg\\xFAn la etapa seleccionada.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 642,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 629,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full md:w-[320px] text-wrap\",\n                  children: /*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Actividad\",\n                    name: \"activity\",\n                    value: formData.activity,\n                    onValueChange: handleSelectChange,\n                    options: activities.map(a => ({\n                      value: a,\n                      label: a\n                    })),\n                    placeholder: \"Seleccione una actividad\",\n                    loading: loading.activities,\n                    disabled: !formData.discipline || loading.activities,\n                    icon: /*#__PURE__*/_jsxDEV(ClipboardList, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 656,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 647,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 646,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-col text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"hours\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Clock, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 665,\n                        columnNumber: 25\n                      }, this), \" Horas \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-destructive\",\n                        children: \"*\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 665,\n                        columnNumber: 61\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 664,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 663,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-1\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      size: \"icon\",\n                      className: \"h-10 w-10 shrink-0\",\n                      onClick: () => adjustHours(-0.5),\n                      \"aria-label\": \"Restar 0.5h\",\n                      children: /*#__PURE__*/_jsxDEV(Minus, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 679,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 671,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      size: \"icon\",\n                      className: \"h-10 w-10 shrink-0\",\n                      onClick: () => adjustHours(0.5),\n                      \"aria-label\": \"Sumar 0.5h\",\n                      children: /*#__PURE__*/_jsxDEV(Plus, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 691,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 683,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      id: \"hours\",\n                      name: \"hours\",\n                      type: \"number\",\n                      value: formData.hours,\n                      onChange: handleChange,\n                      min: \"0\",\n                      step: \"0.5\",\n                      ref: hoursInputRef,\n                      className: \"h-10 w-[100px] shrink-0 rounded-md mr-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 695,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: isCurrentFavorite ? 'default' : 'outline',\n                      className: \"h-10 shrink-0\",\n                      onClick: toggleFavorite,\n                      title: isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito',\n                      children: [/*#__PURE__*/_jsxDEV(Star, {\n                        className: \"h-4 w-4 mr-2\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 715,\n                        columnNumber: 25\n                      }, this), \" Favorito\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 708,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 669,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 662,\n                  columnNumber: 19\n                }, this), favorites.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    ref: favScrollRef,\n                    onWheel: handleFavWheel,\n                    className: \"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\",\n                    style: {\n                      overscrollBehaviorX: 'contain',\n                      overscrollBehaviorY: 'none',\n                      touchAction: 'pan-x'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex gap-2\",\n                      children: favorites.map((fav, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n                        type: \"button\",\n                        onClick: () => applyFavorite(fav),\n                        className: \"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\",\n                        title: `${fav.project_code} • ${fav.phase} • ${fav.discipline}`,\n                        children: [/*#__PURE__*/_jsxDEV(Star, {\n                          className: \"h-3.5 w-3.5\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 738,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-medium\",\n                          children: fav.activity\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 739,\n                          columnNumber: 31\n                        }, this)]\n                      }, idx, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 731,\n                        columnNumber: 29\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 729,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 723,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 722,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2 w-full text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"note\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Info, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 751,\n                        columnNumber: 25\n                      }, this), \" Nota (Opcional)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 750,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 749,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    id: \"note\",\n                    name: \"note\",\n                    value: formData.note,\n                    onChange: handleChange,\n                    onKeyDown: handleNoteKeyDown,\n                    rows: 2,\n                    className: \"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\",\n                    placeholder: \"Descripci\\xF3n breve del trabajo realizado\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 754,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 748,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 583,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-6 flex items-center justify-end gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  onClick: e => {\n                    e.preventDefault();\n                    handleSubmit(e);\n                  },\n                  disabled: loading.submit || Object.keys(errors).length > 0,\n                  className: \"h-11\",\n                  children: [loading.submit ? /*#__PURE__*/_jsxDEV(Loader2, {\n                    className: \"mr-2 h-4 w-4 animate-spin\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 775,\n                    columnNumber: 39\n                  }, this) : /*#__PURE__*/_jsxDEV(Save, {\n                    className: \"mr-2 h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 775,\n                    columnNumber: 91\n                  }, this), editingActivityId ? 'Actualizar' : 'Guardar']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 769,\n                  columnNumber: 19\n                }, this), editingActivityId && /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"button\",\n                  variant: \"outline\",\n                  onClick: resetForm,\n                  className: \"h-11\",\n                  children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                    className: \"mr-2 h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 781,\n                    columnNumber: 23\n                  }, this), \" Cancelar edici\\xF3n\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 780,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 768,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"lg:col-span-2\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"h-full text-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n                className: \"text-center flex items-center justify-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 794,\n                  columnNumber: 19\n                }, this), \"Actividades del D\\xEDa\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 793,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n                open: isTableModalOpen,\n                onOpenChange: setIsTableModalOpen,\n                children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n                  asChild: true,\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"button\",\n                    variant: \"outline\",\n                    size: \"icon\",\n                    title: \"Ver tabla de horas\",\n                    className: \"absolute right-4 top-4\",\n                    children: /*#__PURE__*/_jsxDEV(Clock, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 806,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 799,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 798,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n                  className: \"max-w-4xl max-h-[90vh] overflow-y-auto\",\n                  children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n                    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n                      children: \"Reporte de Horas\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 811,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(DialogDescription, {\n                      children: \"Visualiza el reporte de horas registradas por mes.\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 812,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 810,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(TablaHoras, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 816,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 809,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 797,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                    className: \"h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 822,\n                    columnNumber: 21\n                  }, this), \" \", format(selectedDate, 'PPP', {\n                    locale: es\n                  })]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 821,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\",\n                  children: [\"Total registros: \", dailyActivities.length]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 824,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 820,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 792,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: loading.dailyActivities ? /*#__PURE__*/_jsxDEV(ActivityListSkeleton, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 832,\n                columnNumber: 19\n              }, this) : visibleActivities.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\",\n                  children: visibleActivities.map(activity => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-wrap\",\n                    children: /*#__PURE__*/_jsxDEV(ActivityItem, {\n                      activity: activity,\n                      onEdit: handleEditActivity,\n                      onDelete: handleDelete\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 839,\n                      columnNumber: 27\n                    }, this)\n                  }, activity.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 838,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 836,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pt-3\",\n                  children: /*#__PURE__*/_jsxDEV(TotalHoursProgress, {\n                    totalHours: totalHoursToday,\n                    selectedDate: selectedDate\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 848,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 847,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(EmptyState, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 852,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 830,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 791,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 790,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 523,\n      columnNumber: 7\n    }, this), undoData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm\",\n        children: \"Registro eliminado.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 863,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        size: \"sm\",\n        variant: \"outline\",\n        onClick: handleUndoDelete,\n        children: [/*#__PURE__*/_jsxDEV(Undo2, {\n          className: \"h-4 w-4 mr-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 865,\n          columnNumber: 9\n        }, this), \" Deshacer\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 864,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 862,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 499,\n    columnNumber: 5\n  }, this);\n};\n_s(FormularioHoras, \"t6A8J/f6QUE5UtRQ6n7UwlFrihI=\");\n_c = FormularioHoras;\nexport default FormularioHoras;\nvar _c;\n$RefreshReg$(_c, \"FormularioHoras\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","format","parseISO","es","Header","toast","Toaster","Calendar","CalendarIcon","Briefcase","Save","Pencil","ListChecks","ClipboardList","XCircle","PlusCircle","Loader2","Folder","Star","Minus","Plus","Info","Undo2","Clock","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","cn","Dialog","DialogContent","DialogTrigger","DialogHeader","DialogTitle","DialogDescription","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","TablaHoras","submitHours","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","getDailyActivities","deleteHour","updateHour","jsxDEV","_jsxDEV","Fragment","_Fragment","initialFormData","employeeId","employee_id","String","project_code","phase","discipline","activity","hours","note","DRAFT_KEY","sortAZ","arr","sort","a","b","localeCompare","numeric","sensitivity","projectComparator","_a$code","_b$code","aCode","code","trim","bCode","aStartsWithLetter","test","bStartsWithLetter","FormularioHoras","onSuccess","employeeName","onLogout","onShowPowerBI","_s","formData","setFormData","selectedDate","setSelectedDate","Date","dailyActivities","setDailyActivities","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","editingActivityId","setEditingActivityId","FAV_KEY","favorites","setFavorites","sortDir","setSortDir","isTableModalOpen","setIsTableModalOpen","isDirty","setIsDirty","loading","setLoading","submit","delete","hoursInputRef","undoTimerRef","favScrollRef","handleFavWheel","e","Math","abs","deltaY","deltaX","preventDefault","stopPropagation","currentTarget","scrollLeft","selectedProjectName","_projects$find","find","p","name","hoursNumber","_formData$hours","raw","replace","n","Number","isFinite","totalHoursToday","reduce","sum","errors","setErrors","newErrors","localStorage","getItem","draft","JSON","parse","prev","setItem","stringify","saveFavorites","next","currentFavObj","isCurrentFavorite","some","f","toggleFavorite","error","filter","message","success","visibleActivities","list","id","reverse","base","changed","undefined","Boolean","refreshDailyActivities","date","dateString","acts","console","fetchProjects","data","sorted","fetchStages","projectCode","cleaned","v","map","fetchDisciplines","stage","fetchActivities","applyFavorite","fav","st","includes","ds","ac","handleDateChange","handleChange","value","target","handleNoteKeyDown","key","shiftKey","handleSelectChange","updated","resetForm","handleEditActivity","_activity$hours","d","window","scrollTo","top","behavior","undoData","setUndoData","triggerUndoBanner","current","clearTimeout","setTimeout","handleUndoDelete","coreSubmit","submissionData","toastId","duration","handleSubmit","Object","keys","length","ok","handleDelete","adjustHours","delta","max","round","onKey","ctrlKey","metaKey","toLowerCase","addEventListener","removeEventListener","handleNavigateToPermissions","handleNavigateToHours","className","children","position","richColors","fileName","_jsxFileName","lineNumber","columnNumber","onNavigateToHours","onNavigateToPermissions","currentView","asChild","variant","locale","align","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","required","readOnly","s","htmlFor","type","size","onClick","onChange","min","step","ref","title","onWheel","style","overscrollBehaviorX","overscrollBehaviorY","touchAction","idx","onKeyDown","rows","open","onOpenChange","onEdit","onDelete","totalHours","_c","$RefreshReg$"],"sources":["d:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioHoras.tsx"],"sourcesContent":["// FormularioHoras.tsx\r\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport Header from './Header';\r\n\r\nimport { toast, Toaster } from 'sonner';\r\nimport {\r\n  Calendar as CalendarIcon,\r\n  Briefcase,\r\n  Save,\r\n  Pencil,\r\n  ListChecks,\r\n  ClipboardList,\r\n  XCircle,\r\n  PlusCircle,\r\n  Loader2,\r\n  Folder,\r\n  Star,\r\n  ArrowUpDown,\r\n  Minus,\r\n  Plus,\r\n  Info,\r\n  Undo2,\r\n  Clock,\r\n  BarChart2,\r\n} from 'lucide-react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Calendar } from './ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\r\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from './ui/tabs';\r\nimport { cn } from '../lib/utils';\r\nimport { Dialog, DialogContent, DialogTrigger, DialogHeader, DialogTitle, DialogDescription } from './ui/dialog';\r\n\r\nimport { FormSelect } from './formulario/FormSelect';\r\nimport { ActivityItem } from './formulario/ActivityItem';\r\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\r\nimport { EmptyState } from './formulario/EmptyState';\r\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\r\nimport TablaHoras from './TablaHoras';\r\n\r\nimport {\r\n  submitHours,\r\n  getProjects,\r\n  getProjectStages,\r\n  getDisciplinesByStage,\r\n  getActivitiesByDiscipline,\r\n  getDailyActivities,\r\n  deleteHour,\r\n  updateHour,\r\n  type DailyActivity,\r\n} from '../api/horasApi';\r\n\r\n// Props e interfaces\r\ninterface FormularioHorasProps {\r\n  onSuccess: () => void;\r\n  employeeId: number;\r\n  employeeName: string;\r\n  onLogout: () => void;\r\n  onShowPowerBI: () => void;\r\n  onNavigateToHours: () => void;\r\n  onNavigateToPermissions: () => void;\r\n}\r\n\r\ninterface Project { code: string; name: string }\r\n\r\ntype Activity = DailyActivity;\r\n\r\nconst initialFormData = (employeeId: number) => ({\r\n  employee_id: String(employeeId),\r\n  project_code: '',\r\n  phase: '',\r\n  discipline: '',\r\n  activity: '',\r\n  hours: '0',\r\n  note: '',\r\n});\r\n\r\nconst DRAFT_KEY = 'fh_form_draft_v1';\r\n\r\n// Helper: ordenar A-Z / 0-9\r\nconst sortAZ = (arr: string[]) =>\r\n  [...arr].sort((a, b) => a.localeCompare(b, 'es', { numeric: true, sensitivity: 'base' }));\r\n\r\n// Comparator: primero letras, luego números\r\nconst projectComparator = (a: Project, b: Project) => {\r\n  const aCode = (a.code ?? '').trim();\r\n  const bCode = (b.code ?? '').trim();\r\n  const aStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(aCode);\r\n  const bStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(bCode);\r\n  if (aStartsWithLetter !== bStartsWithLetter) return aStartsWithLetter ? -1 : 1;\r\n  // dentro del mismo grupo, ordenar natural A-Z/0-9\r\n  return aCode.localeCompare(bCode, 'es', { numeric: true, sensitivity: 'base' });\r\n};\r\n\r\nconst FormularioHoras: React.FC<FormularioHorasProps> = ({ onSuccess, employeeId, employeeName, onLogout, onShowPowerBI }) => {\r\n  const [formData, setFormData] = useState(initialFormData(employeeId));\r\n  const [selectedDate, setSelectedDate] = useState(new Date());\r\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\r\n  const [projects, setProjects] = useState<Project[]>([]);\r\n  const [stages, setStages] = useState<string[]>([]);\r\n  const [disciplines, setDisciplines] = useState<string[]>([]);\r\n  const [activities, setActivities] = useState<string[]>([]);\r\n  const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\r\n\r\n  type Favorite = { project_code: string; phase: string; discipline: string; activity: string };\r\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\r\n  const [favorites, setFavorites] = useState<Favorite[]>([]);\r\n\r\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('asc');\r\n  const [isTableModalOpen, setIsTableModalOpen] = useState<boolean>(false);\r\n  const [isDirty, setIsDirty] = useState<boolean>(false);\r\n  const [loading, setLoading] = useState({\r\n    submit: false,\r\n    projects: true,\r\n    stages: false,\r\n    disciplines: false,\r\n    activities: false,\r\n    dailyActivities: true,\r\n    delete: null as string | null,\r\n  });\r\n\r\n  const hoursInputRef = useRef<HTMLInputElement | null>(null);\r\n  const undoTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const favScrollRef = useRef<HTMLDivElement | null>(null);\r\n  const handleFavWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\r\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.currentTarget.scrollLeft += e.deltaY;\r\n    }\r\n  }, []);\r\n\r\n  const selectedProjectName = useMemo(\r\n    () => projects.find(p => p.code === formData.project_code)?.name || '',\r\n    [formData.project_code, projects]\r\n  );\r\n  const hoursNumber = useMemo(() => {\r\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\r\n    const n = Number(raw);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }, [formData.hours]);\r\n  const totalHoursToday = useMemo(\r\n    () => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0),\r\n    [dailyActivities]\r\n  );\r\n\r\n  const [errors, setErrors] = useState<Partial<Record<keyof ReturnType<typeof initialFormData>, string>>>({});\r\n  useEffect(() => {\r\n    const newErrors: typeof errors = {};\r\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\r\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\r\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\r\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\r\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\r\n    setErrors(newErrors);\r\n  }, [formData, hoursNumber]);\r\n\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(DRAFT_KEY);\r\n    if (raw) { try {\r\n      const draft = JSON.parse(raw);\r\n      setFormData((prev) => ({ ...prev, ...draft, employee_id: String(employeeId) }));\r\n    } catch {} }\r\n  }, [employeeId]);\r\n  useEffect(() => { localStorage.setItem(DRAFT_KEY, JSON.stringify(formData)); }, [formData]);\r\n\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(FAV_KEY);\r\n    if (raw) try { setFavorites(JSON.parse(raw)); } catch {}\r\n  }, [FAV_KEY]);\r\n  const saveFavorites = (next: Favorite[]) => { setFavorites(next); localStorage.setItem(FAV_KEY, JSON.stringify(next)); };\r\n\r\n  const currentFavObj = useMemo(() => {\r\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\r\n    return { project_code: formData.project_code, phase: formData.phase, discipline: formData.discipline, activity: formData.activity } as Favorite;\r\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\r\n  const isCurrentFavorite = useMemo(() => {\r\n    if (!currentFavObj) return false;\r\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\r\n  }, [favorites, currentFavObj]);\r\n\r\n  const toggleFavorite = () => {\r\n    if (!currentFavObj) { toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos'); return; }\r\n    if (isCurrentFavorite) {\r\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\r\n      saveFavorites(next);\r\n      toast.message('Eliminado de favoritos');\r\n    } else {\r\n      saveFavorites([...favorites, currentFavObj]);\r\n      toast.success('Guardado en favoritos');\r\n    }\r\n  };\r\n\r\n  const visibleActivities = useMemo(() => {\r\n    let list = [...dailyActivities];\r\n    list.sort((a, b) => (a.id || '').localeCompare(b.id || ''));\r\n    if (sortDir === 'desc') list.reverse();\r\n    return list;\r\n  }, [dailyActivities, sortDir]);\r\n\r\n  useEffect(() => {\r\n    const base = initialFormData(employeeId);\r\n    const changed = JSON.stringify({ ...formData, employee_id: undefined }) !== JSON.stringify({ ...base, employee_id: undefined });\r\n    setIsDirty(changed || Boolean(editingActivityId));\r\n  }, [formData, editingActivityId, employeeId]);\r\n\r\n  const refreshDailyActivities = useCallback(async (date: Date, id: string) => {\r\n    setLoading((p) => ({ ...p, dailyActivities: true }));\r\n    try {\r\n      const dateString = format(date, 'yyyy-MM-dd');\r\n      const acts = await getDailyActivities(dateString, Number(id));\r\n      setDailyActivities(acts);\r\n    } catch (e) {\r\n      toast.error('Error al cargar las actividades del día.');\r\n      console.error(e);\r\n    } finally {\r\n      setLoading((p) => ({ ...p, dailyActivities: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchProjects = useCallback(async () => {\r\n    setLoading((p) => ({ ...p, projects: true }));\r\n    try {\r\n      const data = await getProjects();\r\n      const sorted = [...data].sort(projectComparator); // letras primero, luego números\r\n      setProjects(sorted);\r\n    } catch (e) {\r\n      toast.error('Error al cargar proyectos.');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, projects: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchStages = useCallback(async (projectCode: string) => {\r\n    if (!projectCode) return [] as string[];\r\n    setLoading((p) => ({ ...p, stages: true }));\r\n    try {\r\n      const data = await getProjectStages(projectCode);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setStages(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar etapas.');\r\n      setStages([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, stages: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\r\n    if (!projectCode || !stage) return [] as string[];\r\n    setLoading((p) => ({ ...p, disciplines: true }));\r\n    try {\r\n      const data = await getDisciplinesByStage(projectCode, stage);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setDisciplines(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar disciplinas.');\r\n      setDisciplines([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, disciplines: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchActivities = useCallback(async (projectCode: string, stage: string, discipline: string) => {\r\n    if (!projectCode || !stage || !discipline) return [] as string[];\r\n    setLoading((p) => ({ ...p, activities: true }));\r\n    try {\r\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setActivities(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar actividades.');\r\n      setActivities([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, activities: false }));\r\n    }\r\n  }, []);\r\n\r\n  const applyFavorite = useCallback(async (fav: Favorite) => {\r\n    try {\r\n      setFormData((prev) => ({ ...prev, project_code: fav.project_code, phase: '', discipline: '', activity: '' }));\r\n      const st = await fetchStages(fav.project_code);\r\n      if (st && st.includes(fav.phase)) {\r\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\r\n        if (ds && ds.includes(fav.discipline)) {\r\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\r\n          if (ac && ac.includes(fav.activity)) {\r\n            setFormData({\r\n              employee_id: String(employeeId),\r\n              project_code: fav.project_code,\r\n              phase: fav.phase,\r\n              discipline: fav.discipline,\r\n              activity: fav.activity,\r\n              hours: '0',\r\n              note: '',\r\n            });\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo aplicar el favorito');\r\n    }\r\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\r\n\r\n  useEffect(() => { fetchProjects(); }, [fetchProjects]);\r\n  useEffect(() => { refreshDailyActivities(selectedDate, String(employeeId)); }, [selectedDate, employeeId, refreshDailyActivities]);\r\n\r\n  const handleDateChange = (date?: Date) => { if (date) setSelectedDate(date); };\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    const v = name === 'hours' ? value.replace(',', '.') : value;\r\n    setFormData((prev) => ({ ...prev, [name]: v }));\r\n  };\r\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => { if (e.key === 'Enter' && !e.shiftKey) e.preventDefault(); };\r\n\r\n  const handleSelectChange = async (name: keyof ReturnType<typeof initialFormData>, value: string) => {\r\n    const updated = { ...formData, [name]: value } as ReturnType<typeof initialFormData>;\r\n    switch (name) {\r\n      case 'project_code':\r\n        updated.phase = ''; updated.discipline = ''; updated.activity = '';\r\n        setFormData(updated); setStages([]); setDisciplines([]); setActivities([]);\r\n        if (value) await fetchStages(value);\r\n        break;\r\n      case 'phase':\r\n        updated.discipline = ''; updated.activity = '';\r\n        setFormData(updated); setDisciplines([]); setActivities([]);\r\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\r\n        break;\r\n      case 'discipline':\r\n        updated.activity = '';\r\n        setFormData(updated); setActivities([]);\r\n        if (value && updated.project_code && updated.phase) await fetchActivities(updated.project_code, updated.phase, value);\r\n        break;\r\n      default:\r\n        setFormData(updated);\r\n    }\r\n  };\r\n\r\n  const resetForm = useCallback(() => {\r\n    setFormData(initialFormData(employeeId));\r\n    setEditingActivityId(null);\r\n  }, [employeeId]);\r\n\r\n  const handleEditActivity = useCallback(async (activity: Activity) => {\r\n    try {\r\n      if (activity.date) {\r\n        try {\r\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\r\n          setSelectedDate(d);\r\n        } catch {}\r\n      }\r\n      if (activity.project_code) {\r\n        await fetchStages(activity.project_code);\r\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\r\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\r\n      }\r\n      setFormData({\r\n        employee_id: String(employeeId),\r\n        project_code: activity.project_code || '',\r\n        phase: activity.phase || '',\r\n        discipline: activity.discipline || '',\r\n        activity: activity.activity || '',\r\n        hours: String(activity.hours ?? '0'),\r\n        note: activity.note || '',\r\n      });\r\n      setEditingActivityId(String(activity.id));\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Error al cargar la actividad para edición');\r\n    }\r\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\r\n\r\n  const [undoData, setUndoData] = useState<Activity | null>(null);\r\n  const triggerUndoBanner = (activity: Activity) => {\r\n    setUndoData(activity);\r\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\r\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\r\n  };\r\n  const handleUndoDelete = async () => {\r\n    if (!undoData) return;\r\n    const a = undoData; setUndoData(null);\r\n    try {\r\n      await submitHours({\r\n        project_code: a.project_code,\r\n        phase: a.phase,\r\n        discipline: a.discipline,\r\n        activity: a.activity,\r\n        hours: a.hours,\r\n        note: a.note || '',\r\n        date: format(selectedDate, 'yyyy-MM-dd'),\r\n        employee_id: employeeId,\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      toast.success('Registro restaurado');\r\n    } catch (e) {\r\n      toast.error('No se pudo restaurar');\r\n    }\r\n  };\r\n\r\n  const coreSubmit = async () => {\r\n    const submissionData = {\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n      hours: hoursNumber,\r\n      note: formData.note || '',\r\n      date: format(selectedDate, 'yyyy-MM-dd'),\r\n      employee_id: employeeId,\r\n    };\r\n\r\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\r\n    setLoading((p) => ({ ...p, submit: true }));\r\n\r\n    try {\r\n      if (editingActivityId) { await updateHour(editingActivityId, submissionData); }\r\n      else { await submitHours(submissionData); }\r\n\r\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, { id: toastId, duration: 1800 });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      onSuccess?.();\r\n      return true;\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Ocurrió un error al guardar.', { id: toastId });\r\n      return false;\r\n    } finally {\r\n      setLoading((p) => ({ ...p, submit: false }));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (Object.keys(errors).length) { toast.error('Revisa los campos marcados'); return; }\r\n    const ok = await coreSubmit();\r\n    if (ok) resetForm();\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\r\n    try {\r\n      setLoading(p => ({ ...p, delete: id }));\r\n      await deleteHour(id);\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      if (prev) triggerUndoBanner(prev);\r\n      toast.error('Actividad eliminada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo eliminar');\r\n    } finally {\r\n      setLoading(p => ({ ...p, delete: null }));\r\n    }\r\n  };\r\n\r\n  const adjustHours = (delta: number) => {\r\n    const current = hoursNumber || 0;\r\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\r\n    setFormData((prev) => ({ ...prev, hours: String(next) }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\r\n        e.preventDefault();\r\n        (async () => { if (!loading.submit) { const ok = await coreSubmit(); if (ok) resetForm(); } })();\r\n      }\r\n      if (e.key === 'Escape') { resetForm(); }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [coreSubmit, loading.submit, resetForm]);\r\n\r\n  // Navegar a la vista de permisos\r\n  const handleNavigateToPermissions = () => {\r\n    // La lógica de navegación se maneja en App.tsx\r\n  };\r\n\r\n  // Navegar a la vista de horas\r\n  const handleNavigateToHours = () => {\r\n    // La lógica de navegación se maneja en App.tsx\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#f2f6fd] text-foreground\">\r\n      <Toaster position=\"top-right\" richColors />\r\n      <Header\r\n        employeeName={employeeName}\r\n        onLogout={onLogout}\r\n        onShowPowerBI={onShowPowerBI}\r\n        onNavigateToHours={handleNavigateToHours}\r\n        onNavigateToPermissions={handleNavigateToPermissions}\r\n        currentView=\"hours\"\r\n      />\r\n\r\n      <style>{`\r\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\r\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\r\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\r\n\r\n        /* 👉 Fuerza saltos de línea en textos sin espacios y evita desbordes */\r\n        .text-wrap, .text-wrap *{\r\n          overflow-wrap: anywhere;\r\n          word-break: break-word;\r\n          hyphens: auto;\r\n        }\r\n      `}</style>\r\n\r\n      <div className=\"mx-auto container p-4 sm:p-6 lg:p-8\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\">\r\n          {/* PRINCIPAL */}\r\n          <main className={cn('lg:col-span-3')}>\r\n            <Card className=\"relative z-10 flex flex-col text-wrap\">\r\n              <CardHeader className=\"relative items-center text-center\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  {editingActivityId ? <Pencil className=\"h-5 w-5\" /> : <PlusCircle className=\"h-5 w-5\" />}\r\n                  <CardTitle className=\"text-center\">\r\n                    {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\r\n                  </CardTitle>\r\n                </div>\r\n                <div className=\"absolute right-4 top-4 text-xs\">\r\n                  {editingActivityId ? (\r\n                    <span className=\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\">Editando</span>\r\n                  ) : (\r\n                    <span className=\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\">Creando</span>\r\n                  )}\r\n                </div>\r\n                <p className=\"mt-2 text-sm text-muted-foreground\">\r\n                  Registra tus horas del día para el proyecto seleccionado.\r\n                </p>\r\n\r\n                <div className=\"mt-3 text-xs sm:text-sm text-foreground/80 flex-wrap justify-center gap-2\">\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Briefcase className=\"h-3.5 w-3.5\" /> {formData.project_code || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ListChecks className=\"h-3.5 w-3.5\" /> {formData.phase || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Pencil className=\"h-3.5 w-3.5\" /> {formData.discipline || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ClipboardList className=\"h-3.5 w-3.5\" /> {formData.activity || '—'}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {/* Fecha */}\r\n                <div className=\"mb-4 w-full sm:max-w-xs\">\r\n                  <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                    <span className=\"inline-flex items-center gap-1\">\r\n                      <CalendarIcon className=\"h-4 w-4\" /> Fecha\r\n                    </span>\r\n                  </label>\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button variant=\"outline\" className={cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground')}>\r\n                        <span>{format(selectedDate, 'PPP', { locale: es })}</span>\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                      <Calendar mode=\"single\" selected={selectedDate} onSelect={handleDateChange} initialFocus locale={es} />\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                </div>\r\n\r\n                {/* GRID: columna izquierda más estrecha */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\">\r\n                  {/* Código de Proyecto (col izq) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Código de Proyecto\"\r\n                      name=\"project_code\"\r\n                      value={formData.project_code}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={projects.map((p) => ({ value: p.code, label: p.code, dropdownLabel: `${p.code} - ${p.name}` }))}\r\n                      placeholder=\"Seleccione un proyecto\"\r\n                      loading={loading.projects}\r\n                      disabled={loading.projects}\r\n                      icon={<Briefcase className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\">\r\n                      Elige el proyecto para cargar los demas campos.\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Nombre del Proyecto (col der) */}\r\n                  <div className=\"space-y-2 text-wrap\">\r\n                    <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\"><Folder className=\"h-4 w-4\" /> Nombre del Proyecto</span>\r\n                    </label>\r\n                    <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" aria-label=\"Nombre de proyecto seleccionado\" />\r\n                  </div>\r\n\r\n                  {/* Etapa (izq) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Etapa\"\r\n                      name=\"phase\"\r\n                      value={formData.phase}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={stages.map((s) => ({ value: s, label: s }))}\r\n                      placeholder=\"Seleccione una etapa\"\r\n                      loading={loading.stages}\r\n                      disabled={!formData.project_code || loading.stages}\r\n                      icon={<ListChecks className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Etapas disponibles para el proyecto elegido.</p>\r\n                  </div>\r\n\r\n                  {/* Disciplina (der) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Disciplina\"\r\n                      name=\"discipline\"\r\n                      value={formData.discipline}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\r\n                      placeholder=\"Seleccione una disciplina\"\r\n                      loading={loading.disciplines}\r\n                      disabled={!formData.phase || loading.disciplines}\r\n                      icon={<Pencil className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Se filtran según la etapa seleccionada.</p>\r\n                  </div>\r\n\r\n                  {/* Actividad (izq) */}\r\n                  <div className=\"w-full md:w-[320px] text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Actividad\"\r\n                      name=\"activity\"\r\n                      value={formData.activity}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={activities.map((a) => ({ value: a, label: a }))}\r\n                      placeholder=\"Seleccione una actividad\"\r\n                      loading={loading.activities}\r\n                      disabled={!formData.discipline || loading.activities}\r\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Horas (der) – input a la izquierda, botones a la derecha */}\r\n                  <div className=\"flex flex-col text-wrap\">\r\n                    <label htmlFor=\"hours\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Clock className=\"h-4 w-4\" /> Horas <span className=\"text-destructive\">*</span>\r\n                      </span>\r\n                    </label>\r\n\r\n                    <div className=\"flex items-center gap-1\">\r\n                      {/* Botón Restar */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(-0.5)}\r\n                        aria-label=\"Restar 0.5h\"\r\n                      >\r\n                        <Minus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      {/* Botón Sumar */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(0.5)}\r\n                        aria-label=\"Sumar 0.5h\"\r\n                      >\r\n                        <Plus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      {/* Input de horas */}\r\n                      <Input\r\n                        id=\"hours\"\r\n                        name=\"hours\"\r\n                        type=\"number\"\r\n                        value={formData.hours}\r\n                        onChange={handleChange}\r\n                        min=\"0\"\r\n                        step=\"0.5\"\r\n                        ref={hoursInputRef}\r\n                        className=\"h-10 w-[100px] shrink-0 rounded-md mr-0\"\r\n                      />\r\n\r\n                      {/* Botón Favorito */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={isCurrentFavorite ? 'default' : 'outline'}\r\n                        className=\"h-10 shrink-0\"\r\n                        onClick={toggleFavorite}\r\n                        title={isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito'}\r\n                      >\r\n                        <Star className=\"h-4 w-4 mr-2\" /> Favorito\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Chips de favoritos (ocupa ambas columnas) */}\r\n                  {favorites.length > 0 && (\r\n                    <div className=\"md:col-span-2\">\r\n                      <div\r\n                        ref={favScrollRef}\r\n                        onWheel={handleFavWheel}\r\n                        className=\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\"\r\n                        style={{ overscrollBehaviorX: 'contain', overscrollBehaviorY: 'none', touchAction: 'pan-x' }}\r\n                      >\r\n                        <div className=\"flex gap-2\">\r\n                          {favorites.map((fav, idx) => (\r\n                            <button\r\n                              key={idx}\r\n                              type=\"button\"\r\n                              onClick={() => applyFavorite(fav)}\r\n                              className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\"\r\n                              title={`${fav.project_code} • ${fav.phase} • ${fav.discipline}`}\r\n                            >\r\n                              <Star className=\"h-3.5 w-3.5\" />\r\n                              <span className=\"font-medium\">{fav.activity}</span>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Nota (Opcional) – 2 líneas */}\r\n                  <div className=\"md:col-span-2 w-full text-wrap\">\r\n                    <label htmlFor=\"note\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Info className=\"h-4 w-4\" /> Nota (Opcional)\r\n                      </span>\r\n                    </label>\r\n                    <textarea\r\n                      id=\"note\"\r\n                      name=\"note\"\r\n                      value={formData.note}\r\n                      onChange={handleChange}\r\n                      onKeyDown={handleNoteKeyDown}\r\n                      rows={2}\r\n                      className=\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\"\r\n                      placeholder=\"Descripción breve del trabajo realizado\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Acciones */}\r\n                <div className=\"mt-6 flex items-center justify-end gap-3\">\r\n                  <Button\r\n                    type=\"submit\"\r\n                    onClick={(e) => { e.preventDefault(); handleSubmit(e as any); }}\r\n                    disabled={loading.submit || Object.keys(errors).length > 0}\r\n                    className=\"h-11\"\r\n                  >\r\n                    {loading.submit ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Save className=\"mr-2 h-4 w-4\" />}\r\n                    {editingActivityId ? 'Actualizar' : 'Guardar'}\r\n                  </Button>\r\n\r\n                  {editingActivityId && (\r\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"h-11\">\r\n                      <XCircle className=\"mr-2 h-4 w-4\" /> Cancelar edición\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </main>\r\n\r\n          {/* LATERAL */}\r\n          <aside className=\"lg:col-span-2\">\r\n            <Card className=\"h-full text-wrap\">\r\n              <CardHeader className=\"relative\">\r\n                <CardTitle className=\"text-center flex items-center justify-center gap-2\">\r\n                  <ClipboardList className=\"h-5 w-5\" />\r\n                  Actividades del Día\r\n                </CardTitle>\r\n                <Dialog open={isTableModalOpen} onOpenChange={setIsTableModalOpen}>\r\n                  <DialogTrigger asChild>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outline\"\r\n                      size=\"icon\"\r\n                      title=\"Ver tabla de horas\"\r\n                      className=\"absolute right-4 top-4\"\r\n                    >\r\n                      <Clock className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </DialogTrigger>\r\n                  <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n                    <DialogHeader>\r\n                      <DialogTitle>Reporte de Horas</DialogTitle>\r\n                      <DialogDescription>\r\n                        Visualiza el reporte de horas registradas por mes.\r\n                      </DialogDescription>\r\n                    </DialogHeader>\r\n                    <TablaHoras />\r\n                  </DialogContent>\r\n                </Dialog>\r\n\r\n                <div className=\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\">\r\n                  <span className=\"inline-flex items-center gap-2\">\r\n                    <CalendarIcon className=\"h-4 w-4\" /> {format(selectedDate, 'PPP', { locale: es })}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\">\r\n                    Total registros: {dailyActivities.length}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {loading.dailyActivities ? (\r\n                  <ActivityListSkeleton />\r\n                ) : visibleActivities.length > 0 ? (\r\n                  <>\r\n                    {/* Lista sin overflow horizontal y con saltos de línea */}\r\n                    <div className=\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\">\r\n                      {visibleActivities.map((activity) => (\r\n                        <div key={activity.id} className=\"text-wrap\">\r\n                          <ActivityItem\r\n                            activity={activity}\r\n                            onEdit={handleEditActivity}\r\n                            onDelete={handleDelete}\r\n                          />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"pt-3\">\r\n                      <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <EmptyState />\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </aside>\r\n        </div>\r\n\r\n      </div>\r\n\r\n  {undoData && (\r\n    <div className=\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\">\r\n      <span className=\"text-sm\">Registro eliminado.</span>\r\n      <Button size=\"sm\" variant=\"outline\" onClick={handleUndoDelete}>\r\n        <Undo2 className=\"h-4 w-4 mr-1\" /> Deshacer\r\n      </Button>\r\n    </div>\r\n  )}\r\n</div>\r\n);\r\n};\r\n\r\nexport default FormularioHoras;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}