{"ast":null,"code":"import _objectSpread from\"C:/Users/YeisonDuqueDiaz/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// FormularioPermisos.tsx\nimport React,{useState,useEffect,useCallback,useMemo,useRef}from'react';import{format,parseISO}from'date-fns';import{es}from'date-fns/locale';import{toast,Toaster}from'sonner';import{cn}from'../lib/utils';import Header from'./Header';import{Calendar as CalendarIcon,Save,Pencil,XCircle,PlusCircle,Loader2,Clock,Folder,Minus,Plus,Star,Info,ArrowUpDown,Briefcase,ListChecks,ClipboardList}from'lucide-react';import{Card,CardContent,CardHeader,CardTitle}from'./ui/card';import{Button}from'./ui/button';import{Input}from'./ui/input';import{Calendar}from'./ui/calendar';import{Popover,PopoverContent,PopoverTrigger}from'./ui/popover';import{FormSelect}from'./formulario/FormSelect';import{ActivityItem}from'./formulario/ActivityItem';import{ActivityListSkeleton}from'./formulario/ActivityListSkeleton';import{EmptyState}from'./formulario/EmptyState';import{TotalHoursProgress}from'./formulario/TotalHoursProgress';// APIs correctas\nimport{getDailyActivities,submitHours,updateHour,deleteHour}from'../api/horasApi';import{getProjects,getProjectStages,getDisciplinesByStage,getActivitiesByDiscipline,sortAZ}from'../api/permissionsApi';// ========================\n// Tipos & Props\n// ========================\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const initialFormData=employeeId=>({employee_id:employeeId,project_code:'',phase:'',discipline:'',activity:'',hours:'0',note:''});// Preferir letras antes que números; orden \"humano\" con soporte numérico\nconst projectComparator=(a,b)=>{const startsWithNum=s=>/^\\d/.test(s);const an=startsWithNum(a.code);const bn=startsWithNum(b.code);if(an&&!bn)return 1;if(!an&&bn)return-1;return a.code.localeCompare(b.code,undefined,{numeric:true,sensitivity:'base'});};// ========================\n// Componente\n// ========================\nconst FormularioPermisos=_ref=>{let{onSuccess,employeeId,employeeName,onLogout,onNavigateToHours,onShowPowerBI}=_ref;const[formData,setFormData]=useState(initialFormData(employeeId));const[selectedDate,setSelectedDate]=useState(new Date());const[projects,setProjects]=useState([]);const[stages,setStages]=useState([]);const[disciplines,setDisciplines]=useState([]);const[activities,setActivities]=useState([]);const[dailyActivities,setDailyActivities]=useState([]);const[editingActivityId,setEditingActivityId]=useState(null);const FAV_KEY=useMemo(()=>\"fh_favorites_v1_\".concat(employeeId),[employeeId]);const DRAFT_KEY=useMemo(()=>\"fh_draft_v1_\".concat(employeeId),[employeeId]);const[favorites,setFavorites]=useState([]);const[sortDir,setSortDir]=useState('asc');const[isDirty,setIsDirty]=useState(false);const[loading,setLoading]=useState({submit:false,projects:true,stages:false,disciplines:false,activities:false,dailyActivities:true,delete:null});const hoursInputRef=useRef(null);const undoTimerRef=useRef(null);const favScrollRef=useRef(null);const handleFavWheel=useCallback(e=>{if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){e.preventDefault();e.stopPropagation();e.currentTarget.scrollLeft+=e.deltaY;}},[]);const selectedProjectName=useMemo(()=>{var _projects$find;return((_projects$find=projects.find(p=>p.code===formData.project_code))===null||_projects$find===void 0?void 0:_projects$find.name)||'';},[formData.project_code,projects]);const hoursNumber=useMemo(()=>{var _formData$hours;const raw=String((_formData$hours=formData.hours)!==null&&_formData$hours!==void 0?_formData$hours:'').replace(',','.').trim();const n=Number(raw);return Number.isFinite(n)?n:0;},[formData.hours]);const totalHoursToday=useMemo(()=>dailyActivities.reduce((sum,a)=>sum+(Number(a.hours)||0),0),[dailyActivities]);const[errors,setErrors]=useState({});// Validación reactiva\nuseEffect(()=>{const newErrors={};if(!formData.project_code)newErrors.project_code='Selecciona un proyecto';if(!formData.phase)newErrors.phase='Selecciona una etapa';if(!formData.discipline)newErrors.discipline='Selecciona una disciplina';if(!formData.activity)newErrors.activity='Selecciona una actividad';if(!(hoursNumber>0))newErrors.hours='Ingresa horas válidas (> 0)';setErrors(newErrors);},[formData,hoursNumber]);// Borrador local\nuseEffect(()=>{const raw=localStorage.getItem(DRAFT_KEY);if(raw){try{const draft=JSON.parse(raw);setFormData(prev=>_objectSpread(_objectSpread(_objectSpread({},prev),draft),{},{employee_id:employeeId// asegurar número\n}));}catch(_unused){}}},[DRAFT_KEY,employeeId]);useEffect(()=>{localStorage.setItem(DRAFT_KEY,JSON.stringify(formData));},[DRAFT_KEY,formData]);// Favoritos\nuseEffect(()=>{const raw=localStorage.getItem(FAV_KEY);if(raw){try{setFavorites(JSON.parse(raw));}catch(_unused2){}}},[FAV_KEY]);const saveFavorites=next=>{setFavorites(next);localStorage.setItem(FAV_KEY,JSON.stringify(next));};const currentFavObj=useMemo(()=>{if(!formData.project_code||!formData.phase||!formData.discipline||!formData.activity)return null;return{project_code:formData.project_code,phase:formData.phase,discipline:formData.discipline,activity:formData.activity};},[formData.project_code,formData.phase,formData.discipline,formData.activity]);const isCurrentFavorite=useMemo(()=>{if(!currentFavObj)return false;return favorites.some(f=>JSON.stringify(f)===JSON.stringify(currentFavObj));},[favorites,currentFavObj]);const toggleFavorite=()=>{if(!currentFavObj){toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');return;}if(isCurrentFavorite){const next=favorites.filter(f=>JSON.stringify(f)!==JSON.stringify(currentFavObj));saveFavorites(next);toast.message('Eliminado de favoritos');}else{saveFavorites([...favorites,currentFavObj]);toast.success('Guardado en favoritos');}};const visibleActivities=useMemo(()=>{const list=[...dailyActivities].sort((a,b)=>{var _a$id,_b$id;return String((_a$id=a.id)!==null&&_a$id!==void 0?_a$id:'').localeCompare(String((_b$id=b.id)!==null&&_b$id!==void 0?_b$id:''),undefined,{numeric:true});});return sortDir==='desc'?list.reverse():list;},[dailyActivities,sortDir]);useEffect(()=>{const base=initialFormData(employeeId);const changed=JSON.stringify(_objectSpread(_objectSpread({},formData),{},{employee_id:undefined}))!==JSON.stringify(_objectSpread(_objectSpread({},base),{},{employee_id:undefined}));setIsDirty(changed||Boolean(editingActivityId));},[formData,editingActivityId,employeeId]);// Data fetching\nconst refreshDailyActivities=useCallback(async(date,id)=>{setLoading(p=>_objectSpread(_objectSpread({},p),{},{dailyActivities:true}));try{const dateString=format(date,'yyyy-MM-dd');const acts=await getDailyActivities(dateString,Number(id));setDailyActivities(acts);}catch(e){toast.error('Error al cargar las actividades del día.');console.error(e);}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{dailyActivities:false}));}},[]);const fetchProjects=useCallback(async()=>{setLoading(p=>_objectSpread(_objectSpread({},p),{},{projects:true}));try{const data=await getProjects();const sorted=[...data].sort(projectComparator);setProjects(sorted);}catch(e){toast.error('Error al cargar proyectos.');}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{projects:false}));}},[]);const fetchStages=useCallback(async projectCode=>{if(!projectCode)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{stages:true}));try{const data=await getProjectStages(projectCode);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setStages(sorted);return sorted;}catch(e){toast.error('Error al cargar etapas.');setStages([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{stages:false}));}},[]);const fetchDisciplines=useCallback(async(projectCode,stage)=>{if(!projectCode||!stage)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{disciplines:true}));try{const data=await getDisciplinesByStage(projectCode,stage);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setDisciplines(sorted);return sorted;}catch(e){toast.error('Error al cargar disciplinas.');setDisciplines([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{disciplines:false}));}},[]);const fetchActivities=useCallback(async(projectCode,stage,discipline)=>{if(!projectCode||!stage||!discipline)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{activities:true}));try{const data=await getActivitiesByDiscipline(projectCode,stage,discipline);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setActivities(sorted);return sorted;}catch(e){toast.error('Error al cargar actividades.');setActivities([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{activities:false}));}},[]);const applyFavorite=useCallback(async fav=>{try{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{project_code:fav.project_code,phase:'',discipline:'',activity:''}));const st=await fetchStages(fav.project_code);if(st&&st.includes(fav.phase)){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{phase:fav.phase}));const ds=await fetchDisciplines(fav.project_code,fav.phase);if(ds&&ds.includes(fav.discipline)){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{discipline:fav.discipline}));const ac=await fetchActivities(fav.project_code,fav.phase,fav.discipline);if(ac&&ac.includes(fav.activity)){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{activity:fav.activity}));}}}}catch(e){console.error(e);toast.error('No se pudo aplicar el favorito');}},[fetchStages,fetchDisciplines,fetchActivities]);useEffect(()=>{fetchProjects();},[fetchProjects]);useEffect(()=>{refreshDailyActivities(selectedDate,String(employeeId));},[selectedDate,employeeId,refreshDailyActivities]);// Handlers\nconst handleDateChange=date=>{if(date)setSelectedDate(date);};const handleChange=e=>{const{name,value}=e.target;const v=name==='hours'?value.replace(',','.'):value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:v}));};const handleNoteKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey)e.preventDefault();};const handleSelectChange=async(name,value)=>{const updated=_objectSpread(_objectSpread({},formData),{},{[name]:value});switch(name){case'project_code':updated.phase='';updated.discipline='';updated.activity='';setFormData(updated);setStages([]);setDisciplines([]);setActivities([]);if(value)await fetchStages(value);break;case'phase':updated.discipline='';updated.activity='';setFormData(updated);setDisciplines([]);setActivities([]);if(value&&updated.project_code)await fetchDisciplines(updated.project_code,value);break;case'discipline':updated.activity='';setFormData(updated);setActivities([]);if(value&&updated.project_code&&updated.phase){await fetchActivities(updated.project_code,updated.phase,value);}break;default:setFormData(updated);}};const resetForm=useCallback(()=>{setFormData(initialFormData(employeeId));setEditingActivityId(null);},[employeeId]);const handleEditActivity=useCallback(async activity=>{try{var _activity$hours;if(activity.date){try{const d=typeof activity.date==='string'?parseISO(activity.date):new Date(activity.date);setSelectedDate(d);}catch(_unused3){}}if(activity.project_code){await fetchStages(activity.project_code);if(activity.phase)await fetchDisciplines(activity.project_code,activity.phase);if(activity.phase&&activity.discipline)await fetchActivities(activity.project_code,activity.phase,activity.discipline);}setFormData({employee_id:employeeId,project_code:activity.project_code||'',phase:activity.phase||'',discipline:activity.discipline||'',activity:activity.activity||'',hours:String((_activity$hours=activity.hours)!==null&&_activity$hours!==void 0?_activity$hours:'0'),note:activity.note||''});setEditingActivityId(String(activity.id));window.scrollTo({top:0,behavior:'smooth'});}catch(e){console.error(e);toast.error('Error al cargar la actividad para edición');}},[employeeId,fetchStages,fetchDisciplines,fetchActivities]);const[undoData,setUndoData]=useState(null);const triggerUndoBanner=activity=>{setUndoData(activity);if(undoTimerRef.current)clearTimeout(undoTimerRef.current);undoTimerRef.current=setTimeout(()=>setUndoData(null),8000);};const handleUndoDelete=async()=>{if(!undoData)return;const a=undoData;setUndoData(null);try{// recrea el registro eliminado\nawait submitHours({employee_id:employeeId,date:format(selectedDate,'yyyy-MM-dd'),project_code:a.project_code,phase:a.phase,discipline:a.discipline,activity:a.activity,hours:Number(a.hours)||0,note:a.note||''});await refreshDailyActivities(selectedDate,String(employeeId));toast.success('Actividad restaurada');}catch(e){console.error(e);toast.error('Error al restaurar la actividad');}};const doSubmit=useCallback(async()=>{if(Object.keys(errors).length>0){toast.error('Por favor completa todos los campos requeridos');return false;}const payload={employee_id:employeeId,date:format(selectedDate,'yyyy-MM-dd'),project_code:formData.project_code,phase:formData.phase,discipline:formData.discipline,activity:formData.activity,hours:hoursNumber,note:formData.note||'',id:editingActivityId||undefined};const toastId=toast.loading(editingActivityId?'Actualizando actividad...':'Guardando actividad...');setLoading(p=>_objectSpread(_objectSpread({},p),{},{submit:true}));try{if(editingActivityId){await updateHour(editingActivityId,payload);}else{await submitHours(payload);}toast.success(\"Actividad \".concat(editingActivityId?'actualizada':'guardada',\" con \\xE9xito.\"),{id:toastId,duration:1800});await refreshDailyActivities(selectedDate,String(employeeId));onSuccess===null||onSuccess===void 0?void 0:onSuccess();return true;}catch(e){console.error(e);toast.error('Ocurrió un error al guardar.',{id:toastId});return false;}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{submit:false}));}},[editingActivityId,employeeId,errors,formData.activity,formData.discipline,formData.phase,formData.project_code,formData.note,hoursNumber,selectedDate,refreshDailyActivities,onSuccess]);const handleSubmit=async e=>{e.preventDefault();const ok=await doSubmit();if(ok)resetForm();};const handleDelete=async id=>{const prev=dailyActivities.find(a=>String(a.id)===String(id));try{setLoading(p=>_objectSpread(_objectSpread({},p),{},{delete:id}));await deleteHour(id);await refreshDailyActivities(selectedDate,String(employeeId));if(prev)triggerUndoBanner(prev);toast.error('Actividad eliminada');}catch(e){console.error(e);toast.error('No se pudo eliminar');}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{delete:null}));}};const adjustHours=delta=>{const current=hoursNumber||0;const next=Math.max(0,Math.round((current+delta)*2)/2);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{hours:String(next)}));};// Atajos de teclado\nuseEffect(()=>{const onKey=e=>{if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='enter'){e.preventDefault();(async()=>{if(!loading.submit){const ok=await doSubmit();if(ok)resetForm();}})();}if(e.key==='Escape'){resetForm();}};window.addEventListener('keydown',onKey);return()=>window.removeEventListener('keydown',onKey);},[doSubmit,loading.submit,resetForm]);// Navegación declarativa (se maneja fuera: App.tsx)\nconst handleNavigateToPermissions=()=>{/* noop: handled in router/App.tsx */};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[#f2f6fd] text-foreground\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-right\",richColors:true}),/*#__PURE__*/_jsx(Header,{employeeName:employeeName,onLogout:onLogout,onShowPowerBI:onShowPowerBI||(()=>{}),onNavigateToHours:onNavigateToHours,onNavigateToPermissions:handleNavigateToPermissions,currentView:\"hours\"}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\\n        .text-wrap, .text-wrap *{\\n          overflow-wrap: anywhere;\\n          word-break: break-word;\\n          hyphens: auto;\\n        }\\n      \"}),/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto container p-4 sm:p-6 lg:p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\",children:[/*#__PURE__*/_jsx(\"main\",{className:cn('lg:col-span-3'),children:/*#__PURE__*/_jsxs(Card,{className:\"relative z-10 flex flex-col text-wrap\",children:[/*#__PURE__*/_jsxs(CardHeader,{className:\"relative items-center text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-2\",children:[editingActivityId?/*#__PURE__*/_jsx(Pencil,{className:\"h-5 w-5\"}):/*#__PURE__*/_jsx(PlusCircle,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(CardTitle,{className:\"text-center\",children:editingActivityId?'Editar Actividad':'Registrar Actividad'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-4 top-4 text-xs\",children:editingActivityId?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\",children:\"Editando\"}):/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\",children:\"Creando\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-muted-foreground\",children:\"Registra tus horas del d\\xEDa para el proyecto seleccionado.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(Briefcase,{className:\"h-3.5 w-3.5\"}),\" \",formData.project_code||'—']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(ListChecks,{className:\"h-3.5 w-3.5\"}),\" \",formData.phase||'—']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(Pencil,{className:\"h-3.5 w-3.5\"}),\" \",formData.discipline||'—']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"h-3.5 w-3.5\"}),\" \",formData.activity||'—']})]})]}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 w-full sm:max-w-xs\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"h-4 w-4\"}),\" Fecha\"]})}),/*#__PURE__*/_jsxs(Popover,{children:[/*#__PURE__*/_jsx(PopoverTrigger,{asChild:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outline\",className:cn('w-full justify-start font-normal h-10',!selectedDate&&'text-muted-foreground'),children:/*#__PURE__*/_jsx(\"span\",{children:format(selectedDate,'PPP',{locale:es})})})}),/*#__PURE__*/_jsx(PopoverContent,{className:\"w-auto p-0\",align:\"start\",children:/*#__PURE__*/_jsx(Calendar,{mode:\"single\",selected:selectedDate,onSelect:handleDateChange,initialFocus:true,locale:es})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"C\\xF3digo de Proyecto\",name:\"project_code\",value:formData.project_code,onValueChange:handleSelectChange,options:projects.map(p=>({value:p.code,label:p.code,dropdownLabel:\"\".concat(p.code,\" - \").concat(p.name)})),placeholder:\"Seleccione un proyecto\",loading:loading.projects,disabled:loading.projects,icon:/*#__PURE__*/_jsx(Briefcase,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\",children:\"Elige el proyecto para cargar los demas campos.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Folder,{className:\"h-4 w-4\"}),\" Nombre del Proyecto\"]})}),/*#__PURE__*/_jsx(Input,{value:selectedProjectName,readOnly:true,className:\"bg-muted/50\",\"aria-label\":\"Nombre de proyecto seleccionado\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"Etapa\",name:\"phase\",value:formData.phase,onValueChange:handleSelectChange,options:stages.map(s=>({value:s,label:s})),placeholder:\"Seleccione una etapa\",loading:loading.stages,disabled:!formData.project_code||loading.stages,icon:/*#__PURE__*/_jsx(ListChecks,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-muted-foreground\",children:\"Etapas disponibles para el proyecto elegido.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"Disciplina\",name:\"discipline\",value:formData.discipline,onValueChange:handleSelectChange,options:disciplines.map(d=>({value:d,label:d})),placeholder:\"Seleccione una disciplina\",loading:loading.disciplines,disabled:!formData.phase||loading.disciplines,icon:/*#__PURE__*/_jsx(Pencil,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-muted-foreground\",children:\"Se filtran seg\\xFAn la etapa seleccionada.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full md:w-[320px] text-wrap\",children:/*#__PURE__*/_jsx(FormSelect,{label:\"Actividad\",name:\"activity\",value:formData.activity,onValueChange:handleSelectChange,options:activities.map(a=>({value:a,label:a})),placeholder:\"Seleccione una actividad\",loading:loading.activities,disabled:!formData.discipline||loading.activities,icon:/*#__PURE__*/_jsx(ClipboardList,{className:\"h-4 w-4\"}),required:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"hours\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Clock,{className:\"h-4 w-4\"}),\" Horas \",/*#__PURE__*/_jsx(\"span\",{className:\"text-destructive\",children:\"*\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",className:\"h-10 w-10 shrink-0\",onClick:()=>adjustHours(-0.5),\"aria-label\":\"Restar 0.5h\",children:/*#__PURE__*/_jsx(Minus,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",className:\"h-10 w-10 shrink-0\",onClick:()=>adjustHours(0.5),\"aria-label\":\"Sumar 0.5h\",children:/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Input,{id:\"hours\",name:\"hours\",type:\"number\",value:formData.hours,onChange:handleChange,min:\"0\",step:\"0.5\",ref:hoursInputRef,className:\"h-10 w-[100px] shrink-0 rounded-md mr-0\"}),/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:isCurrentFavorite?'default':'outline',className:\"h-10 shrink-0\",onClick:toggleFavorite,title:isCurrentFavorite?'Quitar de favoritos':'Guardar como favorito',children:[/*#__PURE__*/_jsx(Star,{className:\"h-4 w-4 mr-2\"}),\" Favorito\"]})]})]}),favorites.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(\"div\",{ref:favScrollRef,onWheel:handleFavWheel,className:\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\",style:{overscrollBehaviorX:'contain',overscrollBehaviorY:'none',touchAction:'pan-x'},children:/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:favorites.map((fav,idx)=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>applyFavorite(fav),className:\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\",title:\"\".concat(fav.project_code,\" \\u2022 \").concat(fav.phase,\" \\u2022 \").concat(fav.discipline),children:[/*#__PURE__*/_jsx(Star,{className:\"h-3.5 w-3.5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:fav.activity})]},idx))})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2 w-full text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"note\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-4 w-4\"}),\" Nota (Opcional)\"]})}),/*#__PURE__*/_jsx(\"textarea\",{id:\"note\",name:\"note\",value:formData.note,onChange:handleChange,onKeyDown:handleNoteKeyDown,rows:2,className:\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\",placeholder:\"Descripci\\xF3n breve del trabajo realizado\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex items-center justify-end gap-3\",children:[/*#__PURE__*/_jsxs(Button,{type:\"submit\",onClick:e=>{e.preventDefault();handleSubmit(e);},disabled:loading.submit||Object.keys(errors).length>0,className:\"h-11\",children:[loading.submit?/*#__PURE__*/_jsx(Loader2,{className:\"mr-2 h-4 w-4 animate-spin\"}):/*#__PURE__*/_jsx(Save,{className:\"mr-2 h-4 w-4\"}),editingActivityId?'Actualizar':'Guardar']}),editingActivityId&&/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:\"outline\",onClick:resetForm,className:\"h-11\",children:[/*#__PURE__*/_jsx(XCircle,{className:\"mr-2 h-4 w-4\"}),\" Cancelar edici\\xF3n\"]})]})]})]})}),/*#__PURE__*/_jsx(\"aside\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(Card,{className:\"h-full text-wrap\",children:[/*#__PURE__*/_jsxs(CardHeader,{className:\"relative\",children:[/*#__PURE__*/_jsxs(CardTitle,{className:\"text-center flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"h-5 w-5\"}),\"Actividades del D\\xEDa\"]}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",title:\"Ordenar\",onClick:()=>setSortDir(d=>d==='asc'?'desc':'asc'),className:\"absolute right-4 top-4\",children:/*#__PURE__*/_jsx(ArrowUpDown,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"h-4 w-4\"}),\" \",format(selectedDate,'PPP',{locale:es})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\",children:[\"Total registros: \",dailyActivities.length]})]})]}),/*#__PURE__*/_jsx(CardContent,{children:loading.dailyActivities?/*#__PURE__*/_jsx(ActivityListSkeleton,{}):visibleActivities.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\",children:visibleActivities.map(activity=>/*#__PURE__*/_jsx(\"div\",{className:\"text-wrap\",children:/*#__PURE__*/_jsx(ActivityItem,{activity:activity,onEdit:handleEditActivity,onDelete:handleDelete})},String(activity.id)))}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\",children:/*#__PURE__*/_jsx(TotalHoursProgress,{totalHours:totalHoursToday,selectedDate:selectedDate})})]}):/*#__PURE__*/_jsx(EmptyState,{})})]})})]})}),undoData&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Registro eliminado.\"}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"outline\",onClick:handleUndoDelete,children:\"Deshacer\"})]})]});};export default FormularioPermisos;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","format","parseISO","es","toast","Toaster","cn","Header","Calendar","CalendarIcon","Save","Pencil","XCircle","PlusCircle","Loader2","Clock","Folder","Minus","Plus","Star","Info","ArrowUpDown","Briefcase","ListChecks","ClipboardList","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","getDailyActivities","submitHours","updateHour","deleteHour","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","sortAZ","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","initialFormData","employeeId","employee_id","project_code","phase","discipline","activity","hours","note","projectComparator","a","b","startsWithNum","s","test","an","code","bn","localeCompare","undefined","numeric","sensitivity","FormularioPermisos","_ref","onSuccess","employeeName","onLogout","onNavigateToHours","onShowPowerBI","formData","setFormData","selectedDate","setSelectedDate","Date","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","dailyActivities","setDailyActivities","editingActivityId","setEditingActivityId","FAV_KEY","concat","DRAFT_KEY","favorites","setFavorites","sortDir","setSortDir","isDirty","setIsDirty","loading","setLoading","submit","delete","hoursInputRef","undoTimerRef","favScrollRef","handleFavWheel","e","Math","abs","deltaY","deltaX","preventDefault","stopPropagation","currentTarget","scrollLeft","selectedProjectName","_projects$find","find","p","name","hoursNumber","_formData$hours","raw","String","replace","trim","n","Number","isFinite","totalHoursToday","reduce","sum","errors","setErrors","newErrors","localStorage","getItem","draft","JSON","parse","prev","_objectSpread","_unused","setItem","stringify","_unused2","saveFavorites","next","currentFavObj","isCurrentFavorite","some","f","toggleFavorite","error","filter","message","success","visibleActivities","list","sort","_a$id","_b$id","id","reverse","base","changed","Boolean","refreshDailyActivities","date","dateString","acts","console","fetchProjects","data","sorted","fetchStages","projectCode","cleaned","v","map","fetchDisciplines","stage","fetchActivities","applyFavorite","fav","st","includes","ds","ac","handleDateChange","handleChange","value","target","handleNoteKeyDown","key","shiftKey","handleSelectChange","updated","resetForm","handleEditActivity","_activity$hours","d","_unused3","window","scrollTo","top","behavior","undoData","setUndoData","triggerUndoBanner","current","clearTimeout","setTimeout","handleUndoDelete","doSubmit","Object","keys","length","payload","toastId","duration","handleSubmit","ok","handleDelete","adjustHours","delta","max","round","onKey","ctrlKey","metaKey","toLowerCase","addEventListener","removeEventListener","handleNavigateToPermissions","className","children","position","richColors","onNavigateToPermissions","currentView","asChild","variant","locale","align","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","required","readOnly","htmlFor","type","size","onClick","onChange","min","step","ref","title","onWheel","style","overscrollBehaviorX","overscrollBehaviorY","touchAction","idx","onKeyDown","rows","onEdit","onDelete","totalHours"],"sources":["D:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioPermisos.tsx"],"sourcesContent":["// FormularioPermisos.tsx\r\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { toast, Toaster } from 'sonner';\r\n\r\nimport { cn } from '../lib/utils';\r\nimport Header from './Header';\r\n\r\nimport {\r\n  Calendar as CalendarIcon,\r\n  Save,\r\n  Pencil,\r\n  XCircle,\r\n  PlusCircle,\r\n  Loader2,\r\n  Clock,\r\n  Folder,\r\n  Minus,\r\n  Plus,\r\n  Star,\r\n  Info,\r\n  ArrowUpDown,\r\n  Briefcase,\r\n  ListChecks,\r\n  ClipboardList,\r\n} from 'lucide-react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Calendar } from './ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\r\n\r\nimport { FormSelect } from './formulario/FormSelect';\r\nimport { ActivityItem } from './formulario/ActivityItem';\r\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\r\nimport { EmptyState } from './formulario/EmptyState';\r\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\r\n\r\n// APIs correctas\r\nimport {\r\n  DailyActivity,\r\n  getDailyActivities,\r\n  submitHours,\r\n  updateHour,\r\n  deleteHour,\r\n} from '../api/horasApi';\r\n\r\nimport {\r\n  Project,\r\n  getProjects,\r\n  getProjectStages,\r\n  getDisciplinesByStage,\r\n  getActivitiesByDiscipline,\r\n  sortAZ,\r\n} from '../api/permissionsApi';\r\n\r\n// ========================\r\n// Tipos & Props\r\n// ========================\r\ninterface FormularioPermisosProps {\r\n  onSuccess?: () => void;\r\n  employeeId: number;\r\n  employeeName: string;\r\n  onLogout: () => void;\r\n  onNavigateToHours: () => void;\r\n  onShowPowerBI?: () => void;\r\n}\r\n\r\ntype Activity = DailyActivity;\r\n\r\ntype PermissionFormData = {\r\n  employee_id: number;\r\n  project_code: string;\r\n  phase: string;\r\n  discipline: string;\r\n  activity: string;\r\n  hours: string; // UI-friendly; derivamos number aparte\r\n  note?: string;\r\n};\r\n\r\ntype Favorite = { project_code: string; phase: string; discipline: string; activity: string };\r\n\r\nconst initialFormData = (employeeId: number): PermissionFormData => ({\r\n  employee_id: employeeId,\r\n  project_code: '',\r\n  phase: '',\r\n  discipline: '',\r\n  activity: '',\r\n  hours: '0',\r\n  note: '',\r\n});\r\n\r\n// Preferir letras antes que números; orden \"humano\" con soporte numérico\r\nconst projectComparator = (a: Project, b: Project) => {\r\n  const startsWithNum = (s: string) => /^\\d/.test(s);\r\n  const an = startsWithNum(a.code);\r\n  const bn = startsWithNum(b.code);\r\n  if (an && !bn) return 1;\r\n  if (!an && bn) return -1;\r\n  return a.code.localeCompare(b.code, undefined, { numeric: true, sensitivity: 'base' });\r\n};\r\n\r\n// ========================\r\n// Componente\r\n// ========================\r\nconst FormularioPermisos: React.FC<FormularioPermisosProps> = ({\r\n  onSuccess,\r\n  employeeId,\r\n  employeeName,\r\n  onLogout,\r\n  onNavigateToHours,\r\n  onShowPowerBI,\r\n}) => {\r\n  const [formData, setFormData] = useState<PermissionFormData>(initialFormData(employeeId));\r\n  const [selectedDate, setSelectedDate] = useState<Date>(new Date());\r\n\r\n  const [projects, setProjects] = useState<Project[]>([]);\r\n  const [stages, setStages] = useState<string[]>([]);\r\n  const [disciplines, setDisciplines] = useState<string[]>([]);\r\n  const [activities, setActivities] = useState<string[]>([]);\r\n\r\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\r\n  const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\r\n\r\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\r\n  const DRAFT_KEY = useMemo(() => `fh_draft_v1_${employeeId}`, [employeeId]);\r\n\r\n  const [favorites, setFavorites] = useState<Favorite[]>([]);\r\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('asc');\r\n  const [isDirty, setIsDirty] = useState<boolean>(false);\r\n\r\n  const [loading, setLoading] = useState({\r\n    submit: false,\r\n    projects: true,\r\n    stages: false,\r\n    disciplines: false,\r\n    activities: false,\r\n    dailyActivities: true,\r\n    delete: null as string | null,\r\n  });\r\n\r\n  const hoursInputRef = useRef<HTMLInputElement | null>(null);\r\n  const undoTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const favScrollRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  const handleFavWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\r\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.currentTarget.scrollLeft += e.deltaY;\r\n    }\r\n  }, []);\r\n\r\n  const selectedProjectName = useMemo(\r\n    () => projects.find((p) => p.code === formData.project_code)?.name || '',\r\n    [formData.project_code, projects]\r\n  );\r\n\r\n  const hoursNumber = useMemo(() => {\r\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\r\n    const n = Number(raw);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }, [formData.hours]);\r\n\r\n  const totalHoursToday = useMemo(\r\n    () => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0),\r\n    [dailyActivities]\r\n  );\r\n\r\n  const [errors, setErrors] = useState<Partial<Record<keyof PermissionFormData, string>>>({});\r\n\r\n  // Validación reactiva\r\n  useEffect(() => {\r\n    const newErrors: Partial<Record<keyof PermissionFormData, string>> = {};\r\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\r\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\r\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\r\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\r\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\r\n    setErrors(newErrors);\r\n  }, [formData, hoursNumber]);\r\n\r\n  // Borrador local\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(DRAFT_KEY);\r\n    if (raw) {\r\n      try {\r\n        const draft = JSON.parse(raw);\r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          ...draft,\r\n          employee_id: employeeId, // asegurar número\r\n        }));\r\n      } catch {}\r\n    }\r\n  }, [DRAFT_KEY, employeeId]);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(formData));\r\n  }, [DRAFT_KEY, formData]);\r\n\r\n  // Favoritos\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(FAV_KEY);\r\n    if (raw) {\r\n      try {\r\n        setFavorites(JSON.parse(raw));\r\n      } catch {}\r\n    }\r\n  }, [FAV_KEY]);\r\n\r\n  const saveFavorites = (next: Favorite[]) => {\r\n    setFavorites(next);\r\n    localStorage.setItem(FAV_KEY, JSON.stringify(next));\r\n  };\r\n\r\n  const currentFavObj = useMemo(() => {\r\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\r\n    return {\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n    } as Favorite;\r\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\r\n\r\n  const isCurrentFavorite = useMemo(() => {\r\n    if (!currentFavObj) return false;\r\n    return favorites.some((f) => JSON.stringify(f) === JSON.stringify(currentFavObj));\r\n  }, [favorites, currentFavObj]);\r\n\r\n  const toggleFavorite = () => {\r\n    if (!currentFavObj) {\r\n      toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');\r\n      return;\r\n    }\r\n    if (isCurrentFavorite) {\r\n      const next = favorites.filter((f) => JSON.stringify(f) !== JSON.stringify(currentFavObj));\r\n      saveFavorites(next);\r\n      toast.message('Eliminado de favoritos');\r\n    } else {\r\n      saveFavorites([...favorites, currentFavObj]);\r\n      toast.success('Guardado en favoritos');\r\n    }\r\n  };\r\n\r\n  const visibleActivities = useMemo(() => {\r\n    const list = [...dailyActivities].sort((a, b) =>\r\n      String(a.id ?? '').localeCompare(String(b.id ?? ''), undefined, { numeric: true })\r\n    );\r\n    return sortDir === 'desc' ? list.reverse() : list;\r\n  }, [dailyActivities, sortDir]);\r\n\r\n  useEffect(() => {\r\n    const base = initialFormData(employeeId);\r\n    const changed =\r\n      JSON.stringify({ ...formData, employee_id: undefined }) !==\r\n      JSON.stringify({ ...base, employee_id: undefined });\r\n    setIsDirty(changed || Boolean(editingActivityId));\r\n  }, [formData, editingActivityId, employeeId]);\r\n\r\n  // Data fetching\r\n  const refreshDailyActivities = useCallback(\r\n    async (date: Date, id: string) => {\r\n      setLoading((p) => ({ ...p, dailyActivities: true }));\r\n      try {\r\n        const dateString = format(date, 'yyyy-MM-dd');\r\n        const acts = await getDailyActivities(dateString, Number(id));\r\n        setDailyActivities(acts);\r\n      } catch (e) {\r\n        toast.error('Error al cargar las actividades del día.');\r\n        console.error(e);\r\n      } finally {\r\n        setLoading((p) => ({ ...p, dailyActivities: false }));\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const fetchProjects = useCallback(async () => {\r\n    setLoading((p) => ({ ...p, projects: true }));\r\n    try {\r\n      const data = await getProjects();\r\n      const sorted = [...data].sort(projectComparator);\r\n      setProjects(sorted);\r\n    } catch (e) {\r\n      toast.error('Error al cargar proyectos.');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, projects: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchStages = useCallback(async (projectCode: string) => {\r\n    if (!projectCode) return [] as string[];\r\n    setLoading((p) => ({ ...p, stages: true }));\r\n    try {\r\n      const data = await getProjectStages(projectCode);\r\n      const cleaned = (data || [])\r\n        .filter((v: any) => v != null && String(v).trim() !== '')\r\n        .map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setStages(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar etapas.');\r\n      setStages([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, stages: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\r\n    if (!projectCode || !stage) return [] as string[];\r\n    setLoading((p) => ({ ...p, disciplines: true }));\r\n    try {\r\n      const data = await getDisciplinesByStage(projectCode, stage);\r\n      const cleaned = (data || [])\r\n        .filter((v: any) => v != null && String(v).trim() !== '')\r\n        .map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setDisciplines(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar disciplinas.');\r\n      setDisciplines([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, disciplines: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchActivities = useCallback(\r\n    async (projectCode: string, stage: string, discipline: string) => {\r\n      if (!projectCode || !stage || !discipline) return [] as string[];\r\n      setLoading((p) => ({ ...p, activities: true }));\r\n      try {\r\n        const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\r\n        const cleaned = (data || [])\r\n          .filter((v: any) => v != null && String(v).trim() !== '')\r\n          .map(String);\r\n        const sorted = sortAZ(cleaned);\r\n        setActivities(sorted);\r\n        return sorted;\r\n      } catch (e) {\r\n        toast.error('Error al cargar actividades.');\r\n        setActivities([]);\r\n        return [];\r\n      } finally {\r\n        setLoading((p) => ({ ...p, activities: false }));\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const applyFavorite = useCallback(\r\n    async (fav: Favorite) => {\r\n      try {\r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          project_code: fav.project_code,\r\n          phase: '',\r\n          discipline: '',\r\n          activity: '',\r\n        }));\r\n        const st = await fetchStages(fav.project_code);\r\n        if (st && st.includes(fav.phase)) {\r\n          setFormData((prev) => ({ ...prev, phase: fav.phase }));\r\n          const ds = await fetchDisciplines(fav.project_code, fav.phase);\r\n          if (ds && ds.includes(fav.discipline)) {\r\n            setFormData((prev) => ({ ...prev, discipline: fav.discipline }));\r\n            const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\r\n            if (ac && ac.includes(fav.activity)) {\r\n              setFormData((prev) => ({ ...prev, activity: fav.activity }));\r\n            }\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error(e);\r\n        toast.error('No se pudo aplicar el favorito');\r\n      }\r\n    },\r\n    [fetchStages, fetchDisciplines, fetchActivities]\r\n  );\r\n\r\n  useEffect(() => {\r\n    fetchProjects();\r\n  }, [fetchProjects]);\r\n\r\n  useEffect(() => {\r\n    refreshDailyActivities(selectedDate, String(employeeId));\r\n  }, [selectedDate, employeeId, refreshDailyActivities]);\r\n\r\n  // Handlers\r\n  const handleDateChange = (date?: Date) => {\r\n    if (date) setSelectedDate(date);\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    const v = name === 'hours' ? value.replace(',', '.') : value;\r\n    setFormData((prev) => ({ ...prev, [name]: v } as PermissionFormData));\r\n  };\r\n\r\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) e.preventDefault();\r\n  };\r\n\r\n  const handleSelectChange = async (name: keyof PermissionFormData, value: string) => {\r\n    const updated: PermissionFormData = { ...formData, [name]: value } as PermissionFormData;\r\n    switch (name) {\r\n      case 'project_code':\r\n        updated.phase = '';\r\n        updated.discipline = '';\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setStages([]);\r\n        setDisciplines([]);\r\n        setActivities([]);\r\n        if (value) await fetchStages(value);\r\n        break;\r\n      case 'phase':\r\n        updated.discipline = '';\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setDisciplines([]);\r\n        setActivities([]);\r\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\r\n        break;\r\n      case 'discipline':\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setActivities([]);\r\n        if (value && updated.project_code && updated.phase) {\r\n          await fetchActivities(updated.project_code, updated.phase, value);\r\n        }\r\n        break;\r\n      default:\r\n        setFormData(updated);\r\n    }\r\n  };\r\n\r\n  const resetForm = useCallback(() => {\r\n    setFormData(initialFormData(employeeId));\r\n    setEditingActivityId(null);\r\n  }, [employeeId]);\r\n\r\n  const handleEditActivity = useCallback(\r\n    async (activity: Activity) => {\r\n      try {\r\n        if (activity.date) {\r\n          try {\r\n            const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\r\n            setSelectedDate(d);\r\n          } catch {}\r\n        }\r\n        if (activity.project_code) {\r\n          await fetchStages(activity.project_code);\r\n          if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\r\n          if (activity.phase && activity.discipline)\r\n            await fetchActivities(activity.project_code, activity.phase, activity.discipline);\r\n        }\r\n        setFormData({\r\n          employee_id: employeeId,\r\n          project_code: activity.project_code || '',\r\n          phase: activity.phase || '',\r\n          discipline: activity.discipline || '',\r\n          activity: activity.activity || '',\r\n          hours: String(activity.hours ?? '0'),\r\n          note: activity.note || '',\r\n        });\r\n        setEditingActivityId(String(activity.id));\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n      } catch (e) {\r\n        console.error(e);\r\n        toast.error('Error al cargar la actividad para edición');\r\n      }\r\n    },\r\n    [employeeId, fetchStages, fetchDisciplines, fetchActivities]\r\n  );\r\n\r\n  const [undoData, setUndoData] = useState<Activity | null>(null);\r\n  const triggerUndoBanner = (activity: Activity) => {\r\n    setUndoData(activity);\r\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\r\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\r\n  };\r\n\r\n  const handleUndoDelete = async () => {\r\n    if (!undoData) return;\r\n    const a = undoData;\r\n    setUndoData(null);\r\n    try {\r\n      // recrea el registro eliminado\r\n      await submitHours({\r\n        employee_id: employeeId,\r\n        date: format(selectedDate, 'yyyy-MM-dd'),\r\n        project_code: a.project_code,\r\n        phase: a.phase,\r\n        discipline: a.discipline,\r\n        activity: a.activity,\r\n        hours: Number(a.hours) || 0,\r\n        note: a.note || '',\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      toast.success('Actividad restaurada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Error al restaurar la actividad');\r\n    }\r\n  };\r\n\r\n  const doSubmit = useCallback(async (): Promise<boolean> => {\r\n    if (Object.keys(errors).length > 0) {\r\n      toast.error('Por favor completa todos los campos requeridos');\r\n      return false;\r\n    }\r\n\r\n    const payload = {\r\n      employee_id: employeeId,\r\n      date: format(selectedDate, 'yyyy-MM-dd'),\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n      hours: hoursNumber,\r\n      note: formData.note || '',\r\n      id: editingActivityId || undefined,\r\n    };\r\n\r\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\r\n    setLoading((p) => ({ ...p, submit: true }));\r\n    try {\r\n      if (editingActivityId) {\r\n        await updateHour(editingActivityId, payload);\r\n      } else {\r\n        await submitHours(payload);\r\n      }\r\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\r\n        id: toastId,\r\n        duration: 1800,\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      onSuccess?.();\r\n      return true;\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Ocurrió un error al guardar.', { id: toastId });\r\n      return false;\r\n    } finally {\r\n      setLoading((p) => ({ ...p, submit: false }));\r\n    }\r\n  }, [\r\n    editingActivityId,\r\n    employeeId,\r\n    errors,\r\n    formData.activity,\r\n    formData.discipline,\r\n    formData.phase,\r\n    formData.project_code,\r\n    formData.note,\r\n    hoursNumber,\r\n    selectedDate,\r\n    refreshDailyActivities,\r\n    onSuccess,\r\n  ]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    const ok = await doSubmit();\r\n    if (ok) resetForm();\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    const prev = dailyActivities.find((a) => String(a.id) === String(id));\r\n    try {\r\n      setLoading((p) => ({ ...p, delete: id }));\r\n      await deleteHour(id);\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      if (prev) triggerUndoBanner(prev);\r\n      toast.error('Actividad eliminada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo eliminar');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, delete: null }));\r\n    }\r\n  };\r\n\r\n  const adjustHours = (delta: number) => {\r\n    const current = hoursNumber || 0;\r\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\r\n    setFormData((prev) => ({ ...prev, hours: String(next) }));\r\n  };\r\n\r\n  // Atajos de teclado\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\r\n        e.preventDefault();\r\n        (async () => {\r\n          if (!loading.submit) {\r\n            const ok = await doSubmit();\r\n            if (ok) resetForm();\r\n          }\r\n        })();\r\n      }\r\n      if (e.key === 'Escape') {\r\n        resetForm();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [doSubmit, loading.submit, resetForm]);\r\n\r\n  // Navegación declarativa (se maneja fuera: App.tsx)\r\n  const handleNavigateToPermissions = () => {\r\n    /* noop: handled in router/App.tsx */\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#f2f6fd] text-foreground\">\r\n      <Toaster position=\"top-right\" richColors />\r\n      <Header\r\n        employeeName={employeeName}\r\n        onLogout={onLogout}\r\n        onShowPowerBI={onShowPowerBI || (() => {})}\r\n        onNavigateToHours={onNavigateToHours}\r\n        onNavigateToPermissions={handleNavigateToPermissions}\r\n        currentView=\"hours\"\r\n      />\r\n\r\n      <style>{`\r\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\r\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\r\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\r\n        .text-wrap, .text-wrap *{\r\n          overflow-wrap: anywhere;\r\n          word-break: break-word;\r\n          hyphens: auto;\r\n        }\r\n      `}</style>\r\n\r\n      <div className=\"mx-auto container p-4 sm:p-6 lg:p-8\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\">\r\n          {/* PRINCIPAL */}\r\n          <main className={cn('lg:col-span-3')}>\r\n            <Card className=\"relative z-10 flex flex-col text-wrap\">\r\n              <CardHeader className=\"relative items-center text-center\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  {editingActivityId ? <Pencil className=\"h-5 w-5\" /> : <PlusCircle className=\"h-5 w-5\" />}\r\n                  <CardTitle className=\"text-center\">\r\n                    {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\r\n                  </CardTitle>\r\n                </div>\r\n                <div className=\"absolute right-4 top-4 text-xs\">\r\n                  {editingActivityId ? (\r\n                    <span className=\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\">Editando</span>\r\n                  ) : (\r\n                    <span className=\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\">Creando</span>\r\n                  )}\r\n                </div>\r\n                <p className=\"mt-2 text-sm text-muted-foreground\">\r\n                  Registra tus horas del día para el proyecto seleccionado.\r\n                </p>\r\n\r\n                <div className=\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\">\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Briefcase className=\"h-3.5 w-3.5\" /> {formData.project_code || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ListChecks className=\"h-3.5 w-3.5\" /> {formData.phase || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Pencil className=\"h-3.5 w-3.5\" /> {formData.discipline || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ClipboardList className=\"h-3.5 w-3.5\" /> {formData.activity || '—'}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {/* Fecha */}\r\n                <div className=\"mb-4 w-full sm:max-w-xs\">\r\n                  <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                    <span className=\"inline-flex items-center gap-1\">\r\n                      <CalendarIcon className=\"h-4 w-4\" /> Fecha\r\n                    </span>\r\n                  </label>\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className={cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground')}\r\n                      >\r\n                        <span>{format(selectedDate, 'PPP', { locale: es })}</span>\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                      <Calendar mode=\"single\" selected={selectedDate} onSelect={handleDateChange} initialFocus locale={es} />\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                </div>\r\n\r\n                {/* GRID */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\">\r\n                  {/* Código de Proyecto */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Código de Proyecto\"\r\n                      name=\"project_code\"\r\n                      value={formData.project_code}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={projects.map((p) => ({\r\n                        value: p.code,\r\n                        label: p.code,\r\n                        dropdownLabel: `${p.code} - ${p.name}`,\r\n                      }))}\r\n                      placeholder=\"Seleccione un proyecto\"\r\n                      loading={loading.projects}\r\n                      disabled={loading.projects}\r\n                      icon={<Briefcase className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\">\r\n                      Elige el proyecto para cargar los demas campos.\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Nombre del Proyecto */}\r\n                  <div className=\"space-y-2 text-wrap\">\r\n                    <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Folder className=\"h-4 w-4\" /> Nombre del Proyecto\r\n                      </span>\r\n                    </label>\r\n                    <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" aria-label=\"Nombre de proyecto seleccionado\" />\r\n                  </div>\r\n\r\n                  {/* Etapa */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Etapa\"\r\n                      name=\"phase\"\r\n                      value={formData.phase}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={stages.map((s) => ({ value: s, label: s }))}\r\n                      placeholder=\"Seleccione una etapa\"\r\n                      loading={loading.stages}\r\n                      disabled={!formData.project_code || loading.stages}\r\n                      icon={<ListChecks className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Etapas disponibles para el proyecto elegido.</p>\r\n                  </div>\r\n\r\n                  {/* Disciplina */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Disciplina\"\r\n                      name=\"discipline\"\r\n                      value={formData.discipline}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\r\n                      placeholder=\"Seleccione una disciplina\"\r\n                      loading={loading.disciplines}\r\n                      disabled={!formData.phase || loading.disciplines}\r\n                      icon={<Pencil className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Se filtran según la etapa seleccionada.</p>\r\n                  </div>\r\n\r\n                  {/* Actividad */}\r\n                  <div className=\"w-full md:w-[320px] text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Actividad\"\r\n                      name=\"activity\"\r\n                      value={formData.activity}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={activities.map((a) => ({ value: a, label: a }))}\r\n                      placeholder=\"Seleccione una actividad\"\r\n                      loading={loading.activities}\r\n                      disabled={!formData.discipline || loading.activities}\r\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Horas */}\r\n                  <div className=\"flex flex-col text-wrap\">\r\n                    <label htmlFor=\"hours\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Clock className=\"h-4 w-4\" /> Horas <span className=\"text-destructive\">*</span>\r\n                      </span>\r\n                    </label>\r\n\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(-0.5)}\r\n                        aria-label=\"Restar 0.5h\"\r\n                      >\r\n                        <Minus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(0.5)}\r\n                        aria-label=\"Sumar 0.5h\"\r\n                      >\r\n                        <Plus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      <Input\r\n                        id=\"hours\"\r\n                        name=\"hours\"\r\n                        type=\"number\"\r\n                        value={formData.hours}\r\n                        onChange={handleChange}\r\n                        min=\"0\"\r\n                        step=\"0.5\"\r\n                        ref={hoursInputRef}\r\n                        className=\"h-10 w-[100px] shrink-0 rounded-md mr-0\"\r\n                      />\r\n\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={isCurrentFavorite ? 'default' : 'outline'}\r\n                        className=\"h-10 shrink-0\"\r\n                        onClick={toggleFavorite}\r\n                        title={isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito'}\r\n                      >\r\n                        <Star className=\"h-4 w-4 mr-2\" /> Favorito\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Favoritos */}\r\n                  {favorites.length > 0 && (\r\n                    <div className=\"md:col-span-2\">\r\n                      <div\r\n                        ref={favScrollRef}\r\n                        onWheel={handleFavWheel}\r\n                        className=\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\"\r\n                        style={{ overscrollBehaviorX: 'contain', overscrollBehaviorY: 'none', touchAction: 'pan-x' }}\r\n                      >\r\n                        <div className=\"flex gap-2\">\r\n                          {favorites.map((fav, idx) => (\r\n                            <button\r\n                              key={idx}\r\n                              type=\"button\"\r\n                              onClick={() => applyFavorite(fav)}\r\n                              className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\"\r\n                              title={`${fav.project_code} • ${fav.phase} • ${fav.discipline}`}\r\n                            >\r\n                              <Star className=\"h-3.5 w-3.5\" />\r\n                              <span className=\"font-medium\">{fav.activity}</span>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Nota */}\r\n                  <div className=\"md:col-span-2 w-full text-wrap\">\r\n                    <label htmlFor=\"note\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Info className=\"h-4 w-4\" /> Nota (Opcional)\r\n                      </span>\r\n                    </label>\r\n                    <textarea\r\n                      id=\"note\"\r\n                      name=\"note\"\r\n                      value={formData.note}\r\n                      onChange={handleChange}\r\n                      onKeyDown={handleNoteKeyDown}\r\n                      rows={2}\r\n                      className=\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\"\r\n                      placeholder=\"Descripción breve del trabajo realizado\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Acciones */}\r\n                <div className=\"mt-6 flex items-center justify-end gap-3\">\r\n                  <Button\r\n                    type=\"submit\"\r\n                    onClick={(e) => {\r\n                      e.preventDefault();\r\n                      handleSubmit(e as any);\r\n                    }}\r\n                    disabled={loading.submit || Object.keys(errors).length > 0}\r\n                    className=\"h-11\"\r\n                  >\r\n                    {loading.submit ? (\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      <Save className=\"mr-2 h-4 w-4\" />\r\n                    )}\r\n                    {editingActivityId ? 'Actualizar' : 'Guardar'}\r\n                  </Button>\r\n\r\n                  {editingActivityId && (\r\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"h-11\">\r\n                      <XCircle className=\"mr-2 h-4 w-4\" /> Cancelar edición\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </main>\r\n\r\n          {/* LATERAL */}\r\n          <aside className=\"lg:col-span-2\">\r\n            <Card className=\"h-full text-wrap\">\r\n              <CardHeader className=\"relative\">\r\n                <CardTitle className=\"text-center flex items-center justify-center gap-2\">\r\n                  <ClipboardList className=\"h-5 w-5\" />\r\n                  Actividades del Día\r\n                </CardTitle>\r\n                <Button\r\n                  type=\"button\"\r\n                variant=\"outline\"\r\n                  size=\"icon\"\r\n                  title=\"Ordenar\"\r\n                  onClick={() => setSortDir((d) => (d === 'asc' ? 'desc' : 'asc'))}\r\n                  className=\"absolute right-4 top-4\"\r\n                >\r\n                  <ArrowUpDown className=\"h-4 w-4\" />\r\n                </Button>\r\n\r\n                <div className=\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\">\r\n                  <span className=\"inline-flex items-center gap-2\">\r\n                    <CalendarIcon className=\"h-4 w-4\" /> {format(selectedDate, 'PPP', { locale: es })}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\">\r\n                    Total registros: {dailyActivities.length}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {loading.dailyActivities ? (\r\n                  <ActivityListSkeleton />\r\n                ) : visibleActivities.length > 0 ? (\r\n                  <>\r\n                    <div className=\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\">\r\n                      {visibleActivities.map((activity) => (\r\n                        <div key={String(activity.id)} className=\"text-wrap\">\r\n                          <ActivityItem activity={activity} onEdit={handleEditActivity} onDelete={handleDelete} />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"pt-3\">\r\n                      <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <EmptyState />\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </aside>\r\n        </div>\r\n      </div>\r\n\r\n      {undoData && (\r\n        <div className=\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\">\r\n          <span className=\"text-sm\">Registro eliminado.</span>\r\n          <Button size=\"sm\" variant=\"outline\" onClick={handleUndoDelete}>\r\n            Deshacer\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormularioPermisos;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}