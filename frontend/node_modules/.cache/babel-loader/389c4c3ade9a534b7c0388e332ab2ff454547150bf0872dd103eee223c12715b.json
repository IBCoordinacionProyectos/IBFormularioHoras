{"ast":null,"code":"import _objectSpread from\"D:/formulario de horas/FormularioHoras Version 1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useMemo}from'react';import{format,parseISO}from'date-fns';import{es}from'date-fns/locale';import Header from'./Header';import{toast}from'sonner';import{Calendar as CalendarIcon,Briefcase,Save,Pencil,ListChecks,ClipboardList,XCircle,PlusCircle,Loader2}from'lucide-react';import{Card,CardContent,CardHeader,CardTitle}from'./ui/card';import{Button}from'./ui/button';import{Input}from'./ui/input';import{Calendar}from'./ui/calendar';import{Popover,PopoverContent,PopoverTrigger}from'./ui/popover';import{cn}from'../lib/utils';import{FormSelect}from'./formulario/FormSelect';import{ActivityItem}from'./formulario/ActivityItem';import{ActivityListSkeleton}from'./formulario/ActivityListSkeleton';import{EmptyState}from'./formulario/EmptyState';import{TotalHoursProgress}from'./formulario/TotalHoursProgress';import{submitHours,getProjects,getProjectStages,getDisciplinesByStage,getActivitiesByDiscipline,getDailyActivities,deleteHour}from'../api/horasApi';// Props e interfaces\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const initialFormData=employeeId=>({employee_id:String(employeeId),project_code:'',phase:'',discipline:'',activity:'',hours:'',note:''});const FormularioHoras=_ref=>{let{onSuccess,employeeId,employeeName,onLogout}=_ref;// State\nconst[formData,setFormData]=useState(initialFormData(employeeId));const[selectedDate,setSelectedDate]=useState(new Date());const[dailyActivities,setDailyActivities]=useState([]);const[projects,setProjects]=useState([]);const[stages,setStages]=useState([]);const[disciplines,setDisciplines]=useState([]);const[activities,setActivities]=useState([]);const[editingActivityId,setEditingActivityId]=useState(null);// Loading\nconst[loading,setLoading]=useState({submit:false,projects:true,stages:false,disciplines:false,activities:false,dailyActivities:true,delete:null// ID de la actividad que se está eliminando o null\n});// Derivados\nconst totalHoursToday=useMemo(()=>dailyActivities.reduce((sum,a)=>sum+a.hours,0),[dailyActivities]);const selectedProjectName=useMemo(()=>{var _projects$find;return((_projects$find=projects.find(p=>p.code===formData.project_code))===null||_projects$find===void 0?void 0:_projects$find.name)||'';},[formData.project_code,projects]);// Normaliza horas: '1,5' -> 1.5\nconst hoursNumber=useMemo(()=>{var _formData$hours;const raw=String((_formData$hours=formData.hours)!==null&&_formData$hours!==void 0?_formData$hours:'').replace(',','.').trim();const n=Number(raw);return Number.isFinite(n)?n:0;},[formData.hours]);// Validación booleana real\nconst isFormValid=useMemo(()=>{const required=[formData.project_code,formData.phase,formData.discipline,formData.activity];const allFilled=required.every(v=>typeof v==='string'?v.trim().length>0:Boolean(v));return allFilled&&hoursNumber>0;},[formData.project_code,formData.phase,formData.discipline,formData.activity,hoursNumber]);// Fetchers\nconst refreshDailyActivities=useCallback(async(date,id)=>{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{dailyActivities:true}));try{const dateString=format(date,'yyyy-MM-dd');const acts=await getDailyActivities(dateString,Number(id));setDailyActivities(acts);}catch(error){toast.error('Error al cargar las actividades del día.');console.error(error);}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{dailyActivities:false}));}},[]);const fetchProjects=useCallback(async()=>{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{projects:true}));try{const projectData=await getProjects();setProjects(projectData);}catch(error){toast.error('Error al cargar proyectos.');console.error(error);}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{projects:false}));}},[]);const fetchStages=useCallback(async projectCode=>{if(!projectCode)return;setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{stages:true}));try{const stageData=await getProjectStages(projectCode);// Filtrar valores nulos o vacíos y convertir a string\nconst validStages=stageData.filter(stage=>stage!=null&&String(stage).trim()!=='').map(String);setStages(validStages);return validStages;}catch(error){console.error('Error al cargar las etapas:',error);toast.error('Error al cargar las etapas del proyecto.');setStages([]);return[];}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{stages:false}));}},[]);const fetchDisciplines=useCallback(async(projectCode,stage)=>{if(!projectCode||!stage){setDisciplines([]);return[];}setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{disciplines:true}));try{const disciplineData=await getDisciplinesByStage(projectCode,stage);// Filtrar valores nulos o vacíos y convertir a string\nconst validDisciplines=disciplineData.filter(discipline=>discipline!=null&&String(discipline).trim()!=='').map(String);setDisciplines(validDisciplines);return validDisciplines;}catch(error){console.error('Error al cargar las disciplinas:',error);toast.error('Error al cargar las disciplinas.');setDisciplines([]);return[];}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{disciplines:false}));}},[]);const fetchActivities=useCallback(async(projectCode,stage,discipline)=>{if(!projectCode||!stage||!discipline){setActivities([]);return[];}setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{activities:true}));try{const activityData=await getActivitiesByDiscipline(projectCode,stage,discipline);// Filtrar valores nulos o vacíos y convertir a string\nconst validActivities=activityData.filter(activity=>activity!=null&&String(activity).trim()!=='').map(String);setActivities(validActivities);return validActivities;}catch(error){console.error('Error al cargar las actividades:',error);toast.error('Error al cargar las actividades.');setActivities([]);return[];}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{activities:false}));}},[]);// Effects\nuseEffect(()=>{fetchProjects();},[fetchProjects]);useEffect(()=>{refreshDailyActivities(selectedDate,String(employeeId));},[selectedDate,employeeId,refreshDailyActivities]);// Handlers\nconst handleDateChange=date=>{if(date){setSelectedDate(date);refreshDailyActivities(date,String(employeeId));}};const handleChange=e=>{const{name,value}=e.target;const v=name==='hours'?value.replace(',','.'):value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:v}));};// Manejar la tecla Enter en el textarea de notas\nconst handleNoteKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();}};const handleSelectChange=async(name,value)=>{// Crear una copia actualizada del formulario\nconst updatedFormData=_objectSpread(_objectSpread({},formData),{},{[name]:value});// Manejar cambios en cascada basados en el campo modificado\nswitch(name){case'project_code':// Limpiar campos dependientes\nupdatedFormData.phase='';updatedFormData.discipline='';updatedFormData.activity='';// Limpiar estados de opciones\nsetStages([]);setDisciplines([]);setActivities([]);// Cargar etapas si hay un proyecto seleccionado\nif(value){await fetchStages(value);}break;case'phase':// Limpiar campos dependientes\nupdatedFormData.discipline='';updatedFormData.activity='';// Limpiar estados de opciones dependientes\nsetDisciplines([]);setActivities([]);// Cargar disciplinas si hay una fase seleccionada\nif(value&&updatedFormData.project_code){await fetchDisciplines(updatedFormData.project_code,value);}break;case'discipline':// Limpiar actividad\nupdatedFormData.activity='';// Limpiar actividades\nsetActivities([]);// Cargar actividades si hay una disciplina seleccionada\nif(value&&updatedFormData.project_code&&updatedFormData.phase){await fetchActivities(updatedFormData.project_code,updatedFormData.phase,value);}break;}// Actualizar el estado del formulario\nsetFormData(updatedFormData);};const resetForm=useCallback(()=>{setFormData(initialFormData(employeeId));setEditingActivityId(null);},[employeeId]);// Precarga dependencias al editar + rellena form\nconst handleEditActivity=useCallback(async activity=>{try{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{form:true}));// Guardar el ID de la actividad que se está editando\nsetEditingActivityId(activity.id);// Actualizar la fecha si es necesario\nif(activity.date){try{const activityDate=parseISO(activity.date);// Solo actualizar la fecha si es diferente a la actual\nif(format(activityDate,'yyyy-MM-dd')!==format(selectedDate,'yyyy-MM-dd')){await new Promise(resolve=>{setSelectedDate(activityDate);// Esperar a que se complete la actualización de la fecha\nsetTimeout(resolve,100);});}}catch(error){console.error('Error al analizar la fecha:',error);}}// 1. Primero establecer el proyecto en el formulario\nconst updatedFormData=_objectSpread(_objectSpread({},formData),{},{project_code:activity.project_code||'',phase:'',discipline:'',activity:'',employee_id:String(activity.employee_id||employeeId),hours:String(activity.hours||''),note:activity.note||''});// 2. Cargar las etapas del proyecto\nawait fetchStages(activity.project_code);// 3. Actualizar la fase en el formulario\nupdatedFormData.phase=activity.phase||'';setFormData(updatedFormData);// 4. Cargar las disciplinas para la fase\nif(activity.phase){await fetchDisciplines(activity.project_code,activity.phase);// 5. Actualizar la disciplina en el formulario\nupdatedFormData.discipline=activity.discipline||'';setFormData(updatedFormData);// 6. Cargar las actividades para la disciplina\nif(activity.discipline){await fetchActivities(activity.project_code,activity.phase,activity.discipline);// 7. Actualizar la actividad en el formulario\nupdatedFormData.activity=activity.activity||'';setFormData(updatedFormData);}}// Desplazar al formulario\nwindow.scrollTo({top:0,behavior:'smooth'});}catch(error){console.error('Error al cargar la actividad para edición:',error);toast.error('Error al cargar la actividad para edición');}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{form:false}));}},[fetchStages,fetchDisciplines,fetchActivities,selectedDate,formData,employeeId]);const handleDelete=async idToDelete=>{try{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{delete:idToDelete}));// Mostrar mensaje de carga\nconst toastId=toast.loading('Eliminando actividad...');await deleteHour(idToDelete);// Actualizar la lista de actividades\nawait refreshDailyActivities(selectedDate,String(employeeId));// Si la actividad eliminada es la que se estaba editando, limpiar el formulario\nif(editingActivityId===idToDelete){resetForm();}// Mostrar mensaje de éxito\ntoast.success('Actividad eliminada correctamente',{id:toastId,duration:3000});}catch(error){console.error('Error al eliminar la actividad:',error);toast.error('Error al eliminar la actividad. Por favor, intente nuevamente.',{duration:4000});}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{delete:null}));}};const handleSubmit=async e=>{e.preventDefault();// Validar campos requeridos\nif(!formData.project_code||!formData.phase||!formData.discipline||!formData.activity||!formData.hours){toast.error('Por favor complete todos los campos requeridos.',{duration:3000});return;}// Validar formato de horas\nconst hoursValue=parseFloat(formData.hours.replace(',','.'));if(isNaN(hoursValue)||hoursValue<=0){toast.error('Por favor ingrese un número válido de horas.',{duration:3000});return;}setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{submit:true}));try{var _projects$find2;// Preparar datos para enviar\nconst submissionData=_objectSpread(_objectSpread({},formData),{},{date:format(selectedDate,'yyyy-MM-dd'),project_name:((_projects$find2=projects.find(p=>p.code===formData.project_code))===null||_projects$find2===void 0?void 0:_projects$find2.name)||formData.project_code,hours:hoursValue,// Usar el valor numérico normalizado\nemployee_id:employeeId,id:editingActivityId||undefined});// Enviar datos\nawait submitHours(submissionData);// Mostrar mensaje de éxito\ntoast.success(\"Actividad \".concat(editingActivityId?'actualizada':'guardada',\" con \\xE9xito.\"),{duration:3000,style:{backgroundColor:'#28a745',color:'white',border:'none',fontSize:'14px',padding:'12px 20px',borderRadius:'4px'}});// Limpiar formulario y actualizar lista de actividades\nresetForm();refreshDailyActivities(selectedDate,String(employeeId));// Llamar a la función de éxito si existe\nif(onSuccess){onSuccess();}}catch(error){console.error('Error al guardar la actividad:',error);toast.error('Error al guardar la actividad. Por favor, intente nuevamente.',{duration:4000,style:{backgroundColor:'#dc3545',color:'white',fontSize:'14px',padding:'12px 20px',borderRadius:'4px'}});}finally{setLoading(prev=>_objectSpread(_objectSpread({},prev),{},{submit:false}));}};// Render\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{userName:employeeName,onLogout:onLogout}),/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto p-4 sm:p-6 lg:p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-5 gap-8\",children:[/*#__PURE__*/_jsx(\"main\",{className:\"lg:col-span-3\",children:/*#__PURE__*/_jsxs(Card,{className:\"relative z-10\",children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(CardTitle,{className:\"flex items-center justify-center\",children:[editingActivityId?/*#__PURE__*/_jsx(Pencil,{className:\"mr-2 h-5 w-5\"}):/*#__PURE__*/_jsx(PlusCircle,{className:\"mr-2 h-5 w-5\"}),editingActivityId?'Editar Actividad':'Registrar Actividad']})}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full md:w-1/3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:\"Fecha\"}),/*#__PURE__*/_jsxs(Popover,{children:[/*#__PURE__*/_jsx(PopoverTrigger,{asChild:true,children:/*#__PURE__*/_jsxs(Button,{variant:\"outline\",className:cn('w-full justify-start text-left font-normal',!selectedDate&&'text-muted-foreground'),children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"mr-2 h-4 w-4\"}),selectedDate?/*#__PURE__*/_jsx(\"span\",{children:format(selectedDate,'PPP',{locale:es})}):/*#__PURE__*/_jsx(\"span\",{children:\"Seleccione una fecha\"})]})}),/*#__PURE__*/_jsx(PopoverContent,{className:\"w-auto p-0\",children:/*#__PURE__*/_jsx(Calendar,{mode:\"single\",selected:selectedDate,onSelect:handleDateChange,initialFocus:true,locale:es})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"C\\xF3digo de Proyecto\",name:\"project_code\",value:formData.project_code,onValueChange:handleSelectChange,options:projects.map(p=>({value:p.code,label:p.code,// En el trigger solo se ve el código\ndropdownLabel:\"\".concat(p.code,\" - \").concat(p.name)// En la lista: código - nombre\n})),placeholder:\"Seleccione un proyecto\",loading:loading.projects,disabled:loading.projects,icon:/*#__PURE__*/_jsx(Briefcase,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-foreground/80 mb-1\",children:\"Nombre del Proyecto\"}),/*#__PURE__*/_jsx(Input,{value:selectedProjectName,readOnly:true,className:\"bg-muted/50\"})]}),/*#__PURE__*/_jsx(FormSelect,{label:\"Etapa\",name:\"phase\",value:formData.phase,onValueChange:handleSelectChange,options:stages.map(s=>({value:s,label:s})),placeholder:\"Seleccione una etapa\",loading:loading.stages,disabled:!formData.project_code||loading.stages,icon:/*#__PURE__*/_jsx(ListChecks,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(FormSelect,{label:\"Disciplina\",name:\"discipline\",value:formData.discipline,onValueChange:handleSelectChange,options:disciplines.map(d=>({value:d,label:d})),placeholder:\"Seleccione una disciplina\",loading:loading.disciplines,disabled:!formData.phase||loading.disciplines,icon:/*#__PURE__*/_jsx(Pencil,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(FormSelect,{label:\"Actividad\",name:\"activity\",value:formData.activity,onValueChange:handleSelectChange,options:activities.map(a=>({value:a,label:a})),placeholder:\"Seleccione una actividad\",loading:loading.activities,disabled:!formData.discipline||loading.activities,icon:/*#__PURE__*/_jsx(ClipboardList,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"hours\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:[\"Horas \",/*#__PURE__*/_jsx(\"span\",{className:\"text-destructive\",children:\"*\"})]}),/*#__PURE__*/_jsx(Input,{id:\"hours\",name:\"hours\",type:\"number\",value:formData.hours,onChange:handleChange,min:\"0.5\",step:\"0.5\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"note\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:\"Nota (Opcional)\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"note\",name:\"note\",value:formData.note,onChange:handleChange,onKeyDown:handleNoteKeyDown,rows:3,className:\"flex h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",placeholder:\"Escriba una nota (opcional)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end items-center gap-3 pt-4\",children:[editingActivityId&&/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:\"outline\",onClick:resetForm,children:[/*#__PURE__*/_jsx(XCircle,{className:\"mr-2 h-4 w-4\"}),\"Cancelar Edici\\xF3n\"]}),/*#__PURE__*/_jsxs(Button,{type:\"submit\",disabled:!isFormValid||loading.submit,className:\"min-w-[150px]\",children:[loading.submit?/*#__PURE__*/_jsx(Loader2,{className:\"mr-2 h-4 w-4 animate-spin\"}):/*#__PURE__*/_jsx(Save,{className:\"mr-2 h-4 w-4\"}),editingActivityId?'Actualizar':'Guardar']})]})]})})]})}),/*#__PURE__*/_jsx(\"aside\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(CardTitle,{className:\"text-center\",children:\"Actividades del D\\xEDa\"})}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:loading.dailyActivities?/*#__PURE__*/_jsx(ActivityListSkeleton,{}):dailyActivities.length>0?dailyActivities.map(activity=>/*#__PURE__*/_jsx(ActivityItem,{activity:activity,onEdit:handleEditActivity,onDelete:handleDelete},activity.id)):/*#__PURE__*/_jsx(EmptyState,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsx(TotalHoursProgress,{totalHours:totalHoursToday,selectedDate:selectedDate})})]})]})})]})})]});};export default FormularioHoras;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","format","parseISO","es","Header","toast","Calendar","CalendarIcon","Briefcase","Save","Pencil","ListChecks","ClipboardList","XCircle","PlusCircle","Loader2","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","cn","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","submitHours","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","getDailyActivities","deleteHour","jsx","_jsx","jsxs","_jsxs","initialFormData","employeeId","employee_id","String","project_code","phase","discipline","activity","hours","note","FormularioHoras","_ref","onSuccess","employeeName","onLogout","formData","setFormData","selectedDate","setSelectedDate","Date","dailyActivities","setDailyActivities","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","editingActivityId","setEditingActivityId","loading","setLoading","submit","delete","totalHoursToday","reduce","sum","a","selectedProjectName","_projects$find","find","p","code","name","hoursNumber","_formData$hours","raw","replace","trim","n","Number","isFinite","isFormValid","required","allFilled","every","v","length","Boolean","refreshDailyActivities","date","id","prev","_objectSpread","dateString","acts","error","console","fetchProjects","projectData","fetchStages","projectCode","stageData","validStages","filter","stage","map","fetchDisciplines","disciplineData","validDisciplines","fetchActivities","activityData","validActivities","handleDateChange","handleChange","e","value","target","handleNoteKeyDown","key","shiftKey","preventDefault","handleSelectChange","updatedFormData","resetForm","handleEditActivity","form","activityDate","Promise","resolve","setTimeout","window","scrollTo","top","behavior","handleDelete","idToDelete","toastId","success","duration","handleSubmit","hoursValue","parseFloat","isNaN","_projects$find2","submissionData","project_name","undefined","concat","style","backgroundColor","color","border","fontSize","padding","borderRadius","children","userName","className","onSubmit","htmlFor","asChild","variant","locale","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","readOnly","s","d","type","onChange","min","step","onKeyDown","rows","onClick","onEdit","onDelete","totalHours"],"sources":["D:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioHoras.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\n\nimport { toast } from 'sonner';\nimport {\n  Calendar as CalendarIcon,\n  Briefcase,\n  Save,\n  Pencil,\n  ListChecks,\n  ClipboardList,\n  XCircle,\n  PlusCircle,\n  Loader2,\n} from 'lucide-react';\n\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { cn } from '../lib/utils';\n\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\n\nimport {\n  submitHours,\n  getProjects,\n  getProjectStages,\n  getDisciplinesByStage,\n  getActivitiesByDiscipline,\n  getDailyActivities,\n  deleteHour,\n} from '../api/horasApi';\n\n// Props e interfaces\ninterface FormularioHorasProps {\n  onSuccess: () => void;\n  employeeId: number;\n  employeeName: string;\n  onLogout: () => void;\n}\n\ninterface Project {\n  code: string;\n  name: string;\n}\n\ninterface Activity {\n  id: number;\n  date: string;\n  employee_id: number;\n  project_code: string;\n  project_name: string;\n  phase: string;\n  discipline: string;\n  activity: string;\n  hours: number;\n  note: string;\n}\n\nconst initialFormData = (employeeId: number) => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '',\n  note: '',\n});\n\nconst FormularioHoras: React.FC<FormularioHorasProps> = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout,\n}) => {\n  // State\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [stages, setStages] = useState<string[]>([]);\n  const [disciplines, setDisciplines] = useState<string[]>([]);\n  const [activities, setActivities] = useState<string[]>([]);\n  const [editingActivityId, setEditingActivityId] = useState<number | null>(null);\n\n  // Loading\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null as number | null, // ID de la actividad que se está eliminando o null\n  });\n\n  // Derivados\n  const totalHoursToday = useMemo(\n    () => dailyActivities.reduce((sum, a) => sum + a.hours, 0),\n    [dailyActivities]\n  );\n\n  const selectedProjectName = useMemo(\n    () => projects.find((p) => p.code === formData.project_code)?.name || '',\n    [formData.project_code, projects]\n  );\n\n  // Normaliza horas: '1,5' -> 1.5\n  const hoursNumber = useMemo(() => {\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n\n  // Validación booleana real\n  const isFormValid = useMemo(() => {\n    const required = [\n      formData.project_code,\n      formData.phase,\n      formData.discipline,\n      formData.activity,\n    ];\n    const allFilled = required.every((v) =>\n      typeof v === 'string' ? v.trim().length > 0 : Boolean(v)\n    );\n    return allFilled && hoursNumber > 0;\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity, hoursNumber]);\n\n  // Fetchers\n  const refreshDailyActivities = useCallback(async (date: Date, id: string) => {\n    setLoading((prev) => ({ ...prev, dailyActivities: true }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (error) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(error);\n    } finally {\n      setLoading((prev) => ({ ...prev, dailyActivities: false }));\n    }\n  }, []);\n\n  const fetchProjects = useCallback(async () => {\n    setLoading((prev) => ({ ...prev, projects: true }));\n    try {\n      const projectData = await getProjects();\n      setProjects(projectData);\n    } catch (error) {\n      toast.error('Error al cargar proyectos.');\n      console.error(error);\n    } finally {\n      setLoading((prev) => ({ ...prev, projects: false }));\n    }\n  }, []);\n\n  const fetchStages = useCallback(async (projectCode: string) => {\n    if (!projectCode) return;\n    \n    setLoading((prev) => ({ ...prev, stages: true }));\n    try {\n      const stageData = await getProjectStages(projectCode);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validStages = stageData\n        .filter((stage: any) => stage != null && String(stage).trim() !== '')\n        .map(String);\n      \n      setStages(validStages);\n      return validStages;\n    } catch (error) {\n      console.error('Error al cargar las etapas:', error);\n      toast.error('Error al cargar las etapas del proyecto.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading((prev) => ({ ...prev, stages: false }));\n    }\n  }, []);\n\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\n    if (!projectCode || !stage) {\n      setDisciplines([]);\n      return [];\n    }\n    \n    setLoading((prev) => ({ ...prev, disciplines: true }));\n    try {\n      const disciplineData = await getDisciplinesByStage(projectCode, stage);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validDisciplines = disciplineData\n        .filter((discipline: any) => discipline != null && String(discipline).trim() !== '')\n        .map(String);\n      \n      setDisciplines(validDisciplines);\n      return validDisciplines;\n    } catch (error) {\n      console.error('Error al cargar las disciplinas:', error);\n      toast.error('Error al cargar las disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading((prev) => ({ ...prev, disciplines: false }));\n    }\n  }, []);\n\n  const fetchActivities = useCallback(\n    async (projectCode: string, stage: string, discipline: string) => {\n      if (!projectCode || !stage || !discipline) {\n        setActivities([]);\n        return [];\n      }\n      \n      setLoading((prev) => ({ ...prev, activities: true }));\n      try {\n        const activityData = await getActivitiesByDiscipline(projectCode, stage, discipline);\n        // Filtrar valores nulos o vacíos y convertir a string\n        const validActivities = activityData\n          .filter((activity: any) => activity != null && String(activity).trim() !== '')\n          .map(String);\n        \n        setActivities(validActivities);\n        return validActivities;\n      } catch (error) {\n        console.error('Error al cargar las actividades:', error);\n        toast.error('Error al cargar las actividades.');\n        setActivities([]);\n        return [];\n      } finally {\n        setLoading((prev) => ({ ...prev, activities: false }));\n      }\n    },\n    []\n  );\n\n  // Effects\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n\n  // Handlers\n  const handleDateChange = (date: Date | undefined) => {\n    if (date) {\n      setSelectedDate(date);\n      refreshDailyActivities(date, String(employeeId));\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData((prev) => ({ ...prev, [name]: v }));\n  };\n\n  // Manejar la tecla Enter en el textarea de notas\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n    }\n  };\n\n  const handleSelectChange = async (name: string, value: string) => {\n    // Crear una copia actualizada del formulario\n    const updatedFormData = { ...formData, [name]: value };\n\n    // Manejar cambios en cascada basados en el campo modificado\n    switch (name) {\n      case 'project_code':\n        // Limpiar campos dependientes\n        updatedFormData.phase = '';\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n        \n        // Limpiar estados de opciones\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n        \n        // Cargar etapas si hay un proyecto seleccionado\n        if (value) {\n          await fetchStages(value);\n        }\n        break;\n        \n      case 'phase':\n        // Limpiar campos dependientes\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n        \n        // Limpiar estados de opciones dependientes\n        setDisciplines([]);\n        setActivities([]);\n        \n        // Cargar disciplinas si hay una fase seleccionada\n        if (value && updatedFormData.project_code) {\n          await fetchDisciplines(updatedFormData.project_code, value);\n        }\n        break;\n        \n      case 'discipline':\n        // Limpiar actividad\n        updatedFormData.activity = '';\n        \n        // Limpiar actividades\n        setActivities([]);\n        \n        // Cargar actividades si hay una disciplina seleccionada\n        if (value && updatedFormData.project_code && updatedFormData.phase) {\n          await fetchActivities(\n            updatedFormData.project_code, \n            updatedFormData.phase, \n            value\n          );\n        }\n        break;\n    }\n\n    // Actualizar el estado del formulario\n    setFormData(updatedFormData);\n  };\n\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n\n  // Precarga dependencias al editar + rellena form\n  const handleEditActivity = useCallback(\n    async (activity: Activity) => {\n      try {\n        setLoading(prev => ({ ...prev, form: true }));\n        \n        // Guardar el ID de la actividad que se está editando\n        setEditingActivityId(activity.id);\n        \n        // Actualizar la fecha si es necesario\n        if (activity.date) {\n          try {\n            const activityDate = parseISO(activity.date);\n            // Solo actualizar la fecha si es diferente a la actual\n            if (format(activityDate, 'yyyy-MM-dd') !== format(selectedDate, 'yyyy-MM-dd')) {\n              await new Promise<void>((resolve) => {\n                setSelectedDate(activityDate);\n                // Esperar a que se complete la actualización de la fecha\n                setTimeout(resolve, 100);\n              });\n            }\n          } catch (error) {\n            console.error('Error al analizar la fecha:', error);\n          }\n        }\n\n        // 1. Primero establecer el proyecto en el formulario\n        const updatedFormData = {\n          ...formData,\n          project_code: activity.project_code || '',\n          phase: '',\n          discipline: '',\n          activity: '',\n          employee_id: String(activity.employee_id || employeeId),\n          hours: String(activity.hours || ''),\n          note: activity.note || '',\n        };\n        \n        // 2. Cargar las etapas del proyecto\n        await fetchStages(activity.project_code);\n        \n        // 3. Actualizar la fase en el formulario\n        updatedFormData.phase = activity.phase || '';\n        setFormData(updatedFormData);\n        \n        // 4. Cargar las disciplinas para la fase\n        if (activity.phase) {\n          await fetchDisciplines(activity.project_code, activity.phase);\n          \n          // 5. Actualizar la disciplina en el formulario\n          updatedFormData.discipline = activity.discipline || '';\n          setFormData(updatedFormData);\n          \n          // 6. Cargar las actividades para la disciplina\n          if (activity.discipline) {\n            await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n            \n            // 7. Actualizar la actividad en el formulario\n            updatedFormData.activity = activity.activity || '';\n            setFormData(updatedFormData);\n          }\n        }\n\n        // Desplazar al formulario\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n        \n      } catch (error) {\n        console.error('Error al cargar la actividad para edición:', error);\n        toast.error('Error al cargar la actividad para edición');\n      } finally {\n        setLoading(prev => ({ ...prev, form: false }));\n      }\n    },\n    [fetchStages, fetchDisciplines, fetchActivities, selectedDate, formData, employeeId]\n  );\n\n  const handleDelete = async (idToDelete: number) => {\n    try {\n      setLoading(prev => ({ ...prev, delete: idToDelete }));\n      \n      // Mostrar mensaje de carga\n      const toastId = toast.loading('Eliminando actividad...');\n      \n      await deleteHour(idToDelete);\n      \n      // Actualizar la lista de actividades\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      \n      // Si la actividad eliminada es la que se estaba editando, limpiar el formulario\n      if (editingActivityId === idToDelete) {\n        resetForm();\n      }\n      \n      // Mostrar mensaje de éxito\n      toast.success('Actividad eliminada correctamente', { \n        id: toastId,\n        duration: 3000,\n      });\n      \n    } catch (error) {\n      console.error('Error al eliminar la actividad:', error);\n      toast.error('Error al eliminar la actividad. Por favor, intente nuevamente.', { \n        duration: 4000,\n      });\n    } finally {\n      setLoading(prev => ({ ...prev, delete: null }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validar campos requeridos\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity || !formData.hours) {\n      toast.error('Por favor complete todos los campos requeridos.', { duration: 3000 });\n      return;\n    }\n\n    // Validar formato de horas\n    const hoursValue = parseFloat(formData.hours.replace(',', '.'));\n    if (isNaN(hoursValue) || hoursValue <= 0) {\n      toast.error('Por favor ingrese un número válido de horas.', { duration: 3000 });\n      return;\n    }\n\n    setLoading((prev) => ({ ...prev, submit: true }));\n\n    try {\n      // Preparar datos para enviar\n      const submissionData = {\n        ...formData,\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        project_name: projects.find(p => p.code === formData.project_code)?.name || formData.project_code,\n        hours: hoursValue, // Usar el valor numérico normalizado\n        employee_id: employeeId,\n        id: editingActivityId || undefined,\n      };\n\n      // Enviar datos\n      await submitHours(submissionData);\n      \n      // Mostrar mensaje de éxito\n      toast.success(\n        `Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`,\n        {\n          duration: 3000,\n          style: { \n            backgroundColor: '#28a745', \n            color: 'white', \n            border: 'none',\n            fontSize: '14px',\n            padding: '12px 20px',\n            borderRadius: '4px'\n          },\n        }\n      );\n      \n      // Limpiar formulario y actualizar lista de actividades\n      resetForm();\n      refreshDailyActivities(selectedDate, String(employeeId));\n      \n      // Llamar a la función de éxito si existe\n      if (onSuccess) {\n        onSuccess();\n      }\n      \n    } catch (error) {\n      console.error('Error al guardar la actividad:', error);\n      toast.error(\n        'Error al guardar la actividad. Por favor, intente nuevamente.', \n        { \n          duration: 4000,\n          style: { \n            backgroundColor: '#dc3545', \n            color: 'white',\n            fontSize: '14px',\n            padding: '12px 20px',\n            borderRadius: '4px'\n          } \n        }\n      );\n    } finally {\n      setLoading((prev) => ({ ...prev, submit: false }));\n    }\n  };\n\n  // Render\n  return (\n    <div>\n      <Header userName={employeeName} onLogout={onLogout} />\n      <div className=\"container mx-auto p-4 sm:p-6 lg:p-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8\">\n          <main className=\"lg:col-span-3\">\n            {/* z-10 evita que el Popover tape el botón */}\n            <Card className=\"relative z-10\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-center\">\n                  {editingActivityId ? (\n                    <Pencil className=\"mr-2 h-5 w-5\" />\n                  ) : (\n                    <PlusCircle className=\"mr-2 h-5 w-5\" />\n                  )}\n                  {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\n                  <div className=\"w-full md:w-1/3\">\n                    <label\n                      htmlFor=\"date\"\n                      className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                    >\n                      Fecha\n                    </label>\n\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <Button\n                          variant=\"outline\"\n                          className={cn(\n                            'w-full justify-start text-left font-normal',\n                            !selectedDate && 'text-muted-foreground'\n                          )}\n                        >\n                          <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                          {selectedDate ? (\n                            <span>{format(selectedDate, 'PPP', { locale: es })}</span>\n                          ) : (\n                            <span>Seleccione una fecha</span>\n                          )}\n                        </Button>\n                      </PopoverTrigger>\n\n                      <PopoverContent className=\"w-auto p-0\">\n                        <Calendar\n                          mode=\"single\"\n                          selected={selectedDate}\n                          onSelect={handleDateChange}\n                          initialFocus\n                          locale={es}\n                        />\n                      </PopoverContent>\n                    </Popover>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <FormSelect\n                      label=\"Código de Proyecto\"\n                      name=\"project_code\"\n                      value={formData.project_code}\n                      onValueChange={handleSelectChange}\n                      options={projects.map((p) => ({\n                        value: p.code,\n                        label: p.code, // En el trigger solo se ve el código\n                        dropdownLabel: `${p.code} - ${p.name}`, // En la lista: código - nombre\n                      }))}\n                      placeholder=\"Seleccione un proyecto\"\n                      loading={loading.projects}\n                      disabled={loading.projects}\n                      icon={<Briefcase className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <div className=\"space-y-2\">\n                      <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                        Nombre del Proyecto\n                      </label>\n                      <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" />\n                    </div>\n\n                    <FormSelect\n                      label=\"Etapa\"\n                      name=\"phase\"\n                      value={formData.phase}\n                      onValueChange={handleSelectChange}\n                      options={stages.map((s) => ({ value: s, label: s }))}\n                      placeholder=\"Seleccione una etapa\"\n                      loading={loading.stages}\n                      disabled={!formData.project_code || loading.stages}\n                      icon={<ListChecks className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <FormSelect\n                      label=\"Disciplina\"\n                      name=\"discipline\"\n                      value={formData.discipline}\n                      onValueChange={handleSelectChange}\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\n                      placeholder=\"Seleccione una disciplina\"\n                      loading={loading.disciplines}\n                      disabled={!formData.phase || loading.disciplines}\n                      icon={<Pencil className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <FormSelect\n                      label=\"Actividad\"\n                      name=\"activity\"\n                      value={formData.activity}\n                      onValueChange={handleSelectChange}\n                      options={activities.map((a) => ({ value: a, label: a }))}\n                      placeholder=\"Seleccione una actividad\"\n                      loading={loading.activities}\n                      disabled={!formData.discipline || loading.activities}\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <div className=\"space-y-2\">\n                      <label\n                        htmlFor=\"hours\"\n                        className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                      >\n                        Horas <span className=\"text-destructive\">*</span>\n                      </label>\n                      <Input\n                        id=\"hours\"\n                        name=\"hours\"\n                        type=\"number\"\n                        value={formData.hours}\n                        onChange={handleChange}\n                        min=\"0.5\"\n                        step=\"0.5\"\n                        required\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label\n                      htmlFor=\"note\"\n                      className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                    >\n                      Nota (Opcional)\n                    </label>\n                    <textarea\n                      id=\"note\"\n                      name=\"note\"\n                      value={formData.note}\n                      onChange={handleChange}\n                      onKeyDown={handleNoteKeyDown}\n                      rows={3}\n                      className=\"flex h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n                      placeholder=\"Escriba una nota (opcional)\"\n                    />\n                  </div>\n\n                  <div className=\"flex justify-end items-center gap-3 pt-4\">\n                    {editingActivityId && (\n                      <Button type=\"button\" variant=\"outline\" onClick={resetForm}>\n                        <XCircle className=\"mr-2 h-4 w-4\" />\n                        Cancelar Edición\n                      </Button>\n                    )}\n\n                    <Button\n                      type=\"submit\"\n                      disabled={!isFormValid || loading.submit}\n                      className=\"min-w-[150px]\"\n                    >\n                      {loading.submit ? (\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Save className=\"mr-2 h-4 w-4\" />\n                      )}\n                      {editingActivityId ? 'Actualizar' : 'Guardar'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </main>\n\n          <aside className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-center\">Actividades del Día</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {loading.dailyActivities ? (\n                    <ActivityListSkeleton />\n                  ) : dailyActivities.length > 0 ? (\n                    dailyActivities.map((activity) => (\n                      <ActivityItem\n                        key={activity.id}\n                        activity={activity}\n                        onEdit={handleEditActivity}\n                        onDelete={handleDelete}\n                      />\n                    ))\n                  ) : (\n                    <EmptyState />\n                  )}\n                </div>\n                <div className=\"mt-6\">\n                  <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\n                </div>\n              </CardContent>\n            </Card>\n          </aside>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default FormularioHoras;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}