{"ast":null,"code":"var _jsxFileName = \"d:\\\\formulario de horas\\\\FormularioHoras Version 1\\\\frontend\\\\src\\\\components\\\\FormularioHoras.tsx\",\n  _s = $RefreshSig$();\n// FormularioHoras.tsx\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\nimport { toast, Toaster } from 'sonner';\nimport { Calendar as CalendarIcon, Briefcase, Save, Pencil, ListChecks, ClipboardList, XCircle, PlusCircle, Loader2, Folder, Star, Minus, Plus, Info, Undo2, Clock } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from './ui/tabs';\nimport { cn } from '../lib/utils';\nimport { Dialog, DialogContent, DialogTrigger } from './ui/dialog';\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\nimport TablaHoras from './TablaHoras';\nimport { submitHours, getProjects, getProjectStages, getDisciplinesByStage, getActivitiesByDiscipline, getDailyActivities, deleteHour, updateHour } from '../api/horasApi';\n\n// Props e interfaces\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialFormData = employeeId => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '0',\n  note: ''\n});\nconst DRAFT_KEY = 'fh_form_draft_v1';\n\n// Helper: ordenar A-Z / 0-9\nconst sortAZ = arr => [...arr].sort((a, b) => a.localeCompare(b, 'es', {\n  numeric: true,\n  sensitivity: 'base'\n}));\n\n// Comparator: primero letras, luego números\nconst projectComparator = (a, b) => {\n  var _a$code, _b$code;\n  const aCode = ((_a$code = a.code) !== null && _a$code !== void 0 ? _a$code : '').trim();\n  const bCode = ((_b$code = b.code) !== null && _b$code !== void 0 ? _b$code : '').trim();\n  const aStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(aCode);\n  const bStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(bCode);\n  if (aStartsWithLetter !== bStartsWithLetter) return aStartsWithLetter ? -1 : 1;\n  // dentro del mismo grupo, ordenar natural A-Z/0-9\n  return aCode.localeCompare(bCode, 'es', {\n    numeric: true,\n    sensitivity: 'base'\n  });\n};\nconst FormularioHoras = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout,\n  onShowPowerBI\n}) => {\n  _s();\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState([]);\n  const [projects, setProjects] = useState([]);\n  const [stages, setStages] = useState([]);\n  const [disciplines, setDisciplines] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [editingActivityId, setEditingActivityId] = useState(null);\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\n  const [favorites, setFavorites] = useState([]);\n  const [sortDir, setSortDir] = useState('asc');\n  const [isTableModalOpen, setIsTableModalOpen] = useState(false);\n  const [isDirty, setIsDirty] = useState(false);\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null\n  });\n  const hoursInputRef = useRef(null);\n  const undoTimerRef = useRef(null);\n  const favScrollRef = useRef(null);\n  const handleFavWheel = useCallback(e => {\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n      e.preventDefault();\n      e.stopPropagation();\n      e.currentTarget.scrollLeft += e.deltaY;\n    }\n  }, []);\n  const selectedProjectName = useMemo(() => {\n    var _projects$find;\n    return ((_projects$find = projects.find(p => p.code === formData.project_code)) === null || _projects$find === void 0 ? void 0 : _projects$find.name) || '';\n  }, [formData.project_code, projects]);\n  const hoursNumber = useMemo(() => {\n    var _formData$hours;\n    const raw = String((_formData$hours = formData.hours) !== null && _formData$hours !== void 0 ? _formData$hours : '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n  const totalHoursToday = useMemo(() => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0), [dailyActivities]);\n  const [errors, setErrors] = useState({});\n  useEffect(() => {\n    const newErrors = {};\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\n    setErrors(newErrors);\n  }, [formData, hoursNumber]);\n  useEffect(() => {\n    const raw = localStorage.getItem(DRAFT_KEY);\n    if (raw) {\n      try {\n        const draft = JSON.parse(raw);\n        setFormData(prev => ({\n          ...prev,\n          ...draft,\n          employee_id: String(employeeId)\n        }));\n      } catch {}\n    }\n  }, [employeeId]);\n  useEffect(() => {\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(formData));\n  }, [formData]);\n  useEffect(() => {\n    const raw = localStorage.getItem(FAV_KEY);\n    if (raw) try {\n      setFavorites(JSON.parse(raw));\n    } catch {}\n  }, [FAV_KEY]);\n  const saveFavorites = next => {\n    setFavorites(next);\n    localStorage.setItem(FAV_KEY, JSON.stringify(next));\n  };\n  const currentFavObj = useMemo(() => {\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\n    return {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity\n    };\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\n  const isCurrentFavorite = useMemo(() => {\n    if (!currentFavObj) return false;\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\n  }, [favorites, currentFavObj]);\n  const toggleFavorite = () => {\n    if (!currentFavObj) {\n      toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');\n      return;\n    }\n    if (isCurrentFavorite) {\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\n      saveFavorites(next);\n      toast.message('Eliminado de favoritos');\n    } else {\n      saveFavorites([...favorites, currentFavObj]);\n      toast.success('Guardado en favoritos');\n    }\n  };\n  const visibleActivities = useMemo(() => {\n    let list = [...dailyActivities];\n    list.sort((a, b) => (a.id || '').localeCompare(b.id || ''));\n    if (sortDir === 'desc') list.reverse();\n    return list;\n  }, [dailyActivities, sortDir]);\n  useEffect(() => {\n    const base = initialFormData(employeeId);\n    const changed = JSON.stringify({\n      ...formData,\n      employee_id: undefined\n    }) !== JSON.stringify({\n      ...base,\n      employee_id: undefined\n    });\n    setIsDirty(changed || Boolean(editingActivityId));\n  }, [formData, editingActivityId, employeeId]);\n  const refreshDailyActivities = useCallback(async (date, id) => {\n    setLoading(p => ({\n      ...p,\n      dailyActivities: true\n    }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (e) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(e);\n    } finally {\n      setLoading(p => ({\n        ...p,\n        dailyActivities: false\n      }));\n    }\n  }, []);\n  const fetchProjects = useCallback(async () => {\n    setLoading(p => ({\n      ...p,\n      projects: true\n    }));\n    try {\n      const data = await getProjects();\n      const sorted = [...data].sort(projectComparator); // letras primero, luego números\n      setProjects(sorted);\n    } catch (e) {\n      toast.error('Error al cargar proyectos.');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        projects: false\n      }));\n    }\n  }, []);\n  const fetchStages = useCallback(async projectCode => {\n    if (!projectCode) return [];\n    setLoading(p => ({\n      ...p,\n      stages: true\n    }));\n    try {\n      const data = await getProjectStages(projectCode);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setStages(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar etapas.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        stages: false\n      }));\n    }\n  }, []);\n  const fetchDisciplines = useCallback(async (projectCode, stage) => {\n    if (!projectCode || !stage) return [];\n    setLoading(p => ({\n      ...p,\n      disciplines: true\n    }));\n    try {\n      const data = await getDisciplinesByStage(projectCode, stage);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setDisciplines(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        disciplines: false\n      }));\n    }\n  }, []);\n  const fetchActivities = useCallback(async (projectCode, stage, discipline) => {\n    if (!projectCode || !stage || !discipline) return [];\n    setLoading(p => ({\n      ...p,\n      activities: true\n    }));\n    try {\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setActivities(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar actividades.');\n      setActivities([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        activities: false\n      }));\n    }\n  }, []);\n  const applyFavorite = useCallback(async fav => {\n    try {\n      setFormData(prev => ({\n        ...prev,\n        project_code: fav.project_code,\n        phase: '',\n        discipline: '',\n        activity: ''\n      }));\n      const st = await fetchStages(fav.project_code);\n      if (st && st.includes(fav.phase)) {\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\n        if (ds && ds.includes(fav.discipline)) {\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\n          if (ac && ac.includes(fav.activity)) {\n            setFormData({\n              employee_id: String(employeeId),\n              project_code: fav.project_code,\n              phase: fav.phase,\n              discipline: fav.discipline,\n              activity: fav.activity,\n              hours: '0',\n              note: ''\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo aplicar el favorito');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n  const handleDateChange = date => {\n    if (date) setSelectedDate(date);\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: v\n    }));\n  };\n  const handleNoteKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) e.preventDefault();\n  };\n  const handleSelectChange = async (name, value) => {\n    const updated = {\n      ...formData,\n      [name]: value\n    };\n    switch (name) {\n      case 'project_code':\n        updated.phase = '';\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n        if (value) await fetchStages(value);\n        break;\n      case 'phase':\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setDisciplines([]);\n        setActivities([]);\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\n        break;\n      case 'discipline':\n        updated.activity = '';\n        setFormData(updated);\n        setActivities([]);\n        if (value && updated.project_code && updated.phase) await fetchActivities(updated.project_code, updated.phase, value);\n        break;\n      default:\n        setFormData(updated);\n    }\n  };\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n  const handleEditActivity = useCallback(async activity => {\n    try {\n      var _activity$hours;\n      if (activity.date) {\n        try {\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\n          setSelectedDate(d);\n        } catch {}\n      }\n      if (activity.project_code) {\n        await fetchStages(activity.project_code);\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n      }\n      setFormData({\n        employee_id: String(employeeId),\n        project_code: activity.project_code || '',\n        phase: activity.phase || '',\n        discipline: activity.discipline || '',\n        activity: activity.activity || '',\n        hours: String((_activity$hours = activity.hours) !== null && _activity$hours !== void 0 ? _activity$hours : '0'),\n        note: activity.note || ''\n      });\n      setEditingActivityId(String(activity.id));\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    } catch (e) {\n      console.error(e);\n      toast.error('Error al cargar la actividad para edición');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n  const [undoData, setUndoData] = useState(null);\n  const triggerUndoBanner = activity => {\n    setUndoData(activity);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\n  };\n  const handleUndoDelete = async () => {\n    if (!undoData) return;\n    const a = undoData;\n    setUndoData(null);\n    try {\n      await submitHours({\n        project_code: a.project_code,\n        phase: a.phase,\n        discipline: a.discipline,\n        activity: a.activity,\n        hours: a.hours,\n        note: a.note || '',\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        employee_id: employeeId\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      toast.success('Registro restaurado');\n    } catch (e) {\n      toast.error('No se pudo restaurar');\n    }\n  };\n  const coreSubmit = async () => {\n    const submissionData = {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity,\n      hours: hoursNumber,\n      note: formData.note || '',\n      date: format(selectedDate, 'yyyy-MM-dd'),\n      employee_id: employeeId\n    };\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\n    setLoading(p => ({\n      ...p,\n      submit: true\n    }));\n    try {\n      if (editingActivityId) {\n        await updateHour(editingActivityId, submissionData);\n      } else {\n        await submitHours(submissionData);\n      }\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\n        id: toastId,\n        duration: 1800\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess();\n      return true;\n    } catch (e) {\n      console.error(e);\n      toast.error('Ocurrió un error al guardar.', {\n        id: toastId\n      });\n      return false;\n    } finally {\n      setLoading(p => ({\n        ...p,\n        submit: false\n      }));\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (Object.keys(errors).length) {\n      toast.error('Revisa los campos marcados');\n      return;\n    }\n    const ok = await coreSubmit();\n    if (ok) resetForm();\n  };\n  const handleDelete = async id => {\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\n    try {\n      setLoading(p => ({\n        ...p,\n        delete: id\n      }));\n      await deleteHour(id);\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      if (prev) triggerUndoBanner(prev);\n      toast.error('Actividad eliminada');\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo eliminar');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        delete: null\n      }));\n    }\n  };\n  const adjustHours = delta => {\n    const current = hoursNumber || 0;\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\n    setFormData(prev => ({\n      ...prev,\n      hours: String(next)\n    }));\n  };\n  useEffect(() => {\n    const onKey = e => {\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\n        e.preventDefault();\n        (async () => {\n          if (!loading.submit) {\n            const ok = await coreSubmit();\n            if (ok) resetForm();\n          }\n        })();\n      }\n      if (e.key === 'Escape') {\n        resetForm();\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [coreSubmit, loading.submit, resetForm]);\n\n  // Navegar a la vista de permisos\n  const handleNavigateToPermissions = () => {\n    // La lógica de navegación se maneja en App.tsx\n  };\n\n  // Navegar a la vista de horas\n  const handleNavigateToHours = () => {\n    // La lógica de navegación se maneja en App.tsx\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-[#f2f6fd] text-foreground\",\n    children: [/*#__PURE__*/_jsxDEV(Toaster, {\n      position: \"top-right\",\n      richColors: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      employeeName: employeeName,\n      onLogout: onLogout,\n      onShowPowerBI: onShowPowerBI,\n      onNavigateToHours: handleNavigateToHours,\n      onNavigateToPermissions: handleNavigateToPermissions,\n      currentView: \"hours\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\n\n        /* 👉 Fuerza saltos de línea en textos sin espacios y evita desbordes */\n        .text-wrap, .text-wrap *{\n          overflow-wrap: anywhere;\n          word-break: break-word;\n          hyphens: auto;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-auto container p-4 sm:p-6 lg:p-8\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        defaultValue: \"form\",\n        className: \"w-full\",\n        children: [/*#__PURE__*/_jsxDEV(TabsList, {\n          className: \"grid w-full grid-cols-2 mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(TabsTrigger, {\n            value: \"form\",\n            children: \"Formulario\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabsTrigger, {\n            value: \"table\",\n            children: \"Tabla de Horas\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabsContent, {\n          value: \"form\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\",\n            children: [/*#__PURE__*/_jsxDEV(\"main\", {\n              className: cn('lg:col-span-3'),\n              children: /*#__PURE__*/_jsxDEV(Card, {\n                className: \"relative z-10 flex flex-col text-wrap\",\n                children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n                  className: \"relative items-center text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center gap-2\",\n                    children: [editingActivityId ? /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-5 w-5\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 537,\n                      columnNumber: 40\n                    }, this) : /*#__PURE__*/_jsxDEV(PlusCircle, {\n                      className: \"h-5 w-5\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 537,\n                      columnNumber: 73\n                    }, this), /*#__PURE__*/_jsxDEV(CardTitle, {\n                      className: \"text-center\",\n                      children: editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 538,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 536,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute right-4 top-4 text-xs\",\n                    children: editingActivityId ? /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"px-2 py-1 rounded-full bg-amber-100 text-amber-800\",\n                      children: \"Editando\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 544,\n                      columnNumber: 21\n                    }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\",\n                      children: \"Creando\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 546,\n                      columnNumber: 21\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 542,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-2 text-sm text-muted-foreground\",\n                    children: \"Registra tus horas del d\\xEDa para el proyecto seleccionado.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 549,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                      children: [/*#__PURE__*/_jsxDEV(Briefcase, {\n                        className: \"h-3.5 w-3.5\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 555,\n                        columnNumber: 21\n                      }, this), \" \", formData.project_code || '—']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 554,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                      children: [/*#__PURE__*/_jsxDEV(ListChecks, {\n                        className: \"h-3.5 w-3.5\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 558,\n                        columnNumber: 21\n                      }, this), \" \", formData.phase || '—']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 557,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                      children: [/*#__PURE__*/_jsxDEV(Pencil, {\n                        className: \"h-3.5 w-3.5\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 561,\n                        columnNumber: 21\n                      }, this), \" \", formData.discipline || '—']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 560,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                      children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                        className: \"h-3.5 w-3.5\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 564,\n                        columnNumber: 21\n                      }, this), \" \", formData.activity || '—']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 563,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 553,\n                    columnNumber: 17\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 535,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mb-4 w-full sm:max-w-xs\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"inline-flex items-center gap-1\",\n                        children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 574,\n                          columnNumber: 23\n                        }, this), \" Fecha\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 573,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 572,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(Popover, {\n                      children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n                        asChild: true,\n                        children: /*#__PURE__*/_jsxDEV(Button, {\n                          variant: \"outline\",\n                          className: cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground'),\n                          children: /*#__PURE__*/_jsxDEV(\"span\", {\n                            children: format(selectedDate, 'PPP', {\n                              locale: es\n                            })\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 580,\n                            columnNumber: 25\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 579,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 578,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n                        className: \"w-auto p-0\",\n                        align: \"start\",\n                        children: /*#__PURE__*/_jsxDEV(Calendar, {\n                          mode: \"single\",\n                          selected: selectedDate,\n                          onSelect: handleDateChange,\n                          initialFocus: true,\n                          locale: es\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 584,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 583,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 577,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 571,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                        label: \"C\\xF3digo de Proyecto\",\n                        name: \"project_code\",\n                        value: formData.project_code,\n                        onValueChange: handleSelectChange,\n                        options: projects.map(p => ({\n                          value: p.code,\n                          label: p.code,\n                          dropdownLabel: `${p.code} - ${p.name}`\n                        })),\n                        placeholder: \"Seleccione un proyecto\",\n                        loading: loading.projects,\n                        disabled: loading.projects,\n                        icon: /*#__PURE__*/_jsxDEV(Briefcase, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 602,\n                          columnNumber: 29\n                        }, this),\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 593,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\",\n                        children: \"Elige el proyecto para cargar los demas campos.\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 605,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 592,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-2 text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"inline-flex items-center gap-1\",\n                          children: [/*#__PURE__*/_jsxDEV(Folder, {\n                            className: \"h-4 w-4\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 613,\n                            columnNumber: 72\n                          }, this), \" Nombre del Proyecto\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 613,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 612,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(Input, {\n                        value: selectedProjectName,\n                        readOnly: true,\n                        className: \"bg-muted/50\",\n                        \"aria-label\": \"Nombre de proyecto seleccionado\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 615,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 611,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                        label: \"Etapa\",\n                        name: \"phase\",\n                        value: formData.phase,\n                        onValueChange: handleSelectChange,\n                        options: stages.map(s => ({\n                          value: s,\n                          label: s\n                        })),\n                        placeholder: \"Seleccione una etapa\",\n                        loading: loading.stages,\n                        disabled: !formData.project_code || loading.stages,\n                        icon: /*#__PURE__*/_jsxDEV(ListChecks, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 629,\n                          columnNumber: 29\n                        }, this),\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 620,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"mt-1 text-xs text-muted-foreground\",\n                        children: \"Etapas disponibles para el proyecto elegido.\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 632,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 619,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                        label: \"Disciplina\",\n                        name: \"discipline\",\n                        value: formData.discipline,\n                        onValueChange: handleSelectChange,\n                        options: disciplines.map(d => ({\n                          value: d,\n                          label: d\n                        })),\n                        placeholder: \"Seleccione una disciplina\",\n                        loading: loading.disciplines,\n                        disabled: !formData.phase || loading.disciplines,\n                        icon: /*#__PURE__*/_jsxDEV(Pencil, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 646,\n                          columnNumber: 29\n                        }, this),\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 637,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"mt-1 text-xs text-muted-foreground\",\n                        children: \"Se filtran seg\\xFAn la etapa seleccionada.\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 649,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 636,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"w-full md:w-[320px] text-wrap\",\n                      children: /*#__PURE__*/_jsxDEV(FormSelect, {\n                        label: \"Actividad\",\n                        name: \"activity\",\n                        value: formData.activity,\n                        onValueChange: handleSelectChange,\n                        options: activities.map(a => ({\n                          value: a,\n                          label: a\n                        })),\n                        placeholder: \"Seleccione una actividad\",\n                        loading: loading.activities,\n                        disabled: !formData.discipline || loading.activities,\n                        icon: /*#__PURE__*/_jsxDEV(ClipboardList, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 663,\n                          columnNumber: 29\n                        }, this),\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 654,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 653,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex flex-col text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        htmlFor: \"hours\",\n                        className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"inline-flex items-center gap-1\",\n                          children: [/*#__PURE__*/_jsxDEV(Clock, {\n                            className: \"h-4 w-4\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 672,\n                            columnNumber: 25\n                          }, this), \" Horas \", /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-destructive\",\n                            children: \"*\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 672,\n                            columnNumber: 61\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 671,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 670,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-1\",\n                        children: [/*#__PURE__*/_jsxDEV(Button, {\n                          type: \"button\",\n                          variant: \"outline\",\n                          size: \"icon\",\n                          className: \"h-10 w-10 shrink-0\",\n                          onClick: () => adjustHours(-0.5),\n                          \"aria-label\": \"Restar 0.5h\",\n                          children: /*#__PURE__*/_jsxDEV(Minus, {\n                            className: \"h-4 w-4\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 686,\n                            columnNumber: 25\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 678,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(Button, {\n                          type: \"button\",\n                          variant: \"outline\",\n                          size: \"icon\",\n                          className: \"h-10 w-10 shrink-0\",\n                          onClick: () => adjustHours(0.5),\n                          \"aria-label\": \"Sumar 0.5h\",\n                          children: /*#__PURE__*/_jsxDEV(Plus, {\n                            className: \"h-4 w-4\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 698,\n                            columnNumber: 25\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 690,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(Input, {\n                          id: \"hours\",\n                          name: \"hours\",\n                          type: \"number\",\n                          value: formData.hours,\n                          onChange: handleChange,\n                          min: \"0\",\n                          step: \"0.5\",\n                          ref: hoursInputRef,\n                          className: \"h-10 w-[100px] shrink-0 rounded-md mr-0\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 702,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(Button, {\n                          type: \"button\",\n                          variant: isCurrentFavorite ? 'default' : 'outline',\n                          className: \"h-10 shrink-0\",\n                          onClick: toggleFavorite,\n                          title: isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito',\n                          children: [/*#__PURE__*/_jsxDEV(Star, {\n                            className: \"h-4 w-4 mr-2\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 722,\n                            columnNumber: 25\n                          }, this), \" Favorito\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 715,\n                          columnNumber: 23\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 676,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 669,\n                      columnNumber: 19\n                    }, this), favorites.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"md:col-span-2\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        ref: favScrollRef,\n                        onWheel: handleFavWheel,\n                        className: \"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\",\n                        style: {\n                          overscrollBehaviorX: 'contain',\n                          overscrollBehaviorY: 'none',\n                          touchAction: 'pan-x'\n                        },\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex gap-2\",\n                          children: favorites.map((fav, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n                            type: \"button\",\n                            onClick: () => applyFavorite(fav),\n                            className: \"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\",\n                            title: `${fav.project_code} • ${fav.phase} • ${fav.discipline}`,\n                            children: [/*#__PURE__*/_jsxDEV(Star, {\n                              className: \"h-3.5 w-3.5\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 745,\n                              columnNumber: 31\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"font-medium\",\n                              children: fav.activity\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 746,\n                              columnNumber: 31\n                            }, this)]\n                          }, idx, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 738,\n                            columnNumber: 29\n                          }, this))\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 736,\n                          columnNumber: 25\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 730,\n                        columnNumber: 23\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 729,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"md:col-span-2 w-full text-wrap\",\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        htmlFor: \"note\",\n                        className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"inline-flex items-center gap-1\",\n                          children: [/*#__PURE__*/_jsxDEV(Info, {\n                            className: \"h-4 w-4\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 758,\n                            columnNumber: 25\n                          }, this), \" Nota (Opcional)\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 757,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 756,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                        id: \"note\",\n                        name: \"note\",\n                        value: formData.note,\n                        onChange: handleChange,\n                        onKeyDown: handleNoteKeyDown,\n                        rows: 2,\n                        className: \"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\",\n                        placeholder: \"Descripci\\xF3n breve del trabajo realizado\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 761,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 755,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 590,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-6 flex items-center justify-end gap-3\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      type: \"submit\",\n                      onClick: e => {\n                        e.preventDefault();\n                        handleSubmit(e);\n                      },\n                      disabled: loading.submit || Object.keys(errors).length > 0,\n                      className: \"h-11\",\n                      children: [loading.submit ? /*#__PURE__*/_jsxDEV(Loader2, {\n                        className: \"mr-2 h-4 w-4 animate-spin\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 782,\n                        columnNumber: 39\n                      }, this) : /*#__PURE__*/_jsxDEV(Save, {\n                        className: \"mr-2 h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 782,\n                        columnNumber: 91\n                      }, this), editingActivityId ? 'Actualizar' : 'Guardar']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 776,\n                      columnNumber: 19\n                    }, this), editingActivityId && /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      onClick: resetForm,\n                      className: \"h-11\",\n                      children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                        className: \"mr-2 h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 788,\n                        columnNumber: 23\n                      }, this), \" Cancelar edici\\xF3n\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 787,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 775,\n                    columnNumber: 17\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 569,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 534,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n              className: \"lg:col-span-2\",\n              children: /*#__PURE__*/_jsxDEV(Card, {\n                className: \"h-full text-wrap\",\n                children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n                  className: \"relative\",\n                  children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n                    className: \"text-center flex items-center justify-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                      className: \"h-5 w-5\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 801,\n                      columnNumber: 19\n                    }, this), \"Actividades del D\\xEDa\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 800,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n                    open: isTableModalOpen,\n                    onOpenChange: setIsTableModalOpen,\n                    children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n                      asChild: true,\n                      children: /*#__PURE__*/_jsxDEV(Button, {\n                        type: \"button\",\n                        variant: \"outline\",\n                        size: \"icon\",\n                        title: \"Ver tabla de horas\",\n                        className: \"absolute right-4 top-4\",\n                        children: /*#__PURE__*/_jsxDEV(Clock, {\n                          className: \"h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 813,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 806,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 805,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n                      className: \"max-w-4xl max-h-[90vh] overflow-y-auto\",\n                      children: /*#__PURE__*/_jsxDEV(TablaHoras, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 817,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 816,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 804,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-2\",\n                      children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 823,\n                        columnNumber: 21\n                      }, this), \" \", format(selectedDate, 'PPP', {\n                        locale: es\n                      })]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 822,\n                      columnNumber: 19\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\",\n                      children: [\"Total registros: \", dailyActivities.length]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 825,\n                      columnNumber: 19\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 821,\n                    columnNumber: 17\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 799,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n                  children: loading.dailyActivities ? /*#__PURE__*/_jsxDEV(ActivityListSkeleton, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 833,\n                    columnNumber: 19\n                  }, this) : visibleActivities.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\",\n                      children: visibleActivities.map(activity => /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"text-wrap\",\n                        children: /*#__PURE__*/_jsxDEV(ActivityItem, {\n                          activity: activity,\n                          onEdit: handleEditActivity,\n                          onDelete: handleDelete\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 840,\n                          columnNumber: 27\n                        }, this)\n                      }, activity.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 839,\n                        columnNumber: 25\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 837,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"pt-3\",\n                      children: /*#__PURE__*/_jsxDEV(TotalHoursProgress, {\n                        totalHours: totalHoursToday,\n                        selectedDate: selectedDate\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 849,\n                        columnNumber: 23\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 848,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true) : /*#__PURE__*/_jsxDEV(EmptyState, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 853,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 831,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 798,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 797,\n              columnNumber: 11\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabsContent, {\n          value: \"table\",\n          children: /*#__PURE__*/_jsxDEV(TablaHoras, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 862,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 861,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 523,\n      columnNumber: 7\n    }, this), undoData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm\",\n        children: \"Registro eliminado.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 869,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        size: \"sm\",\n        variant: \"outline\",\n        onClick: handleUndoDelete,\n        children: [/*#__PURE__*/_jsxDEV(Undo2, {\n          className: \"h-4 w-4 mr-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 871,\n          columnNumber: 9\n        }, this), \" Deshacer\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 870,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 868,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 499,\n    columnNumber: 5\n  }, this);\n};\n_s(FormularioHoras, \"t6A8J/f6QUE5UtRQ6n7UwlFrihI=\");\n_c = FormularioHoras;\nexport default FormularioHoras;\nvar _c;\n$RefreshReg$(_c, \"FormularioHoras\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","format","parseISO","es","Header","toast","Toaster","Calendar","CalendarIcon","Briefcase","Save","Pencil","ListChecks","ClipboardList","XCircle","PlusCircle","Loader2","Folder","Star","Minus","Plus","Info","Undo2","Clock","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","Tabs","TabsList","TabsTrigger","TabsContent","cn","Dialog","DialogContent","DialogTrigger","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","TablaHoras","submitHours","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","getDailyActivities","deleteHour","updateHour","jsxDEV","_jsxDEV","Fragment","_Fragment","initialFormData","employeeId","employee_id","String","project_code","phase","discipline","activity","hours","note","DRAFT_KEY","sortAZ","arr","sort","a","b","localeCompare","numeric","sensitivity","projectComparator","_a$code","_b$code","aCode","code","trim","bCode","aStartsWithLetter","test","bStartsWithLetter","FormularioHoras","onSuccess","employeeName","onLogout","onShowPowerBI","_s","formData","setFormData","selectedDate","setSelectedDate","Date","dailyActivities","setDailyActivities","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","editingActivityId","setEditingActivityId","FAV_KEY","favorites","setFavorites","sortDir","setSortDir","isTableModalOpen","setIsTableModalOpen","isDirty","setIsDirty","loading","setLoading","submit","delete","hoursInputRef","undoTimerRef","favScrollRef","handleFavWheel","e","Math","abs","deltaY","deltaX","preventDefault","stopPropagation","currentTarget","scrollLeft","selectedProjectName","_projects$find","find","p","name","hoursNumber","_formData$hours","raw","replace","n","Number","isFinite","totalHoursToday","reduce","sum","errors","setErrors","newErrors","localStorage","getItem","draft","JSON","parse","prev","setItem","stringify","saveFavorites","next","currentFavObj","isCurrentFavorite","some","f","toggleFavorite","error","filter","message","success","visibleActivities","list","id","reverse","base","changed","undefined","Boolean","refreshDailyActivities","date","dateString","acts","console","fetchProjects","data","sorted","fetchStages","projectCode","cleaned","v","map","fetchDisciplines","stage","fetchActivities","applyFavorite","fav","st","includes","ds","ac","handleDateChange","handleChange","value","target","handleNoteKeyDown","key","shiftKey","handleSelectChange","updated","resetForm","handleEditActivity","_activity$hours","d","window","scrollTo","top","behavior","undoData","setUndoData","triggerUndoBanner","current","clearTimeout","setTimeout","handleUndoDelete","coreSubmit","submissionData","toastId","duration","handleSubmit","Object","keys","length","ok","handleDelete","adjustHours","delta","max","round","onKey","ctrlKey","metaKey","toLowerCase","addEventListener","removeEventListener","handleNavigateToPermissions","handleNavigateToHours","className","children","position","richColors","fileName","_jsxFileName","lineNumber","columnNumber","onNavigateToHours","onNavigateToPermissions","currentView","defaultValue","asChild","variant","locale","align","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","required","readOnly","s","htmlFor","type","size","onClick","onChange","min","step","ref","title","onWheel","style","overscrollBehaviorX","overscrollBehaviorY","touchAction","idx","onKeyDown","rows","open","onOpenChange","onEdit","onDelete","totalHours","_c","$RefreshReg$"],"sources":["d:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioHoras.tsx"],"sourcesContent":["// FormularioHoras.tsx\r\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport Header from './Header';\r\n\r\nimport { toast, Toaster } from 'sonner';\r\nimport {\r\n  Calendar as CalendarIcon,\r\n  Briefcase,\r\n  Save,\r\n  Pencil,\r\n  ListChecks,\r\n  ClipboardList,\r\n  XCircle,\r\n  PlusCircle,\r\n  Loader2,\r\n  Folder,\r\n  Star,\r\n  ArrowUpDown,\r\n  Minus,\r\n  Plus,\r\n  Info,\r\n  Undo2,\r\n  Clock,\r\n  BarChart2,\r\n} from 'lucide-react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Calendar } from './ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\r\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from './ui/tabs';\r\nimport { cn } from '../lib/utils';\r\nimport { Dialog, DialogContent, DialogTrigger } from './ui/dialog';\r\n\r\nimport { FormSelect } from './formulario/FormSelect';\r\nimport { ActivityItem } from './formulario/ActivityItem';\r\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\r\nimport { EmptyState } from './formulario/EmptyState';\r\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\r\nimport TablaHoras from './TablaHoras';\r\n\r\nimport {\r\n  submitHours,\r\n  getProjects,\r\n  getProjectStages,\r\n  getDisciplinesByStage,\r\n  getActivitiesByDiscipline,\r\n  getDailyActivities,\r\n  deleteHour,\r\n  updateHour,\r\n  type DailyActivity,\r\n} from '../api/horasApi';\r\n\r\n// Props e interfaces\r\ninterface FormularioHorasProps {\r\n  onSuccess: () => void;\r\n  employeeId: number;\r\n  employeeName: string;\r\n  onLogout: () => void;\r\n  onShowPowerBI: () => void;\r\n  onNavigateToHours: () => void;\r\n  onNavigateToPermissions: () => void;\r\n}\r\n\r\ninterface Project { code: string; name: string }\r\n\r\ntype Activity = DailyActivity;\r\n\r\nconst initialFormData = (employeeId: number) => ({\r\n  employee_id: String(employeeId),\r\n  project_code: '',\r\n  phase: '',\r\n  discipline: '',\r\n  activity: '',\r\n  hours: '0',\r\n  note: '',\r\n});\r\n\r\nconst DRAFT_KEY = 'fh_form_draft_v1';\r\n\r\n// Helper: ordenar A-Z / 0-9\r\nconst sortAZ = (arr: string[]) =>\r\n  [...arr].sort((a, b) => a.localeCompare(b, 'es', { numeric: true, sensitivity: 'base' }));\r\n\r\n// Comparator: primero letras, luego números\r\nconst projectComparator = (a: Project, b: Project) => {\r\n  const aCode = (a.code ?? '').trim();\r\n  const bCode = (b.code ?? '').trim();\r\n  const aStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(aCode);\r\n  const bStartsWithLetter = /^[A-Za-zÁÉÍÓÚÜÑ]/i.test(bCode);\r\n  if (aStartsWithLetter !== bStartsWithLetter) return aStartsWithLetter ? -1 : 1;\r\n  // dentro del mismo grupo, ordenar natural A-Z/0-9\r\n  return aCode.localeCompare(bCode, 'es', { numeric: true, sensitivity: 'base' });\r\n};\r\n\r\nconst FormularioHoras: React.FC<FormularioHorasProps> = ({ onSuccess, employeeId, employeeName, onLogout, onShowPowerBI }) => {\r\n  const [formData, setFormData] = useState(initialFormData(employeeId));\r\n  const [selectedDate, setSelectedDate] = useState(new Date());\r\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\r\n  const [projects, setProjects] = useState<Project[]>([]);\r\n  const [stages, setStages] = useState<string[]>([]);\r\n  const [disciplines, setDisciplines] = useState<string[]>([]);\r\n  const [activities, setActivities] = useState<string[]>([]);\r\n  const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\r\n\r\n  type Favorite = { project_code: string; phase: string; discipline: string; activity: string };\r\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\r\n  const [favorites, setFavorites] = useState<Favorite[]>([]);\r\n\r\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('asc');\r\n  const [isTableModalOpen, setIsTableModalOpen] = useState<boolean>(false);\r\n  const [isDirty, setIsDirty] = useState<boolean>(false);\r\n  const [loading, setLoading] = useState({\r\n    submit: false,\r\n    projects: true,\r\n    stages: false,\r\n    disciplines: false,\r\n    activities: false,\r\n    dailyActivities: true,\r\n    delete: null as string | null,\r\n  });\r\n\r\n  const hoursInputRef = useRef<HTMLInputElement | null>(null);\r\n  const undoTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const favScrollRef = useRef<HTMLDivElement | null>(null);\r\n  const handleFavWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\r\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.currentTarget.scrollLeft += e.deltaY;\r\n    }\r\n  }, []);\r\n\r\n  const selectedProjectName = useMemo(\r\n    () => projects.find(p => p.code === formData.project_code)?.name || '',\r\n    [formData.project_code, projects]\r\n  );\r\n  const hoursNumber = useMemo(() => {\r\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\r\n    const n = Number(raw);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }, [formData.hours]);\r\n  const totalHoursToday = useMemo(\r\n    () => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0),\r\n    [dailyActivities]\r\n  );\r\n\r\n  const [errors, setErrors] = useState<Partial<Record<keyof ReturnType<typeof initialFormData>, string>>>({});\r\n  useEffect(() => {\r\n    const newErrors: typeof errors = {};\r\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\r\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\r\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\r\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\r\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\r\n    setErrors(newErrors);\r\n  }, [formData, hoursNumber]);\r\n\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(DRAFT_KEY);\r\n    if (raw) { try {\r\n      const draft = JSON.parse(raw);\r\n      setFormData((prev) => ({ ...prev, ...draft, employee_id: String(employeeId) }));\r\n    } catch {} }\r\n  }, [employeeId]);\r\n  useEffect(() => { localStorage.setItem(DRAFT_KEY, JSON.stringify(formData)); }, [formData]);\r\n\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(FAV_KEY);\r\n    if (raw) try { setFavorites(JSON.parse(raw)); } catch {}\r\n  }, [FAV_KEY]);\r\n  const saveFavorites = (next: Favorite[]) => { setFavorites(next); localStorage.setItem(FAV_KEY, JSON.stringify(next)); };\r\n\r\n  const currentFavObj = useMemo(() => {\r\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\r\n    return { project_code: formData.project_code, phase: formData.phase, discipline: formData.discipline, activity: formData.activity } as Favorite;\r\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\r\n  const isCurrentFavorite = useMemo(() => {\r\n    if (!currentFavObj) return false;\r\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\r\n  }, [favorites, currentFavObj]);\r\n\r\n  const toggleFavorite = () => {\r\n    if (!currentFavObj) { toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos'); return; }\r\n    if (isCurrentFavorite) {\r\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\r\n      saveFavorites(next);\r\n      toast.message('Eliminado de favoritos');\r\n    } else {\r\n      saveFavorites([...favorites, currentFavObj]);\r\n      toast.success('Guardado en favoritos');\r\n    }\r\n  };\r\n\r\n  const visibleActivities = useMemo(() => {\r\n    let list = [...dailyActivities];\r\n    list.sort((a, b) => (a.id || '').localeCompare(b.id || ''));\r\n    if (sortDir === 'desc') list.reverse();\r\n    return list;\r\n  }, [dailyActivities, sortDir]);\r\n\r\n  useEffect(() => {\r\n    const base = initialFormData(employeeId);\r\n    const changed = JSON.stringify({ ...formData, employee_id: undefined }) !== JSON.stringify({ ...base, employee_id: undefined });\r\n    setIsDirty(changed || Boolean(editingActivityId));\r\n  }, [formData, editingActivityId, employeeId]);\r\n\r\n  const refreshDailyActivities = useCallback(async (date: Date, id: string) => {\r\n    setLoading((p) => ({ ...p, dailyActivities: true }));\r\n    try {\r\n      const dateString = format(date, 'yyyy-MM-dd');\r\n      const acts = await getDailyActivities(dateString, Number(id));\r\n      setDailyActivities(acts);\r\n    } catch (e) {\r\n      toast.error('Error al cargar las actividades del día.');\r\n      console.error(e);\r\n    } finally {\r\n      setLoading((p) => ({ ...p, dailyActivities: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchProjects = useCallback(async () => {\r\n    setLoading((p) => ({ ...p, projects: true }));\r\n    try {\r\n      const data = await getProjects();\r\n      const sorted = [...data].sort(projectComparator); // letras primero, luego números\r\n      setProjects(sorted);\r\n    } catch (e) {\r\n      toast.error('Error al cargar proyectos.');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, projects: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchStages = useCallback(async (projectCode: string) => {\r\n    if (!projectCode) return [] as string[];\r\n    setLoading((p) => ({ ...p, stages: true }));\r\n    try {\r\n      const data = await getProjectStages(projectCode);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setStages(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar etapas.');\r\n      setStages([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, stages: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\r\n    if (!projectCode || !stage) return [] as string[];\r\n    setLoading((p) => ({ ...p, disciplines: true }));\r\n    try {\r\n      const data = await getDisciplinesByStage(projectCode, stage);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setDisciplines(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar disciplinas.');\r\n      setDisciplines([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, disciplines: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchActivities = useCallback(async (projectCode: string, stage: string, discipline: string) => {\r\n    if (!projectCode || !stage || !discipline) return [] as string[];\r\n    setLoading((p) => ({ ...p, activities: true }));\r\n    try {\r\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\r\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setActivities(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar actividades.');\r\n      setActivities([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, activities: false }));\r\n    }\r\n  }, []);\r\n\r\n  const applyFavorite = useCallback(async (fav: Favorite) => {\r\n    try {\r\n      setFormData((prev) => ({ ...prev, project_code: fav.project_code, phase: '', discipline: '', activity: '' }));\r\n      const st = await fetchStages(fav.project_code);\r\n      if (st && st.includes(fav.phase)) {\r\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\r\n        if (ds && ds.includes(fav.discipline)) {\r\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\r\n          if (ac && ac.includes(fav.activity)) {\r\n            setFormData({\r\n              employee_id: String(employeeId),\r\n              project_code: fav.project_code,\r\n              phase: fav.phase,\r\n              discipline: fav.discipline,\r\n              activity: fav.activity,\r\n              hours: '0',\r\n              note: '',\r\n            });\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo aplicar el favorito');\r\n    }\r\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\r\n\r\n  useEffect(() => { fetchProjects(); }, [fetchProjects]);\r\n  useEffect(() => { refreshDailyActivities(selectedDate, String(employeeId)); }, [selectedDate, employeeId, refreshDailyActivities]);\r\n\r\n  const handleDateChange = (date?: Date) => { if (date) setSelectedDate(date); };\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    const v = name === 'hours' ? value.replace(',', '.') : value;\r\n    setFormData((prev) => ({ ...prev, [name]: v }));\r\n  };\r\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => { if (e.key === 'Enter' && !e.shiftKey) e.preventDefault(); };\r\n\r\n  const handleSelectChange = async (name: keyof ReturnType<typeof initialFormData>, value: string) => {\r\n    const updated = { ...formData, [name]: value } as ReturnType<typeof initialFormData>;\r\n    switch (name) {\r\n      case 'project_code':\r\n        updated.phase = ''; updated.discipline = ''; updated.activity = '';\r\n        setFormData(updated); setStages([]); setDisciplines([]); setActivities([]);\r\n        if (value) await fetchStages(value);\r\n        break;\r\n      case 'phase':\r\n        updated.discipline = ''; updated.activity = '';\r\n        setFormData(updated); setDisciplines([]); setActivities([]);\r\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\r\n        break;\r\n      case 'discipline':\r\n        updated.activity = '';\r\n        setFormData(updated); setActivities([]);\r\n        if (value && updated.project_code && updated.phase) await fetchActivities(updated.project_code, updated.phase, value);\r\n        break;\r\n      default:\r\n        setFormData(updated);\r\n    }\r\n  };\r\n\r\n  const resetForm = useCallback(() => {\r\n    setFormData(initialFormData(employeeId));\r\n    setEditingActivityId(null);\r\n  }, [employeeId]);\r\n\r\n  const handleEditActivity = useCallback(async (activity: Activity) => {\r\n    try {\r\n      if (activity.date) {\r\n        try {\r\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\r\n          setSelectedDate(d);\r\n        } catch {}\r\n      }\r\n      if (activity.project_code) {\r\n        await fetchStages(activity.project_code);\r\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\r\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\r\n      }\r\n      setFormData({\r\n        employee_id: String(employeeId),\r\n        project_code: activity.project_code || '',\r\n        phase: activity.phase || '',\r\n        discipline: activity.discipline || '',\r\n        activity: activity.activity || '',\r\n        hours: String(activity.hours ?? '0'),\r\n        note: activity.note || '',\r\n      });\r\n      setEditingActivityId(String(activity.id));\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Error al cargar la actividad para edición');\r\n    }\r\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\r\n\r\n  const [undoData, setUndoData] = useState<Activity | null>(null);\r\n  const triggerUndoBanner = (activity: Activity) => {\r\n    setUndoData(activity);\r\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\r\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\r\n  };\r\n  const handleUndoDelete = async () => {\r\n    if (!undoData) return;\r\n    const a = undoData; setUndoData(null);\r\n    try {\r\n      await submitHours({\r\n        project_code: a.project_code,\r\n        phase: a.phase,\r\n        discipline: a.discipline,\r\n        activity: a.activity,\r\n        hours: a.hours,\r\n        note: a.note || '',\r\n        date: format(selectedDate, 'yyyy-MM-dd'),\r\n        employee_id: employeeId,\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      toast.success('Registro restaurado');\r\n    } catch (e) {\r\n      toast.error('No se pudo restaurar');\r\n    }\r\n  };\r\n\r\n  const coreSubmit = async () => {\r\n    const submissionData = {\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n      hours: hoursNumber,\r\n      note: formData.note || '',\r\n      date: format(selectedDate, 'yyyy-MM-dd'),\r\n      employee_id: employeeId,\r\n    };\r\n\r\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\r\n    setLoading((p) => ({ ...p, submit: true }));\r\n\r\n    try {\r\n      if (editingActivityId) { await updateHour(editingActivityId, submissionData); }\r\n      else { await submitHours(submissionData); }\r\n\r\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, { id: toastId, duration: 1800 });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      onSuccess?.();\r\n      return true;\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Ocurrió un error al guardar.', { id: toastId });\r\n      return false;\r\n    } finally {\r\n      setLoading((p) => ({ ...p, submit: false }));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (Object.keys(errors).length) { toast.error('Revisa los campos marcados'); return; }\r\n    const ok = await coreSubmit();\r\n    if (ok) resetForm();\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\r\n    try {\r\n      setLoading(p => ({ ...p, delete: id }));\r\n      await deleteHour(id);\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      if (prev) triggerUndoBanner(prev);\r\n      toast.error('Actividad eliminada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo eliminar');\r\n    } finally {\r\n      setLoading(p => ({ ...p, delete: null }));\r\n    }\r\n  };\r\n\r\n  const adjustHours = (delta: number) => {\r\n    const current = hoursNumber || 0;\r\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\r\n    setFormData((prev) => ({ ...prev, hours: String(next) }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\r\n        e.preventDefault();\r\n        (async () => { if (!loading.submit) { const ok = await coreSubmit(); if (ok) resetForm(); } })();\r\n      }\r\n      if (e.key === 'Escape') { resetForm(); }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [coreSubmit, loading.submit, resetForm]);\r\n\r\n  // Navegar a la vista de permisos\r\n  const handleNavigateToPermissions = () => {\r\n    // La lógica de navegación se maneja en App.tsx\r\n  };\r\n\r\n  // Navegar a la vista de horas\r\n  const handleNavigateToHours = () => {\r\n    // La lógica de navegación se maneja en App.tsx\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#f2f6fd] text-foreground\">\r\n      <Toaster position=\"top-right\" richColors />\r\n      <Header\r\n        employeeName={employeeName}\r\n        onLogout={onLogout}\r\n        onShowPowerBI={onShowPowerBI}\r\n        onNavigateToHours={handleNavigateToHours}\r\n        onNavigateToPermissions={handleNavigateToPermissions}\r\n        currentView=\"hours\"\r\n      />\r\n\r\n      <style>{`\r\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\r\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\r\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\r\n\r\n        /* 👉 Fuerza saltos de línea en textos sin espacios y evita desbordes */\r\n        .text-wrap, .text-wrap *{\r\n          overflow-wrap: anywhere;\r\n          word-break: break-word;\r\n          hyphens: auto;\r\n        }\r\n      `}</style>\r\n\r\n      <div className=\"mx-auto container p-4 sm:p-6 lg:p-8\">\r\n        <Tabs defaultValue=\"form\" className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-2 mb-6\">\r\n            <TabsTrigger value=\"form\">Formulario</TabsTrigger>\r\n            <TabsTrigger value=\"table\">Tabla de Horas</TabsTrigger>\r\n          </TabsList>\r\n          \r\n          <TabsContent value=\"form\">\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\">\r\n              {/* PRINCIPAL */}\r\n              <main className={cn('lg:col-span-3')}>\r\n                <Card className=\"relative z-10 flex flex-col text-wrap\">\r\n                  <CardHeader className=\"relative items-center text-center\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  {editingActivityId ? <Pencil className=\"h-5 w-5\" /> : <PlusCircle className=\"h-5 w-5\" />}\r\n                  <CardTitle className=\"text-center\">\r\n                    {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\r\n                  </CardTitle>\r\n                </div>\r\n                <div className=\"absolute right-4 top-4 text-xs\">\r\n                  {editingActivityId ? (\r\n                    <span className=\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\">Editando</span>\r\n                  ) : (\r\n                    <span className=\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\">Creando</span>\r\n                  )}\r\n                </div>\r\n                <p className=\"mt-2 text-sm text-muted-foreground\">\r\n                  Registra tus horas del día para el proyecto seleccionado.\r\n                </p>\r\n\r\n                <div className=\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\">\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Briefcase className=\"h-3.5 w-3.5\" /> {formData.project_code || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ListChecks className=\"h-3.5 w-3.5\" /> {formData.phase || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Pencil className=\"h-3.5 w-3.5\" /> {formData.discipline || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ClipboardList className=\"h-3.5 w-3.5\" /> {formData.activity || '—'}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {/* Fecha */}\r\n                <div className=\"mb-4 w-full sm:max-w-xs\">\r\n                  <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                    <span className=\"inline-flex items-center gap-1\">\r\n                      <CalendarIcon className=\"h-4 w-4\" /> Fecha\r\n                    </span>\r\n                  </label>\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button variant=\"outline\" className={cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground')}>\r\n                        <span>{format(selectedDate, 'PPP', { locale: es })}</span>\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                      <Calendar mode=\"single\" selected={selectedDate} onSelect={handleDateChange} initialFocus locale={es} />\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                </div>\r\n\r\n                {/* GRID: columna izquierda más estrecha */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\">\r\n                  {/* Código de Proyecto (col izq) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Código de Proyecto\"\r\n                      name=\"project_code\"\r\n                      value={formData.project_code}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={projects.map((p) => ({ value: p.code, label: p.code, dropdownLabel: `${p.code} - ${p.name}` }))}\r\n                      placeholder=\"Seleccione un proyecto\"\r\n                      loading={loading.projects}\r\n                      disabled={loading.projects}\r\n                      icon={<Briefcase className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\">\r\n                      Elige el proyecto para cargar los demas campos.\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Nombre del Proyecto (col der) */}\r\n                  <div className=\"space-y-2 text-wrap\">\r\n                    <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\"><Folder className=\"h-4 w-4\" /> Nombre del Proyecto</span>\r\n                    </label>\r\n                    <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" aria-label=\"Nombre de proyecto seleccionado\" />\r\n                  </div>\r\n\r\n                  {/* Etapa (izq) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Etapa\"\r\n                      name=\"phase\"\r\n                      value={formData.phase}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={stages.map((s) => ({ value: s, label: s }))}\r\n                      placeholder=\"Seleccione una etapa\"\r\n                      loading={loading.stages}\r\n                      disabled={!formData.project_code || loading.stages}\r\n                      icon={<ListChecks className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Etapas disponibles para el proyecto elegido.</p>\r\n                  </div>\r\n\r\n                  {/* Disciplina (der) */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Disciplina\"\r\n                      name=\"discipline\"\r\n                      value={formData.discipline}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\r\n                      placeholder=\"Seleccione una disciplina\"\r\n                      loading={loading.disciplines}\r\n                      disabled={!formData.phase || loading.disciplines}\r\n                      icon={<Pencil className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Se filtran según la etapa seleccionada.</p>\r\n                  </div>\r\n\r\n                  {/* Actividad (izq) */}\r\n                  <div className=\"w-full md:w-[320px] text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Actividad\"\r\n                      name=\"activity\"\r\n                      value={formData.activity}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={activities.map((a) => ({ value: a, label: a }))}\r\n                      placeholder=\"Seleccione una actividad\"\r\n                      loading={loading.activities}\r\n                      disabled={!formData.discipline || loading.activities}\r\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Horas (der) – input a la izquierda, botones a la derecha */}\r\n                  <div className=\"flex flex-col text-wrap\">\r\n                    <label htmlFor=\"hours\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Clock className=\"h-4 w-4\" /> Horas <span className=\"text-destructive\">*</span>\r\n                      </span>\r\n                    </label>\r\n\r\n                    <div className=\"flex items-center gap-1\">\r\n                      {/* Botón Restar */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(-0.5)}\r\n                        aria-label=\"Restar 0.5h\"\r\n                      >\r\n                        <Minus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      {/* Botón Sumar */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(0.5)}\r\n                        aria-label=\"Sumar 0.5h\"\r\n                      >\r\n                        <Plus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      {/* Input de horas */}\r\n                      <Input\r\n                        id=\"hours\"\r\n                        name=\"hours\"\r\n                        type=\"number\"\r\n                        value={formData.hours}\r\n                        onChange={handleChange}\r\n                        min=\"0\"\r\n                        step=\"0.5\"\r\n                        ref={hoursInputRef}\r\n                        className=\"h-10 w-[100px] shrink-0 rounded-md mr-0\"\r\n                      />\r\n\r\n                      {/* Botón Favorito */}\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={isCurrentFavorite ? 'default' : 'outline'}\r\n                        className=\"h-10 shrink-0\"\r\n                        onClick={toggleFavorite}\r\n                        title={isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito'}\r\n                      >\r\n                        <Star className=\"h-4 w-4 mr-2\" /> Favorito\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Chips de favoritos (ocupa ambas columnas) */}\r\n                  {favorites.length > 0 && (\r\n                    <div className=\"md:col-span-2\">\r\n                      <div\r\n                        ref={favScrollRef}\r\n                        onWheel={handleFavWheel}\r\n                        className=\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\"\r\n                        style={{ overscrollBehaviorX: 'contain', overscrollBehaviorY: 'none', touchAction: 'pan-x' }}\r\n                      >\r\n                        <div className=\"flex gap-2\">\r\n                          {favorites.map((fav, idx) => (\r\n                            <button\r\n                              key={idx}\r\n                              type=\"button\"\r\n                              onClick={() => applyFavorite(fav)}\r\n                              className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\"\r\n                              title={`${fav.project_code} • ${fav.phase} • ${fav.discipline}`}\r\n                            >\r\n                              <Star className=\"h-3.5 w-3.5\" />\r\n                              <span className=\"font-medium\">{fav.activity}</span>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Nota (Opcional) – 2 líneas */}\r\n                  <div className=\"md:col-span-2 w-full text-wrap\">\r\n                    <label htmlFor=\"note\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Info className=\"h-4 w-4\" /> Nota (Opcional)\r\n                      </span>\r\n                    </label>\r\n                    <textarea\r\n                      id=\"note\"\r\n                      name=\"note\"\r\n                      value={formData.note}\r\n                      onChange={handleChange}\r\n                      onKeyDown={handleNoteKeyDown}\r\n                      rows={2}\r\n                      className=\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\"\r\n                      placeholder=\"Descripción breve del trabajo realizado\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Acciones */}\r\n                <div className=\"mt-6 flex items-center justify-end gap-3\">\r\n                  <Button\r\n                    type=\"submit\"\r\n                    onClick={(e) => { e.preventDefault(); handleSubmit(e as any); }}\r\n                    disabled={loading.submit || Object.keys(errors).length > 0}\r\n                    className=\"h-11\"\r\n                  >\r\n                    {loading.submit ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Save className=\"mr-2 h-4 w-4\" />}\r\n                    {editingActivityId ? 'Actualizar' : 'Guardar'}\r\n                  </Button>\r\n\r\n                  {editingActivityId && (\r\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"h-11\">\r\n                      <XCircle className=\"mr-2 h-4 w-4\" /> Cancelar edición\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </main>\r\n\r\n          {/* LATERAL */}\r\n          <aside className=\"lg:col-span-2\">\r\n            <Card className=\"h-full text-wrap\">\r\n              <CardHeader className=\"relative\">\r\n                <CardTitle className=\"text-center flex items-center justify-center gap-2\">\r\n                  <ClipboardList className=\"h-5 w-5\" />\r\n                  Actividades del Día\r\n                </CardTitle>\r\n                <Dialog open={isTableModalOpen} onOpenChange={setIsTableModalOpen}>\r\n                  <DialogTrigger asChild>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outline\"\r\n                      size=\"icon\"\r\n                      title=\"Ver tabla de horas\"\r\n                      className=\"absolute right-4 top-4\"\r\n                    >\r\n                      <Clock className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </DialogTrigger>\r\n                  <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n                    <TablaHoras />\r\n                  </DialogContent>\r\n                </Dialog>\r\n\r\n                <div className=\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\">\r\n                  <span className=\"inline-flex items-center gap-2\">\r\n                    <CalendarIcon className=\"h-4 w-4\" /> {format(selectedDate, 'PPP', { locale: es })}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\">\r\n                    Total registros: {dailyActivities.length}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {loading.dailyActivities ? (\r\n                  <ActivityListSkeleton />\r\n                ) : visibleActivities.length > 0 ? (\r\n                  <>\r\n                    {/* Lista sin overflow horizontal y con saltos de línea */}\r\n                    <div className=\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\">\r\n                      {visibleActivities.map((activity) => (\r\n                        <div key={activity.id} className=\"text-wrap\">\r\n                          <ActivityItem\r\n                            activity={activity}\r\n                            onEdit={handleEditActivity}\r\n                            onDelete={handleDelete}\r\n                          />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"pt-3\">\r\n                      <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <EmptyState />\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </aside>\r\n        </div>\r\n      </TabsContent>\r\n      \r\n      <TabsContent value=\"table\">\r\n        <TablaHoras />\r\n      </TabsContent>\r\n    </Tabs>\r\n  </div>\r\n\r\n  {undoData && (\r\n    <div className=\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\">\r\n      <span className=\"text-sm\">Registro eliminado.</span>\r\n      <Button size=\"sm\" variant=\"outline\" onClick={handleUndoDelete}>\r\n        <Undo2 className=\"h-4 w-4 mr-1\" /> Deshacer\r\n      </Button>\r\n    </div>\r\n  )}\r\n</div>\r\n);\r\n};\r\n\r\nexport default FormularioHoras;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}