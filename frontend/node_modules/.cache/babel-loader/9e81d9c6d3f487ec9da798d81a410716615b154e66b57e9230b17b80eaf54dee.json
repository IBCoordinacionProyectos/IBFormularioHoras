{"ast":null,"code":"var _jsxFileName = \"d:\\\\formulario de horas\\\\FormularioHoras Version 1\\\\frontend\\\\src\\\\components\\\\FormularioPermisos.tsx\",\n  _s = $RefreshSig$();\n// FormularioPermisos.tsx\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport { toast, Toaster } from 'sonner';\nimport { cn } from '../lib/utils';\nimport Header from './Header';\nimport { Calendar as CalendarIcon, Save, Pencil, XCircle, PlusCircle, Loader2, Clock, Folder, Minus, Plus, Star, Info, ArrowUpDown, Briefcase, ListChecks, ClipboardList } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\n\n// APIs correctas\nimport { getDailyActivities, submitHours, updateHour, deleteHour } from '../api/horasApi';\nimport { getProjects, getProjectStages, getDisciplinesByStage, getActivitiesByDiscipline, sortAZ } from '../api/permissionsApi';\n\n// ========================\n// Tipos & Props\n// ========================\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialFormData = employeeId => ({\n  employee_id: employeeId,\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '0',\n  note: ''\n});\n\n// Preferir letras antes que números; orden \"humano\" con soporte numérico\nconst projectComparator = (a, b) => {\n  const startsWithNum = s => /^\\d/.test(s);\n  const an = startsWithNum(a.code);\n  const bn = startsWithNum(b.code);\n  if (an && !bn) return 1;\n  if (!an && bn) return -1;\n  return a.code.localeCompare(b.code, undefined, {\n    numeric: true,\n    sensitivity: 'base'\n  });\n};\n\n// ========================\n// Componente\n// ========================\nconst FormularioPermisos = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout,\n  onNavigateToHours,\n  onShowPowerBI\n}) => {\n  _s();\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [projects, setProjects] = useState([]);\n  const [stages, setStages] = useState([]);\n  const [disciplines, setDisciplines] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [dailyActivities, setDailyActivities] = useState([]);\n  const [editingActivityId, setEditingActivityId] = useState(null);\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\n  const DRAFT_KEY = useMemo(() => `fh_draft_v1_${employeeId}`, [employeeId]);\n  const [favorites, setFavorites] = useState([]);\n  const [sortDir, setSortDir] = useState('asc');\n  const [isDirty, setIsDirty] = useState(false);\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null\n  });\n  const hoursInputRef = useRef(null);\n  const undoTimerRef = useRef(null);\n  const favScrollRef = useRef(null);\n  const handleFavWheel = useCallback(e => {\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n      e.preventDefault();\n      e.stopPropagation();\n      e.currentTarget.scrollLeft += e.deltaY;\n    }\n  }, []);\n  const selectedProjectName = useMemo(() => {\n    var _projects$find;\n    return ((_projects$find = projects.find(p => p.code === formData.project_code)) === null || _projects$find === void 0 ? void 0 : _projects$find.name) || '';\n  }, [formData.project_code, projects]);\n  const hoursNumber = useMemo(() => {\n    var _formData$hours;\n    const raw = String((_formData$hours = formData.hours) !== null && _formData$hours !== void 0 ? _formData$hours : '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n  const totalHoursToday = useMemo(() => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0), [dailyActivities]);\n  const [errors, setErrors] = useState({});\n\n  // Validación reactiva\n  useEffect(() => {\n    const newErrors = {};\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\n    setErrors(newErrors);\n  }, [formData, hoursNumber]);\n\n  // Borrador local\n  useEffect(() => {\n    const raw = localStorage.getItem(DRAFT_KEY);\n    if (raw) {\n      try {\n        const draft = JSON.parse(raw);\n        setFormData(prev => ({\n          ...prev,\n          ...draft,\n          employee_id: employeeId // asegurar número\n        }));\n      } catch {}\n    }\n  }, [DRAFT_KEY, employeeId]);\n  useEffect(() => {\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(formData));\n  }, [DRAFT_KEY, formData]);\n\n  // Favoritos\n  useEffect(() => {\n    const raw = localStorage.getItem(FAV_KEY);\n    if (raw) {\n      try {\n        setFavorites(JSON.parse(raw));\n      } catch {}\n    }\n  }, [FAV_KEY]);\n  const saveFavorites = next => {\n    setFavorites(next);\n    localStorage.setItem(FAV_KEY, JSON.stringify(next));\n  };\n  const currentFavObj = useMemo(() => {\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\n    return {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity\n    };\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\n  const isCurrentFavorite = useMemo(() => {\n    if (!currentFavObj) return false;\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\n  }, [favorites, currentFavObj]);\n  const toggleFavorite = () => {\n    if (!currentFavObj) {\n      toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');\n      return;\n    }\n    if (isCurrentFavorite) {\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\n      saveFavorites(next);\n      toast.message('Eliminado de favoritos');\n    } else {\n      saveFavorites([...favorites, currentFavObj]);\n      toast.success('Guardado en favoritos');\n    }\n  };\n  const visibleActivities = useMemo(() => {\n    const list = [...dailyActivities].sort((a, b) => {\n      var _a$id, _b$id;\n      return String((_a$id = a.id) !== null && _a$id !== void 0 ? _a$id : '').localeCompare(String((_b$id = b.id) !== null && _b$id !== void 0 ? _b$id : ''), undefined, {\n        numeric: true\n      });\n    });\n    return sortDir === 'desc' ? list.reverse() : list;\n  }, [dailyActivities, sortDir]);\n  useEffect(() => {\n    const base = initialFormData(employeeId);\n    const changed = JSON.stringify({\n      ...formData,\n      employee_id: undefined\n    }) !== JSON.stringify({\n      ...base,\n      employee_id: undefined\n    });\n    setIsDirty(changed || Boolean(editingActivityId));\n  }, [formData, editingActivityId, employeeId]);\n\n  // Data fetching\n  const refreshDailyActivities = useCallback(async (date, id) => {\n    setLoading(p => ({\n      ...p,\n      dailyActivities: true\n    }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (e) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(e);\n    } finally {\n      setLoading(p => ({\n        ...p,\n        dailyActivities: false\n      }));\n    }\n  }, []);\n  const fetchProjects = useCallback(async () => {\n    setLoading(p => ({\n      ...p,\n      projects: true\n    }));\n    try {\n      const data = await getProjects();\n      const sorted = [...data].sort(projectComparator);\n      setProjects(sorted);\n    } catch (e) {\n      toast.error('Error al cargar proyectos.');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        projects: false\n      }));\n    }\n  }, []);\n  const fetchStages = useCallback(async projectCode => {\n    if (!projectCode) return [];\n    setLoading(p => ({\n      ...p,\n      stages: true\n    }));\n    try {\n      const data = await getProjectStages(projectCode);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setStages(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar etapas.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        stages: false\n      }));\n    }\n  }, []);\n  const fetchDisciplines = useCallback(async (projectCode, stage) => {\n    if (!projectCode || !stage) return [];\n    setLoading(p => ({\n      ...p,\n      disciplines: true\n    }));\n    try {\n      const data = await getDisciplinesByStage(projectCode, stage);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setDisciplines(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        disciplines: false\n      }));\n    }\n  }, []);\n  const fetchActivities = useCallback(async (projectCode, stage, discipline) => {\n    if (!projectCode || !stage || !discipline) return [];\n    setLoading(p => ({\n      ...p,\n      activities: true\n    }));\n    try {\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\n      const cleaned = (data || []).filter(v => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setActivities(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar actividades.');\n      setActivities([]);\n      return [];\n    } finally {\n      setLoading(p => ({\n        ...p,\n        activities: false\n      }));\n    }\n  }, []);\n  const applyFavorite = useCallback(async fav => {\n    try {\n      setFormData(prev => ({\n        ...prev,\n        project_code: fav.project_code,\n        phase: '',\n        discipline: '',\n        activity: ''\n      }));\n      const st = await fetchStages(fav.project_code);\n      if (st && st.includes(fav.phase)) {\n        setFormData(prev => ({\n          ...prev,\n          phase: fav.phase\n        }));\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\n        if (ds && ds.includes(fav.discipline)) {\n          setFormData(prev => ({\n            ...prev,\n            discipline: fav.discipline\n          }));\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\n          if (ac && ac.includes(fav.activity)) {\n            setFormData(prev => ({\n              ...prev,\n              activity: fav.activity\n            }));\n          }\n        }\n      }\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo aplicar el favorito');\n    }\n  }, [fetchStages, fetchDisciplines, fetchActivities]);\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n\n  // Handlers\n  const handleDateChange = date => {\n    if (date) setSelectedDate(date);\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: v\n    }));\n  };\n  const handleNoteKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) e.preventDefault();\n  };\n  const handleSelectChange = async (name, value) => {\n    const updated = {\n      ...formData,\n      [name]: value\n    };\n    switch (name) {\n      case 'project_code':\n        updated.phase = '';\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n        if (value) await fetchStages(value);\n        break;\n      case 'phase':\n        updated.discipline = '';\n        updated.activity = '';\n        setFormData(updated);\n        setDisciplines([]);\n        setActivities([]);\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\n        break;\n      case 'discipline':\n        updated.activity = '';\n        setFormData(updated);\n        setActivities([]);\n        if (value && updated.project_code && updated.phase) {\n          await fetchActivities(updated.project_code, updated.phase, value);\n        }\n        break;\n      default:\n        setFormData(updated);\n    }\n  };\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n  const handleEditActivity = useCallback(async activity => {\n    try {\n      var _activity$hours;\n      if (activity.date) {\n        try {\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\n          setSelectedDate(d);\n        } catch {}\n      }\n      if (activity.project_code) {\n        await fetchStages(activity.project_code);\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n      }\n      setFormData({\n        employee_id: employeeId,\n        project_code: activity.project_code || '',\n        phase: activity.phase || '',\n        discipline: activity.discipline || '',\n        activity: activity.activity || '',\n        hours: String((_activity$hours = activity.hours) !== null && _activity$hours !== void 0 ? _activity$hours : '0'),\n        note: activity.note || ''\n      });\n      setEditingActivityId(String(activity.id));\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    } catch (e) {\n      console.error(e);\n      toast.error('Error al cargar la actividad para edición');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n  const [undoData, setUndoData] = useState(null);\n  const triggerUndoBanner = activity => {\n    setUndoData(activity);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\n  };\n  const handleUndoDelete = async () => {\n    if (!undoData) return;\n    const a = undoData;\n    setUndoData(null);\n    try {\n      // recrea el registro eliminado\n      await submitHours({\n        employee_id: employeeId,\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        project_code: a.project_code,\n        phase: a.phase,\n        discipline: a.discipline,\n        activity: a.activity,\n        hours: Number(a.hours) || 0,\n        note: a.note || ''\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      toast.success('Actividad restaurada');\n    } catch (e) {\n      console.error(e);\n      toast.error('Error al restaurar la actividad');\n    }\n  };\n  const doSubmit = useCallback(async () => {\n    if (Object.keys(errors).length > 0) {\n      toast.error('Por favor completa todos los campos requeridos');\n      return false;\n    }\n    const payload = {\n      employee_id: employeeId,\n      date: format(selectedDate, 'yyyy-MM-dd'),\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity,\n      hours: hoursNumber,\n      note: formData.note || '',\n      id: editingActivityId || undefined\n    };\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\n    setLoading(p => ({\n      ...p,\n      submit: true\n    }));\n    try {\n      if (editingActivityId) {\n        await updateHour(editingActivityId, payload);\n      } else {\n        await submitHours(payload);\n      }\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\n        id: toastId,\n        duration: 1800\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess();\n      return true;\n    } catch (e) {\n      console.error(e);\n      toast.error('Ocurrió un error al guardar.', {\n        id: toastId\n      });\n      return false;\n    } finally {\n      setLoading(p => ({\n        ...p,\n        submit: false\n      }));\n    }\n  }, [editingActivityId, employeeId, errors, formData.activity, formData.discipline, formData.phase, formData.project_code, formData.note, hoursNumber, selectedDate, refreshDailyActivities, onSuccess]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const ok = await doSubmit();\n    if (ok) resetForm();\n  };\n  const handleDelete = async id => {\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\n    try {\n      setLoading(p => ({\n        ...p,\n        delete: id\n      }));\n      await deleteHour(id);\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      if (prev) triggerUndoBanner(prev);\n      toast.error('Actividad eliminada');\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo eliminar');\n    } finally {\n      setLoading(p => ({\n        ...p,\n        delete: null\n      }));\n    }\n  };\n  const adjustHours = delta => {\n    const current = hoursNumber || 0;\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\n    setFormData(prev => ({\n      ...prev,\n      hours: String(next)\n    }));\n  };\n\n  // Atajos de teclado\n  useEffect(() => {\n    const onKey = e => {\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\n        e.preventDefault();\n        (async () => {\n          if (!loading.submit) {\n            const ok = await doSubmit();\n            if (ok) resetForm();\n          }\n        })();\n      }\n      if (e.key === 'Escape') {\n        resetForm();\n      }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [doSubmit, loading.submit, resetForm]);\n\n  // Navegación declarativa (se maneja fuera: App.tsx)\n  const handleNavigateToPermissions = () => {\n    /* noop: handled in router/App.tsx */\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-[#f2f6fd] text-foreground\",\n    children: [/*#__PURE__*/_jsxDEV(Toaster, {\n      position: \"top-right\",\n      richColors: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 625,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      employeeName: employeeName,\n      onLogout: onLogout,\n      onShowPowerBI: onShowPowerBI || (() => {}),\n      onNavigateToHours: onNavigateToHours,\n      onNavigateToPermissions: handleNavigateToPermissions,\n      currentView: \"hours\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\n        .text-wrap, .text-wrap *{\n          overflow-wrap: anywhere;\n          word-break: break-word;\n          hyphens: auto;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-auto container p-4 sm:p-6 lg:p-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\",\n        children: [/*#__PURE__*/_jsxDEV(\"main\", {\n          className: cn('lg:col-span-3'),\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"relative z-10 flex flex-col text-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              className: \"relative items-center text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center gap-2\",\n                children: [editingActivityId ? /*#__PURE__*/_jsxDEV(Pencil, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 653,\n                  columnNumber: 40\n                }, this) : /*#__PURE__*/_jsxDEV(PlusCircle, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 653,\n                  columnNumber: 73\n                }, this), /*#__PURE__*/_jsxDEV(CardTitle, {\n                  className: \"text-center\",\n                  children: editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 654,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 652,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute right-4 top-4 text-xs\",\n                children: editingActivityId ? /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-2 py-1 rounded-full bg-amber-100 text-amber-800\",\n                  children: \"Editando\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 660,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\",\n                  children: \"Creando\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 662,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 658,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mt-2 text-sm text-muted-foreground\",\n                children: \"Registra tus horas del d\\xEDa para el proyecto seleccionado.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 665,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(Briefcase, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 671,\n                    columnNumber: 21\n                  }, this), \" \", formData.project_code || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 670,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(ListChecks, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 674,\n                    columnNumber: 21\n                  }, this), \" \", formData.phase || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 673,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(Pencil, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 677,\n                    columnNumber: 21\n                  }, this), \" \", formData.discipline || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 676,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",\n                  children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                    className: \"h-3.5 w-3.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 680,\n                    columnNumber: 21\n                  }, this), \" \", formData.activity || '—']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 679,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 651,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 w-full sm:max-w-xs\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"inline-flex items-center gap-1\",\n                    children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 690,\n                      columnNumber: 23\n                    }, this), \" Fecha\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 689,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 688,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Popover, {\n                  children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n                    asChild: true,\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"outline\",\n                      className: cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground'),\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: format(selectedDate, 'PPP', {\n                          locale: es\n                        })\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 699,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 695,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 694,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n                    className: \"w-auto p-0\",\n                    align: \"start\",\n                    children: /*#__PURE__*/_jsxDEV(Calendar, {\n                      mode: \"single\",\n                      selected: selectedDate,\n                      onSelect: handleDateChange,\n                      initialFocus: true,\n                      locale: es\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 703,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 702,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 693,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 687,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"C\\xF3digo de Proyecto\",\n                    name: \"project_code\",\n                    value: formData.project_code,\n                    onValueChange: handleSelectChange,\n                    options: projects.map(p => ({\n                      value: p.code,\n                      label: p.code,\n                      dropdownLabel: `${p.code} - ${p.name}`\n                    })),\n                    placeholder: \"Seleccione un proyecto\",\n                    loading: loading.projects,\n                    disabled: loading.projects,\n                    icon: /*#__PURE__*/_jsxDEV(Briefcase, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 725,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 712,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\",\n                    children: \"Elige el proyecto para cargar los demas campos.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 728,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 711,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2 text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Folder, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 737,\n                        columnNumber: 25\n                      }, this), \" Nombre del Proyecto\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 736,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 735,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Input, {\n                    value: selectedProjectName,\n                    readOnly: true,\n                    className: \"bg-muted/50\",\n                    \"aria-label\": \"Nombre de proyecto seleccionado\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 740,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 734,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Etapa\",\n                    name: \"phase\",\n                    value: formData.phase,\n                    onValueChange: handleSelectChange,\n                    options: stages.map(s => ({\n                      value: s,\n                      label: s\n                    })),\n                    placeholder: \"Seleccione una etapa\",\n                    loading: loading.stages,\n                    disabled: !formData.project_code || loading.stages,\n                    icon: /*#__PURE__*/_jsxDEV(ListChecks, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 754,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 745,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-xs text-muted-foreground\",\n                    children: \"Etapas disponibles para el proyecto elegido.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 757,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 744,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Disciplina\",\n                    name: \"discipline\",\n                    value: formData.discipline,\n                    onValueChange: handleSelectChange,\n                    options: disciplines.map(d => ({\n                      value: d,\n                      label: d\n                    })),\n                    placeholder: \"Seleccione una disciplina\",\n                    loading: loading.disciplines,\n                    disabled: !formData.phase || loading.disciplines,\n                    icon: /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 771,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 762,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mt-1 text-xs text-muted-foreground\",\n                    children: \"Se filtran seg\\xFAn la etapa seleccionada.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 774,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 761,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full md:w-[320px] text-wrap\",\n                  children: /*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Actividad\",\n                    name: \"activity\",\n                    value: formData.activity,\n                    onValueChange: handleSelectChange,\n                    options: activities.map(a => ({\n                      value: a,\n                      label: a\n                    })),\n                    placeholder: \"Seleccione una actividad\",\n                    loading: loading.activities,\n                    disabled: !formData.discipline || loading.activities,\n                    icon: /*#__PURE__*/_jsxDEV(ClipboardList, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 788,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 779,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 778,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-col text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"hours\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Clock, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 797,\n                        columnNumber: 25\n                      }, this), \" Horas \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-destructive\",\n                        children: \"*\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 797,\n                        columnNumber: 61\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 796,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 795,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-1\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      size: \"icon\",\n                      className: \"h-10 w-10 shrink-0\",\n                      onClick: () => adjustHours(-0.5),\n                      \"aria-label\": \"Restar 0.5h\",\n                      children: /*#__PURE__*/_jsxDEV(Minus, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 810,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 802,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      size: \"icon\",\n                      className: \"h-10 w-10 shrink-0\",\n                      onClick: () => adjustHours(0.5),\n                      \"aria-label\": \"Sumar 0.5h\",\n                      children: /*#__PURE__*/_jsxDEV(Plus, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 821,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 813,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      id: \"hours\",\n                      name: \"hours\",\n                      type: \"number\",\n                      value: formData.hours,\n                      onChange: handleChange,\n                      min: \"0\",\n                      step: \"0.5\",\n                      ref: hoursInputRef,\n                      className: \"h-10 w-[100px] shrink-0 rounded-md mr-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 824,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: isCurrentFavorite ? 'default' : 'outline',\n                      className: \"h-10 shrink-0\",\n                      onClick: toggleFavorite,\n                      title: isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito',\n                      children: [/*#__PURE__*/_jsxDEV(Star, {\n                        className: \"h-4 w-4 mr-2\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 843,\n                        columnNumber: 25\n                      }, this), \" Favorito\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 836,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 801,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 794,\n                  columnNumber: 19\n                }, this), favorites.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    ref: favScrollRef,\n                    onWheel: handleFavWheel,\n                    className: \"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\",\n                    style: {\n                      overscrollBehaviorX: 'contain',\n                      overscrollBehaviorY: 'none',\n                      touchAction: 'pan-x'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex gap-2\",\n                      children: favorites.map((fav, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n                        type: \"button\",\n                        onClick: () => applyFavorite(fav),\n                        className: \"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\",\n                        title: `${fav.project_code} • ${fav.phase} • ${fav.discipline}`,\n                        children: [/*#__PURE__*/_jsxDEV(Star, {\n                          className: \"h-3.5 w-3.5\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 866,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-medium\",\n                          children: fav.activity\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 867,\n                          columnNumber: 31\n                        }, this)]\n                      }, idx, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 859,\n                        columnNumber: 29\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 857,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 851,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 850,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2 w-full text-wrap\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"note\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"inline-flex items-center gap-1\",\n                      children: [/*#__PURE__*/_jsxDEV(Info, {\n                        className: \"h-4 w-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 879,\n                        columnNumber: 25\n                      }, this), \" Nota (Opcional)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 878,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 877,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    id: \"note\",\n                    name: \"note\",\n                    value: formData.note,\n                    onChange: handleChange,\n                    onKeyDown: handleNoteKeyDown,\n                    rows: 2,\n                    className: \"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\",\n                    placeholder: \"Descripci\\xF3n breve del trabajo realizado\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 882,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 876,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 709,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-6 flex items-center justify-end gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  onClick: e => {\n                    e.preventDefault();\n                    handleSubmit(e);\n                  },\n                  disabled: loading.submit || Object.keys(errors).length > 0,\n                  className: \"h-11\",\n                  children: [loading.submit ? /*#__PURE__*/_jsxDEV(Loader2, {\n                    className: \"mr-2 h-4 w-4 animate-spin\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 907,\n                    columnNumber: 23\n                  }, this) : /*#__PURE__*/_jsxDEV(Save, {\n                    className: \"mr-2 h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 909,\n                    columnNumber: 23\n                  }, this), editingActivityId ? 'Actualizar' : 'Guardar']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 897,\n                  columnNumber: 19\n                }, this), editingActivityId && /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"button\",\n                  variant: \"outline\",\n                  onClick: resetForm,\n                  className: \"h-11\",\n                  children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                    className: \"mr-2 h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 916,\n                    columnNumber: 23\n                  }, this), \" Cancelar edici\\xF3n\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 915,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 896,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 685,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"lg:col-span-2\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"h-full text-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n                className: \"text-center flex items-center justify-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(ClipboardList, {\n                  className: \"h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 929,\n                  columnNumber: 19\n                }, this), \"Actividades del D\\xEDa\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 928,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                variant: \"outline\",\n                size: \"icon\",\n                title: \"Ordenar\",\n                onClick: () => setSortDir(d => d === 'asc' ? 'desc' : 'asc'),\n                className: \"absolute right-4 top-4\",\n                children: /*#__PURE__*/_jsxDEV(ArrowUpDown, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 940,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 932,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                    className: \"h-4 w-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 945,\n                    columnNumber: 21\n                  }, this), \" \", format(selectedDate, 'PPP', {\n                    locale: es\n                  })]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 944,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\",\n                  children: [\"Total registros: \", dailyActivities.length]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 947,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 943,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 927,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: loading.dailyActivities ? /*#__PURE__*/_jsxDEV(ActivityListSkeleton, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 955,\n                columnNumber: 19\n              }, this) : visibleActivities.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\",\n                  children: visibleActivities.map(activity => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-wrap\",\n                    children: /*#__PURE__*/_jsxDEV(ActivityItem, {\n                      activity: activity,\n                      onEdit: handleEditActivity,\n                      onDelete: handleDelete\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 961,\n                      columnNumber: 27\n                    }, this)\n                  }, String(activity.id), false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 960,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 958,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pt-3\",\n                  children: /*#__PURE__*/_jsxDEV(TotalHoursProgress, {\n                    totalHours: totalHoursToday,\n                    selectedDate: selectedDate\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 966,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 965,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(EmptyState, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 970,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 953,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 926,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 647,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 646,\n      columnNumber: 7\n    }, this), undoData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm\",\n        children: \"Registro eliminado.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 980,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        size: \"sm\",\n        variant: \"outline\",\n        onClick: handleUndoDelete,\n        children: \"Deshacer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 981,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 979,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 624,\n    columnNumber: 5\n  }, this);\n};\n_s(FormularioPermisos, \"aITG5gn0yCFK5WL7LvL6Dx72wys=\");\n_c = FormularioPermisos;\nexport default FormularioPermisos;\nvar _c;\n$RefreshReg$(_c, \"FormularioPermisos\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","format","parseISO","es","toast","Toaster","cn","Header","Calendar","CalendarIcon","Save","Pencil","XCircle","PlusCircle","Loader2","Clock","Folder","Minus","Plus","Star","Info","ArrowUpDown","Briefcase","ListChecks","ClipboardList","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","getDailyActivities","submitHours","updateHour","deleteHour","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","sortAZ","jsxDEV","_jsxDEV","Fragment","_Fragment","initialFormData","employeeId","employee_id","project_code","phase","discipline","activity","hours","note","projectComparator","a","b","startsWithNum","s","test","an","code","bn","localeCompare","undefined","numeric","sensitivity","FormularioPermisos","onSuccess","employeeName","onLogout","onNavigateToHours","onShowPowerBI","_s","formData","setFormData","selectedDate","setSelectedDate","Date","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","dailyActivities","setDailyActivities","editingActivityId","setEditingActivityId","FAV_KEY","DRAFT_KEY","favorites","setFavorites","sortDir","setSortDir","isDirty","setIsDirty","loading","setLoading","submit","delete","hoursInputRef","undoTimerRef","favScrollRef","handleFavWheel","e","Math","abs","deltaY","deltaX","preventDefault","stopPropagation","currentTarget","scrollLeft","selectedProjectName","_projects$find","find","p","name","hoursNumber","_formData$hours","raw","String","replace","trim","n","Number","isFinite","totalHoursToday","reduce","sum","errors","setErrors","newErrors","localStorage","getItem","draft","JSON","parse","prev","setItem","stringify","saveFavorites","next","currentFavObj","isCurrentFavorite","some","f","toggleFavorite","error","filter","message","success","visibleActivities","list","sort","_a$id","_b$id","id","reverse","base","changed","Boolean","refreshDailyActivities","date","dateString","acts","console","fetchProjects","data","sorted","fetchStages","projectCode","cleaned","v","map","fetchDisciplines","stage","fetchActivities","applyFavorite","fav","st","includes","ds","ac","handleDateChange","handleChange","value","target","handleNoteKeyDown","key","shiftKey","handleSelectChange","updated","resetForm","handleEditActivity","_activity$hours","d","window","scrollTo","top","behavior","undoData","setUndoData","triggerUndoBanner","current","clearTimeout","setTimeout","handleUndoDelete","doSubmit","Object","keys","length","payload","toastId","duration","handleSubmit","ok","handleDelete","adjustHours","delta","max","round","onKey","ctrlKey","metaKey","toLowerCase","addEventListener","removeEventListener","handleNavigateToPermissions","className","children","position","richColors","fileName","_jsxFileName","lineNumber","columnNumber","onNavigateToPermissions","currentView","asChild","variant","locale","align","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","required","readOnly","htmlFor","type","size","onClick","onChange","min","step","ref","title","onWheel","style","overscrollBehaviorX","overscrollBehaviorY","touchAction","idx","onKeyDown","rows","onEdit","onDelete","totalHours","_c","$RefreshReg$"],"sources":["d:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioPermisos.tsx"],"sourcesContent":["// FormularioPermisos.tsx\r\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { toast, Toaster } from 'sonner';\r\n\r\nimport { cn } from '../lib/utils';\r\nimport Header from './Header';\r\n\r\nimport {\r\n  Calendar as CalendarIcon,\r\n  Save,\r\n  Pencil,\r\n  XCircle,\r\n  PlusCircle,\r\n  Loader2,\r\n  Clock,\r\n  Folder,\r\n  Minus,\r\n  Plus,\r\n  Star,\r\n  Info,\r\n  ArrowUpDown,\r\n  Briefcase,\r\n  ListChecks,\r\n  ClipboardList,\r\n} from 'lucide-react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Calendar } from './ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\r\n\r\nimport { FormSelect } from './formulario/FormSelect';\r\nimport { ActivityItem } from './formulario/ActivityItem';\r\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\r\nimport { EmptyState } from './formulario/EmptyState';\r\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\r\n\r\n// APIs correctas\r\nimport {\r\n  DailyActivity,\r\n  getDailyActivities,\r\n  submitHours,\r\n  updateHour,\r\n  deleteHour,\r\n} from '../api/horasApi';\r\n\r\nimport {\r\n  Project,\r\n  getProjects,\r\n  getProjectStages,\r\n  getDisciplinesByStage,\r\n  getActivitiesByDiscipline,\r\n  sortAZ,\r\n} from '../api/permissionsApi';\r\n\r\n// ========================\r\n// Tipos & Props\r\n// ========================\r\ninterface FormularioPermisosProps {\r\n  onSuccess?: () => void;\r\n  employeeId: number;\r\n  employeeName: string;\r\n  onLogout: () => void;\r\n  onNavigateToHours: () => void;\r\n  onShowPowerBI?: () => void;\r\n}\r\n\r\ntype Activity = DailyActivity;\r\n\r\ntype PermissionFormData = {\r\n  employee_id: number;\r\n  project_code: string;\r\n  phase: string;\r\n  discipline: string;\r\n  activity: string;\r\n  hours: string; // UI-friendly; derivamos number aparte\r\n  note?: string;\r\n};\r\n\r\ntype Favorite = { project_code: string; phase: string; discipline: string; activity: string };\r\n\r\nconst initialFormData = (employeeId: number): PermissionFormData => ({\r\n  employee_id: employeeId,\r\n  project_code: '',\r\n  phase: '',\r\n  discipline: '',\r\n  activity: '',\r\n  hours: '0',\r\n  note: '',\r\n});\r\n\r\n// Preferir letras antes que números; orden \"humano\" con soporte numérico\r\nconst projectComparator = (a: Project, b: Project) => {\r\n  const startsWithNum = (s: string) => /^\\d/.test(s);\r\n  const an = startsWithNum(a.code);\r\n  const bn = startsWithNum(b.code);\r\n  if (an && !bn) return 1;\r\n  if (!an && bn) return -1;\r\n  return a.code.localeCompare(b.code, undefined, { numeric: true, sensitivity: 'base' });\r\n};\r\n\r\n// ========================\r\n// Componente\r\n// ========================\r\nconst FormularioPermisos: React.FC<FormularioPermisosProps> = ({\r\n  onSuccess,\r\n  employeeId,\r\n  employeeName,\r\n  onLogout,\r\n  onNavigateToHours,\r\n  onShowPowerBI,\r\n}) => {\r\n  const [formData, setFormData] = useState<PermissionFormData>(initialFormData(employeeId));\r\n  const [selectedDate, setSelectedDate] = useState<Date>(new Date());\r\n\r\n  const [projects, setProjects] = useState<Project[]>([]);\r\n  const [stages, setStages] = useState<string[]>([]);\r\n  const [disciplines, setDisciplines] = useState<string[]>([]);\r\n  const [activities, setActivities] = useState<string[]>([]);\r\n\r\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\r\n  const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\r\n\r\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\r\n  const DRAFT_KEY = useMemo(() => `fh_draft_v1_${employeeId}`, [employeeId]);\r\n\r\n  const [favorites, setFavorites] = useState<Favorite[]>([]);\r\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('asc');\r\n  const [isDirty, setIsDirty] = useState<boolean>(false);\r\n\r\n  const [loading, setLoading] = useState({\r\n    submit: false,\r\n    projects: true,\r\n    stages: false,\r\n    disciplines: false,\r\n    activities: false,\r\n    dailyActivities: true,\r\n    delete: null as string | null,\r\n  });\r\n\r\n  const hoursInputRef = useRef<HTMLInputElement | null>(null);\r\n  const undoTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const favScrollRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  const handleFavWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\r\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.currentTarget.scrollLeft += e.deltaY;\r\n    }\r\n  }, []);\r\n\r\n  const selectedProjectName = useMemo(\r\n    () => projects.find((p) => p.code === formData.project_code)?.name || '',\r\n    [formData.project_code, projects]\r\n  );\r\n\r\n  const hoursNumber = useMemo(() => {\r\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\r\n    const n = Number(raw);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }, [formData.hours]);\r\n\r\n  const totalHoursToday = useMemo(\r\n    () => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0),\r\n    [dailyActivities]\r\n  );\r\n\r\n  const [errors, setErrors] = useState<Partial<Record<keyof PermissionFormData, string>>>({});\r\n\r\n  // Validación reactiva\r\n  useEffect(() => {\r\n    const newErrors: Partial<Record<keyof PermissionFormData, string>> = {};\r\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\r\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\r\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\r\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\r\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas válidas (> 0)';\r\n    setErrors(newErrors);\r\n  }, [formData, hoursNumber]);\r\n\r\n  // Borrador local\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(DRAFT_KEY);\r\n    if (raw) {\r\n      try {\r\n        const draft = JSON.parse(raw);\r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          ...draft,\r\n          employee_id: employeeId, // asegurar número\r\n        }));\r\n      } catch {}\r\n    }\r\n  }, [DRAFT_KEY, employeeId]);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(formData));\r\n  }, [DRAFT_KEY, formData]);\r\n\r\n  // Favoritos\r\n  useEffect(() => {\r\n    const raw = localStorage.getItem(FAV_KEY);\r\n    if (raw) {\r\n      try {\r\n        setFavorites(JSON.parse(raw));\r\n      } catch {}\r\n    }\r\n  }, [FAV_KEY]);\r\n\r\n  const saveFavorites = (next: Favorite[]) => {\r\n    setFavorites(next);\r\n    localStorage.setItem(FAV_KEY, JSON.stringify(next));\r\n  };\r\n\r\n  const currentFavObj = useMemo(() => {\r\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\r\n    return {\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n    } as Favorite;\r\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\r\n\r\n  const isCurrentFavorite = useMemo(() => {\r\n    if (!currentFavObj) return false;\r\n    return favorites.some((f) => JSON.stringify(f) === JSON.stringify(currentFavObj));\r\n  }, [favorites, currentFavObj]);\r\n\r\n  const toggleFavorite = () => {\r\n    if (!currentFavObj) {\r\n      toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');\r\n      return;\r\n    }\r\n    if (isCurrentFavorite) {\r\n      const next = favorites.filter((f) => JSON.stringify(f) !== JSON.stringify(currentFavObj));\r\n      saveFavorites(next);\r\n      toast.message('Eliminado de favoritos');\r\n    } else {\r\n      saveFavorites([...favorites, currentFavObj]);\r\n      toast.success('Guardado en favoritos');\r\n    }\r\n  };\r\n\r\n  const visibleActivities = useMemo(() => {\r\n    const list = [...dailyActivities].sort((a, b) =>\r\n      String(a.id ?? '').localeCompare(String(b.id ?? ''), undefined, { numeric: true })\r\n    );\r\n    return sortDir === 'desc' ? list.reverse() : list;\r\n  }, [dailyActivities, sortDir]);\r\n\r\n  useEffect(() => {\r\n    const base = initialFormData(employeeId);\r\n    const changed =\r\n      JSON.stringify({ ...formData, employee_id: undefined }) !==\r\n      JSON.stringify({ ...base, employee_id: undefined });\r\n    setIsDirty(changed || Boolean(editingActivityId));\r\n  }, [formData, editingActivityId, employeeId]);\r\n\r\n  // Data fetching\r\n  const refreshDailyActivities = useCallback(\r\n    async (date: Date, id: string) => {\r\n      setLoading((p) => ({ ...p, dailyActivities: true }));\r\n      try {\r\n        const dateString = format(date, 'yyyy-MM-dd');\r\n        const acts = await getDailyActivities(dateString, Number(id));\r\n        setDailyActivities(acts);\r\n      } catch (e) {\r\n        toast.error('Error al cargar las actividades del día.');\r\n        console.error(e);\r\n      } finally {\r\n        setLoading((p) => ({ ...p, dailyActivities: false }));\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const fetchProjects = useCallback(async () => {\r\n    setLoading((p) => ({ ...p, projects: true }));\r\n    try {\r\n      const data = await getProjects();\r\n      const sorted = [...data].sort(projectComparator);\r\n      setProjects(sorted);\r\n    } catch (e) {\r\n      toast.error('Error al cargar proyectos.');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, projects: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchStages = useCallback(async (projectCode: string) => {\r\n    if (!projectCode) return [] as string[];\r\n    setLoading((p) => ({ ...p, stages: true }));\r\n    try {\r\n      const data = await getProjectStages(projectCode);\r\n      const cleaned = (data || [])\r\n        .filter((v: any) => v != null && String(v).trim() !== '')\r\n        .map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setStages(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar etapas.');\r\n      setStages([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, stages: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\r\n    if (!projectCode || !stage) return [] as string[];\r\n    setLoading((p) => ({ ...p, disciplines: true }));\r\n    try {\r\n      const data = await getDisciplinesByStage(projectCode, stage);\r\n      const cleaned = (data || [])\r\n        .filter((v: any) => v != null && String(v).trim() !== '')\r\n        .map(String);\r\n      const sorted = sortAZ(cleaned);\r\n      setDisciplines(sorted);\r\n      return sorted;\r\n    } catch (e) {\r\n      toast.error('Error al cargar disciplinas.');\r\n      setDisciplines([]);\r\n      return [];\r\n    } finally {\r\n      setLoading((p) => ({ ...p, disciplines: false }));\r\n    }\r\n  }, []);\r\n\r\n  const fetchActivities = useCallback(\r\n    async (projectCode: string, stage: string, discipline: string) => {\r\n      if (!projectCode || !stage || !discipline) return [] as string[];\r\n      setLoading((p) => ({ ...p, activities: true }));\r\n      try {\r\n        const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\r\n        const cleaned = (data || [])\r\n          .filter((v: any) => v != null && String(v).trim() !== '')\r\n          .map(String);\r\n        const sorted = sortAZ(cleaned);\r\n        setActivities(sorted);\r\n        return sorted;\r\n      } catch (e) {\r\n        toast.error('Error al cargar actividades.');\r\n        setActivities([]);\r\n        return [];\r\n      } finally {\r\n        setLoading((p) => ({ ...p, activities: false }));\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const applyFavorite = useCallback(\r\n    async (fav: Favorite) => {\r\n      try {\r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          project_code: fav.project_code,\r\n          phase: '',\r\n          discipline: '',\r\n          activity: '',\r\n        }));\r\n        const st = await fetchStages(fav.project_code);\r\n        if (st && st.includes(fav.phase)) {\r\n          setFormData((prev) => ({ ...prev, phase: fav.phase }));\r\n          const ds = await fetchDisciplines(fav.project_code, fav.phase);\r\n          if (ds && ds.includes(fav.discipline)) {\r\n            setFormData((prev) => ({ ...prev, discipline: fav.discipline }));\r\n            const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\r\n            if (ac && ac.includes(fav.activity)) {\r\n              setFormData((prev) => ({ ...prev, activity: fav.activity }));\r\n            }\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error(e);\r\n        toast.error('No se pudo aplicar el favorito');\r\n      }\r\n    },\r\n    [fetchStages, fetchDisciplines, fetchActivities]\r\n  );\r\n\r\n  useEffect(() => {\r\n    fetchProjects();\r\n  }, [fetchProjects]);\r\n\r\n  useEffect(() => {\r\n    refreshDailyActivities(selectedDate, String(employeeId));\r\n  }, [selectedDate, employeeId, refreshDailyActivities]);\r\n\r\n  // Handlers\r\n  const handleDateChange = (date?: Date) => {\r\n    if (date) setSelectedDate(date);\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    const v = name === 'hours' ? value.replace(',', '.') : value;\r\n    setFormData((prev) => ({ ...prev, [name]: v } as PermissionFormData));\r\n  };\r\n\r\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) e.preventDefault();\r\n  };\r\n\r\n  const handleSelectChange = async (name: keyof PermissionFormData, value: string) => {\r\n    const updated: PermissionFormData = { ...formData, [name]: value } as PermissionFormData;\r\n    switch (name) {\r\n      case 'project_code':\r\n        updated.phase = '';\r\n        updated.discipline = '';\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setStages([]);\r\n        setDisciplines([]);\r\n        setActivities([]);\r\n        if (value) await fetchStages(value);\r\n        break;\r\n      case 'phase':\r\n        updated.discipline = '';\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setDisciplines([]);\r\n        setActivities([]);\r\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\r\n        break;\r\n      case 'discipline':\r\n        updated.activity = '';\r\n        setFormData(updated);\r\n        setActivities([]);\r\n        if (value && updated.project_code && updated.phase) {\r\n          await fetchActivities(updated.project_code, updated.phase, value);\r\n        }\r\n        break;\r\n      default:\r\n        setFormData(updated);\r\n    }\r\n  };\r\n\r\n  const resetForm = useCallback(() => {\r\n    setFormData(initialFormData(employeeId));\r\n    setEditingActivityId(null);\r\n  }, [employeeId]);\r\n\r\n  const handleEditActivity = useCallback(\r\n    async (activity: Activity) => {\r\n      try {\r\n        if (activity.date) {\r\n          try {\r\n            const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\r\n            setSelectedDate(d);\r\n          } catch {}\r\n        }\r\n        if (activity.project_code) {\r\n          await fetchStages(activity.project_code);\r\n          if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\r\n          if (activity.phase && activity.discipline)\r\n            await fetchActivities(activity.project_code, activity.phase, activity.discipline);\r\n        }\r\n        setFormData({\r\n          employee_id: employeeId,\r\n          project_code: activity.project_code || '',\r\n          phase: activity.phase || '',\r\n          discipline: activity.discipline || '',\r\n          activity: activity.activity || '',\r\n          hours: String(activity.hours ?? '0'),\r\n          note: activity.note || '',\r\n        });\r\n        setEditingActivityId(String(activity.id));\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n      } catch (e) {\r\n        console.error(e);\r\n        toast.error('Error al cargar la actividad para edición');\r\n      }\r\n    },\r\n    [employeeId, fetchStages, fetchDisciplines, fetchActivities]\r\n  );\r\n\r\n  const [undoData, setUndoData] = useState<Activity | null>(null);\r\n  const triggerUndoBanner = (activity: Activity) => {\r\n    setUndoData(activity);\r\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\r\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\r\n  };\r\n\r\n  const handleUndoDelete = async () => {\r\n    if (!undoData) return;\r\n    const a = undoData;\r\n    setUndoData(null);\r\n    try {\r\n      // recrea el registro eliminado\r\n      await submitHours({\r\n        employee_id: employeeId,\r\n        date: format(selectedDate, 'yyyy-MM-dd'),\r\n        project_code: a.project_code,\r\n        phase: a.phase,\r\n        discipline: a.discipline,\r\n        activity: a.activity,\r\n        hours: Number(a.hours) || 0,\r\n        note: a.note || '',\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      toast.success('Actividad restaurada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Error al restaurar la actividad');\r\n    }\r\n  };\r\n\r\n  const doSubmit = useCallback(async (): Promise<boolean> => {\r\n    if (Object.keys(errors).length > 0) {\r\n      toast.error('Por favor completa todos los campos requeridos');\r\n      return false;\r\n    }\r\n\r\n    const payload = {\r\n      employee_id: employeeId,\r\n      date: format(selectedDate, 'yyyy-MM-dd'),\r\n      project_code: formData.project_code,\r\n      phase: formData.phase,\r\n      discipline: formData.discipline,\r\n      activity: formData.activity,\r\n      hours: hoursNumber,\r\n      note: formData.note || '',\r\n      id: editingActivityId || undefined,\r\n    };\r\n\r\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\r\n    setLoading((p) => ({ ...p, submit: true }));\r\n    try {\r\n      if (editingActivityId) {\r\n        await updateHour(editingActivityId, payload);\r\n      } else {\r\n        await submitHours(payload);\r\n      }\r\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\r\n        id: toastId,\r\n        duration: 1800,\r\n      });\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      onSuccess?.();\r\n      return true;\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('Ocurrió un error al guardar.', { id: toastId });\r\n      return false;\r\n    } finally {\r\n      setLoading((p) => ({ ...p, submit: false }));\r\n    }\r\n  }, [\r\n    editingActivityId,\r\n    employeeId,\r\n    errors,\r\n    formData.activity,\r\n    formData.discipline,\r\n    formData.phase,\r\n    formData.project_code,\r\n    formData.note,\r\n    hoursNumber,\r\n    selectedDate,\r\n    refreshDailyActivities,\r\n    onSuccess,\r\n  ]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    const ok = await doSubmit();\r\n    if (ok) resetForm();\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    const prev = dailyActivities.find((a) => String(a.id) === String(id));\r\n    try {\r\n      setLoading((p) => ({ ...p, delete: id }));\r\n      await deleteHour(id);\r\n      await refreshDailyActivities(selectedDate, String(employeeId));\r\n      if (prev) triggerUndoBanner(prev);\r\n      toast.error('Actividad eliminada');\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error('No se pudo eliminar');\r\n    } finally {\r\n      setLoading((p) => ({ ...p, delete: null }));\r\n    }\r\n  };\r\n\r\n  const adjustHours = (delta: number) => {\r\n    const current = hoursNumber || 0;\r\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\r\n    setFormData((prev) => ({ ...prev, hours: String(next) }));\r\n  };\r\n\r\n  // Atajos de teclado\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\r\n        e.preventDefault();\r\n        (async () => {\r\n          if (!loading.submit) {\r\n            const ok = await doSubmit();\r\n            if (ok) resetForm();\r\n          }\r\n        })();\r\n      }\r\n      if (e.key === 'Escape') {\r\n        resetForm();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [doSubmit, loading.submit, resetForm]);\r\n\r\n  // Navegación declarativa (se maneja fuera: App.tsx)\r\n  const handleNavigateToPermissions = () => {\r\n    /* noop: handled in router/App.tsx */\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#f2f6fd] text-foreground\">\r\n      <Toaster position=\"top-right\" richColors />\r\n      <Header\r\n        employeeName={employeeName}\r\n        onLogout={onLogout}\r\n        onShowPowerBI={onShowPowerBI || (() => {})}\r\n        onNavigateToHours={onNavigateToHours}\r\n        onNavigateToPermissions={handleNavigateToPermissions}\r\n        currentView=\"hours\"\r\n      />\r\n\r\n      <style>{`\r\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\r\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\r\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\r\n        .text-wrap, .text-wrap *{\r\n          overflow-wrap: anywhere;\r\n          word-break: break-word;\r\n          hyphens: auto;\r\n        }\r\n      `}</style>\r\n\r\n      <div className=\"mx-auto container p-4 sm:p-6 lg:p-8\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\">\r\n          {/* PRINCIPAL */}\r\n          <main className={cn('lg:col-span-3')}>\r\n            <Card className=\"relative z-10 flex flex-col text-wrap\">\r\n              <CardHeader className=\"relative items-center text-center\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  {editingActivityId ? <Pencil className=\"h-5 w-5\" /> : <PlusCircle className=\"h-5 w-5\" />}\r\n                  <CardTitle className=\"text-center\">\r\n                    {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\r\n                  </CardTitle>\r\n                </div>\r\n                <div className=\"absolute right-4 top-4 text-xs\">\r\n                  {editingActivityId ? (\r\n                    <span className=\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\">Editando</span>\r\n                  ) : (\r\n                    <span className=\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\">Creando</span>\r\n                  )}\r\n                </div>\r\n                <p className=\"mt-2 text-sm text-muted-foreground\">\r\n                  Registra tus horas del día para el proyecto seleccionado.\r\n                </p>\r\n\r\n                <div className=\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\">\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Briefcase className=\"h-3.5 w-3.5\" /> {formData.project_code || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ListChecks className=\"h-3.5 w-3.5\" /> {formData.phase || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <Pencil className=\"h-3.5 w-3.5\" /> {formData.discipline || '—'}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\r\n                    <ClipboardList className=\"h-3.5 w-3.5\" /> {formData.activity || '—'}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {/* Fecha */}\r\n                <div className=\"mb-4 w-full sm:max-w-xs\">\r\n                  <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                    <span className=\"inline-flex items-center gap-1\">\r\n                      <CalendarIcon className=\"h-4 w-4\" /> Fecha\r\n                    </span>\r\n                  </label>\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className={cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground')}\r\n                      >\r\n                        <span>{format(selectedDate, 'PPP', { locale: es })}</span>\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                      <Calendar mode=\"single\" selected={selectedDate} onSelect={handleDateChange} initialFocus locale={es} />\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                </div>\r\n\r\n                {/* GRID */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\">\r\n                  {/* Código de Proyecto */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Código de Proyecto\"\r\n                      name=\"project_code\"\r\n                      value={formData.project_code}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={projects.map((p) => ({\r\n                        value: p.code,\r\n                        label: p.code,\r\n                        dropdownLabel: `${p.code} - ${p.name}`,\r\n                      }))}\r\n                      placeholder=\"Seleccione un proyecto\"\r\n                      loading={loading.projects}\r\n                      disabled={loading.projects}\r\n                      icon={<Briefcase className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\">\r\n                      Elige el proyecto para cargar los demas campos.\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Nombre del Proyecto */}\r\n                  <div className=\"space-y-2 text-wrap\">\r\n                    <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Folder className=\"h-4 w-4\" /> Nombre del Proyecto\r\n                      </span>\r\n                    </label>\r\n                    <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" aria-label=\"Nombre de proyecto seleccionado\" />\r\n                  </div>\r\n\r\n                  {/* Etapa */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Etapa\"\r\n                      name=\"phase\"\r\n                      value={formData.phase}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={stages.map((s) => ({ value: s, label: s }))}\r\n                      placeholder=\"Seleccione una etapa\"\r\n                      loading={loading.stages}\r\n                      disabled={!formData.project_code || loading.stages}\r\n                      icon={<ListChecks className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Etapas disponibles para el proyecto elegido.</p>\r\n                  </div>\r\n\r\n                  {/* Disciplina */}\r\n                  <div className=\"text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Disciplina\"\r\n                      name=\"discipline\"\r\n                      value={formData.discipline}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\r\n                      placeholder=\"Seleccione una disciplina\"\r\n                      loading={loading.disciplines}\r\n                      disabled={!formData.phase || loading.disciplines}\r\n                      icon={<Pencil className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Se filtran según la etapa seleccionada.</p>\r\n                  </div>\r\n\r\n                  {/* Actividad */}\r\n                  <div className=\"w-full md:w-[320px] text-wrap\">\r\n                    <FormSelect\r\n                      label=\"Actividad\"\r\n                      name=\"activity\"\r\n                      value={formData.activity}\r\n                      onValueChange={handleSelectChange as any}\r\n                      options={activities.map((a) => ({ value: a, label: a }))}\r\n                      placeholder=\"Seleccione una actividad\"\r\n                      loading={loading.activities}\r\n                      disabled={!formData.discipline || loading.activities}\r\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\r\n                      required\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Horas */}\r\n                  <div className=\"flex flex-col text-wrap\">\r\n                    <label htmlFor=\"hours\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Clock className=\"h-4 w-4\" /> Horas <span className=\"text-destructive\">*</span>\r\n                      </span>\r\n                    </label>\r\n\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(-0.5)}\r\n                        aria-label=\"Restar 0.5h\"\r\n                      >\r\n                        <Minus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 shrink-0\"\r\n                        onClick={() => adjustHours(0.5)}\r\n                        aria-label=\"Sumar 0.5h\"\r\n                      >\r\n                        <Plus className=\"h-4 w-4\" />\r\n                      </Button>\r\n\r\n                      <Input\r\n                        id=\"hours\"\r\n                        name=\"hours\"\r\n                        type=\"number\"\r\n                        value={formData.hours}\r\n                        onChange={handleChange}\r\n                        min=\"0\"\r\n                        step=\"0.5\"\r\n                        ref={hoursInputRef}\r\n                        className=\"h-10 w-[100px] shrink-0 rounded-md mr-0\"\r\n                      />\r\n\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={isCurrentFavorite ? 'default' : 'outline'}\r\n                        className=\"h-10 shrink-0\"\r\n                        onClick={toggleFavorite}\r\n                        title={isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito'}\r\n                      >\r\n                        <Star className=\"h-4 w-4 mr-2\" /> Favorito\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Favoritos */}\r\n                  {favorites.length > 0 && (\r\n                    <div className=\"md:col-span-2\">\r\n                      <div\r\n                        ref={favScrollRef}\r\n                        onWheel={handleFavWheel}\r\n                        className=\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\"\r\n                        style={{ overscrollBehaviorX: 'contain', overscrollBehaviorY: 'none', touchAction: 'pan-x' }}\r\n                      >\r\n                        <div className=\"flex gap-2\">\r\n                          {favorites.map((fav, idx) => (\r\n                            <button\r\n                              key={idx}\r\n                              type=\"button\"\r\n                              onClick={() => applyFavorite(fav)}\r\n                              className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\"\r\n                              title={`${fav.project_code} • ${fav.phase} • ${fav.discipline}`}\r\n                            >\r\n                              <Star className=\"h-3.5 w-3.5\" />\r\n                              <span className=\"font-medium\">{fav.activity}</span>\r\n                            </button>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Nota */}\r\n                  <div className=\"md:col-span-2 w-full text-wrap\">\r\n                    <label htmlFor=\"note\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\r\n                      <span className=\"inline-flex items-center gap-1\">\r\n                        <Info className=\"h-4 w-4\" /> Nota (Opcional)\r\n                      </span>\r\n                    </label>\r\n                    <textarea\r\n                      id=\"note\"\r\n                      name=\"note\"\r\n                      value={formData.note}\r\n                      onChange={handleChange}\r\n                      onKeyDown={handleNoteKeyDown}\r\n                      rows={2}\r\n                      className=\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\"\r\n                      placeholder=\"Descripción breve del trabajo realizado\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Acciones */}\r\n                <div className=\"mt-6 flex items-center justify-end gap-3\">\r\n                  <Button\r\n                    type=\"submit\"\r\n                    onClick={(e) => {\r\n                      e.preventDefault();\r\n                      handleSubmit(e as any);\r\n                    }}\r\n                    disabled={loading.submit || Object.keys(errors).length > 0}\r\n                    className=\"h-11\"\r\n                  >\r\n                    {loading.submit ? (\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      <Save className=\"mr-2 h-4 w-4\" />\r\n                    )}\r\n                    {editingActivityId ? 'Actualizar' : 'Guardar'}\r\n                  </Button>\r\n\r\n                  {editingActivityId && (\r\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"h-11\">\r\n                      <XCircle className=\"mr-2 h-4 w-4\" /> Cancelar edición\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </main>\r\n\r\n          {/* LATERAL */}\r\n          <aside className=\"lg:col-span-2\">\r\n            <Card className=\"h-full text-wrap\">\r\n              <CardHeader className=\"relative\">\r\n                <CardTitle className=\"text-center flex items-center justify-center gap-2\">\r\n                  <ClipboardList className=\"h-5 w-5\" />\r\n                  Actividades del Día\r\n                </CardTitle>\r\n                <Button\r\n                  type=\"button\"\r\n                variant=\"outline\"\r\n                  size=\"icon\"\r\n                  title=\"Ordenar\"\r\n                  onClick={() => setSortDir((d) => (d === 'asc' ? 'desc' : 'asc'))}\r\n                  className=\"absolute right-4 top-4\"\r\n                >\r\n                  <ArrowUpDown className=\"h-4 w-4\" />\r\n                </Button>\r\n\r\n                <div className=\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\">\r\n                  <span className=\"inline-flex items-center gap-2\">\r\n                    <CalendarIcon className=\"h-4 w-4\" /> {format(selectedDate, 'PPP', { locale: es })}\r\n                  </span>\r\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\">\r\n                    Total registros: {dailyActivities.length}\r\n                  </span>\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent>\r\n                {loading.dailyActivities ? (\r\n                  <ActivityListSkeleton />\r\n                ) : visibleActivities.length > 0 ? (\r\n                  <>\r\n                    <div className=\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\">\r\n                      {visibleActivities.map((activity) => (\r\n                        <div key={String(activity.id)} className=\"text-wrap\">\r\n                          <ActivityItem activity={activity} onEdit={handleEditActivity} onDelete={handleDelete} />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"pt-3\">\r\n                      <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <EmptyState />\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </aside>\r\n        </div>\r\n      </div>\r\n\r\n      {undoData && (\r\n        <div className=\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\">\r\n          <span className=\"text-sm\">Registro eliminado.</span>\r\n          <Button size=\"sm\" variant=\"outline\" onClick={handleUndoDelete}>\r\n            Deshacer\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormularioPermisos;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}