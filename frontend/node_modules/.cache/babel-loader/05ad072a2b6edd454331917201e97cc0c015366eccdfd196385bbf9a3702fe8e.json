{"ast":null,"code":"import _objectSpread from\"C:/Users/YeisonDuqueDiaz/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// FormularioHoras.tsx\nimport React,{useState,useEffect,useCallback,useMemo,useRef}from'react';import{format,parseISO}from'date-fns';import{es}from'date-fns/locale';import Header from'./Header';import{toast}from'sonner';import{Calendar as CalendarIcon,Briefcase,Save,Pencil,ListChecks,ClipboardList,XCircle,PlusCircle,Loader2,Folder,Star,ArrowUpDown,Minus,Plus,Info,Undo2,Clock}from'lucide-react';import{Card,CardContent,CardHeader,CardTitle}from'./ui/card';import{Button}from'./ui/button';import{Input}from'./ui/input';import{Calendar}from'./ui/calendar';import{Popover,PopoverContent,PopoverTrigger}from'./ui/popover';import{cn}from'../lib/utils';import{FormSelect}from'./formulario/FormSelect';import{ActivityItem}from'./formulario/ActivityItem';import{ActivityListSkeleton}from'./formulario/ActivityListSkeleton';import{EmptyState}from'./formulario/EmptyState';import{TotalHoursProgress}from'./formulario/TotalHoursProgress';import{submitHours,getProjects,getProjectStages,getDisciplinesByStage,getActivitiesByDiscipline,getDailyActivities,deleteHour,updateHour}from'../api/horasApi';// Props e interfaces\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const initialFormData=employeeId=>({employee_id:String(employeeId),project_code:'',phase:'',discipline:'',activity:'',hours:'0',note:''});const DRAFT_KEY='fh_form_draft_v1';// Helper: ordenar A-Z / 0-9\nconst sortAZ=arr=>[...arr].sort((a,b)=>a.localeCompare(b,'es',{numeric:true,sensitivity:'base'}));// Comparator: primero letras, luego n√∫meros\nconst projectComparator=(a,b)=>{var _a$code,_b$code;const aCode=((_a$code=a.code)!==null&&_a$code!==void 0?_a$code:'').trim();const bCode=((_b$code=b.code)!==null&&_b$code!==void 0?_b$code:'').trim();const aStartsWithLetter=/^[A-Za-z√Å√â√ç√ì√ö√ú√ë]/i.test(aCode);const bStartsWithLetter=/^[A-Za-z√Å√â√ç√ì√ö√ú√ë]/i.test(bCode);if(aStartsWithLetter!==bStartsWithLetter)return aStartsWithLetter?-1:1;// dentro del mismo grupo, ordenar natural A-Z/0-9\nreturn aCode.localeCompare(bCode,'es',{numeric:true,sensitivity:'base'});};const FormularioHoras=_ref=>{let{onSuccess,employeeId,employeeName,onLogout}=_ref;const[formData,setFormData]=useState(initialFormData(employeeId));const[selectedDate,setSelectedDate]=useState(new Date());const[dailyActivities,setDailyActivities]=useState([]);const[projects,setProjects]=useState([]);const[stages,setStages]=useState([]);const[disciplines,setDisciplines]=useState([]);const[activities,setActivities]=useState([]);const[editingActivityId,setEditingActivityId]=useState(null);const FAV_KEY=useMemo(()=>\"fh_favorites_v1_\".concat(employeeId),[employeeId]);const[favorites,setFavorites]=useState([]);const[sortDir,setSortDir]=useState('asc');const[isDirty,setIsDirty]=useState(false);const[loading,setLoading]=useState({submit:false,projects:true,stages:false,disciplines:false,activities:false,dailyActivities:true,delete:null});const hoursInputRef=useRef(null);const undoTimerRef=useRef(null);const favScrollRef=useRef(null);const handleFavWheel=useCallback(e=>{if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){e.preventDefault();e.stopPropagation();e.currentTarget.scrollLeft+=e.deltaY;}},[]);const selectedProjectName=useMemo(()=>{var _projects$find;return((_projects$find=projects.find(p=>p.code===formData.project_code))===null||_projects$find===void 0?void 0:_projects$find.name)||'';},[formData.project_code,projects]);const hoursNumber=useMemo(()=>{var _formData$hours;const raw=String((_formData$hours=formData.hours)!==null&&_formData$hours!==void 0?_formData$hours:'').replace(',','.').trim();const n=Number(raw);return Number.isFinite(n)?n:0;},[formData.hours]);const totalHoursToday=useMemo(()=>dailyActivities.reduce((sum,a)=>sum+(Number(a.hours)||0),0),[dailyActivities]);const[errors,setErrors]=useState({});useEffect(()=>{const newErrors={};if(!formData.project_code)newErrors.project_code='Selecciona un proyecto';if(!formData.phase)newErrors.phase='Selecciona una etapa';if(!formData.discipline)newErrors.discipline='Selecciona una disciplina';if(!formData.activity)newErrors.activity='Selecciona una actividad';if(!(hoursNumber>0))newErrors.hours='Ingresa horas v√°lidas (> 0)';setErrors(newErrors);},[formData,hoursNumber]);useEffect(()=>{const raw=localStorage.getItem(DRAFT_KEY);if(raw){try{const draft=JSON.parse(raw);setFormData(prev=>_objectSpread(_objectSpread(_objectSpread({},prev),draft),{},{employee_id:String(employeeId)}));}catch(_unused){}}},[employeeId]);useEffect(()=>{localStorage.setItem(DRAFT_KEY,JSON.stringify(formData));},[formData]);useEffect(()=>{const raw=localStorage.getItem(FAV_KEY);if(raw)try{setFavorites(JSON.parse(raw));}catch(_unused2){}},[FAV_KEY]);const saveFavorites=next=>{setFavorites(next);localStorage.setItem(FAV_KEY,JSON.stringify(next));};const currentFavObj=useMemo(()=>{if(!formData.project_code||!formData.phase||!formData.discipline||!formData.activity)return null;return{project_code:formData.project_code,phase:formData.phase,discipline:formData.discipline,activity:formData.activity};},[formData.project_code,formData.phase,formData.discipline,formData.activity]);const isCurrentFavorite=useMemo(()=>{if(!currentFavObj)return false;return favorites.some(f=>JSON.stringify(f)===JSON.stringify(currentFavObj));},[favorites,currentFavObj]);const toggleFavorite=()=>{if(!currentFavObj){toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos');return;}if(isCurrentFavorite){const next=favorites.filter(f=>JSON.stringify(f)!==JSON.stringify(currentFavObj));saveFavorites(next);toast.message('Eliminado de favoritos');}else{saveFavorites([...favorites,currentFavObj]);toast.success('Guardado en favoritos');}};const visibleActivities=useMemo(()=>{let list=[...dailyActivities];list.sort((a,b)=>(a.id||'').localeCompare(b.id||''));if(sortDir==='desc')list.reverse();return list;},[dailyActivities,sortDir]);useEffect(()=>{const base=initialFormData(employeeId);const changed=JSON.stringify(_objectSpread(_objectSpread({},formData),{},{employee_id:undefined}))!==JSON.stringify(_objectSpread(_objectSpread({},base),{},{employee_id:undefined}));setIsDirty(changed||Boolean(editingActivityId));},[formData,editingActivityId,employeeId]);const refreshDailyActivities=useCallback(async(date,id)=>{setLoading(p=>_objectSpread(_objectSpread({},p),{},{dailyActivities:true}));try{const dateString=format(date,'yyyy-MM-dd');const acts=await getDailyActivities(dateString,Number(id));setDailyActivities(acts);}catch(e){toast.error('Error al cargar las actividades del d√≠a.');console.error(e);}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{dailyActivities:false}));}},[]);const fetchProjects=useCallback(async()=>{setLoading(p=>_objectSpread(_objectSpread({},p),{},{projects:true}));try{const data=await getProjects();const sorted=[...data].sort(projectComparator);// letras primero, luego n√∫meros\nsetProjects(sorted);}catch(e){toast.error('Error al cargar proyectos.');}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{projects:false}));}},[]);const fetchStages=useCallback(async projectCode=>{if(!projectCode)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{stages:true}));try{const data=await getProjectStages(projectCode);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setStages(sorted);return sorted;}catch(e){toast.error('Error al cargar etapas.');setStages([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{stages:false}));}},[]);const fetchDisciplines=useCallback(async(projectCode,stage)=>{if(!projectCode||!stage)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{disciplines:true}));try{const data=await getDisciplinesByStage(projectCode,stage);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setDisciplines(sorted);return sorted;}catch(e){toast.error('Error al cargar disciplinas.');setDisciplines([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{disciplines:false}));}},[]);const fetchActivities=useCallback(async(projectCode,stage,discipline)=>{if(!projectCode||!stage||!discipline)return[];setLoading(p=>_objectSpread(_objectSpread({},p),{},{activities:true}));try{const data=await getActivitiesByDiscipline(projectCode,stage,discipline);const cleaned=(data||[]).filter(v=>v!=null&&String(v).trim()!=='').map(String);const sorted=sortAZ(cleaned);setActivities(sorted);return sorted;}catch(e){toast.error('Error al cargar actividades.');setActivities([]);return[];}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{activities:false}));}},[]);const applyFavorite=useCallback(async fav=>{try{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{project_code:fav.project_code,phase:'',discipline:'',activity:''}));const st=await fetchStages(fav.project_code);if(st&&st.includes(fav.phase)){const ds=await fetchDisciplines(fav.project_code,fav.phase);if(ds&&ds.includes(fav.discipline)){const ac=await fetchActivities(fav.project_code,fav.phase,fav.discipline);if(ac&&ac.includes(fav.activity)){setFormData({employee_id:String(employeeId),project_code:fav.project_code,phase:fav.phase,discipline:fav.discipline,activity:fav.activity,hours:'0',note:''});}}}}catch(e){console.error(e);toast.error('No se pudo aplicar el favorito');}},[employeeId,fetchStages,fetchDisciplines,fetchActivities]);useEffect(()=>{fetchProjects();},[fetchProjects]);useEffect(()=>{refreshDailyActivities(selectedDate,String(employeeId));},[selectedDate,employeeId,refreshDailyActivities]);const handleDateChange=date=>{if(date)setSelectedDate(date);};const handleChange=e=>{const{name,value}=e.target;const v=name==='hours'?value.replace(',','.'):value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:v}));};const handleNoteKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey)e.preventDefault();};const handleSelectChange=async(name,value)=>{const updated=_objectSpread(_objectSpread({},formData),{},{[name]:value});switch(name){case'project_code':updated.phase='';updated.discipline='';updated.activity='';setFormData(updated);setStages([]);setDisciplines([]);setActivities([]);if(value)await fetchStages(value);break;case'phase':updated.discipline='';updated.activity='';setFormData(updated);setDisciplines([]);setActivities([]);if(value&&updated.project_code)await fetchDisciplines(updated.project_code,value);break;case'discipline':updated.activity='';setFormData(updated);setActivities([]);if(value&&updated.project_code&&updated.phase)await fetchActivities(updated.project_code,updated.phase,value);break;default:setFormData(updated);}};const resetForm=useCallback(()=>{setFormData(initialFormData(employeeId));setEditingActivityId(null);},[employeeId]);const handleEditActivity=useCallback(async activity=>{try{var _activity$hours;if(activity.date){try{const d=typeof activity.date==='string'?parseISO(activity.date):new Date(activity.date);setSelectedDate(d);}catch(_unused3){}}if(activity.project_code){await fetchStages(activity.project_code);if(activity.phase)await fetchDisciplines(activity.project_code,activity.phase);if(activity.phase&&activity.discipline)await fetchActivities(activity.project_code,activity.phase,activity.discipline);}setFormData({employee_id:String(employeeId),project_code:activity.project_code||'',phase:activity.phase||'',discipline:activity.discipline||'',activity:activity.activity||'',hours:String((_activity$hours=activity.hours)!==null&&_activity$hours!==void 0?_activity$hours:'0'),note:activity.note||''});setEditingActivityId(String(activity.id));window.scrollTo({top:0,behavior:'smooth'});}catch(e){console.error(e);toast.error('Error al cargar la actividad para edici√≥n');}},[employeeId,fetchStages,fetchDisciplines,fetchActivities]);const[undoData,setUndoData]=useState(null);const triggerUndoBanner=activity=>{setUndoData(activity);if(undoTimerRef.current)clearTimeout(undoTimerRef.current);undoTimerRef.current=setTimeout(()=>setUndoData(null),8000);};const handleUndoDelete=async()=>{if(!undoData)return;const a=undoData;setUndoData(null);try{await submitHours({project_code:a.project_code,phase:a.phase,discipline:a.discipline,activity:a.activity,hours:a.hours,note:a.note||'',date:format(selectedDate,'yyyy-MM-dd'),employee_id:employeeId});await refreshDailyActivities(selectedDate,String(employeeId));toast.success('Registro restaurado');}catch(e){toast.error('No se pudo restaurar');}};const coreSubmit=async()=>{const submissionData={project_code:formData.project_code,phase:formData.phase,discipline:formData.discipline,activity:formData.activity,hours:hoursNumber,note:formData.note||'',date:format(selectedDate,'yyyy-MM-dd'),employee_id:employeeId};const toastId=toast.loading(editingActivityId?'Actualizando actividad...':'Guardando actividad...');setLoading(p=>_objectSpread(_objectSpread({},p),{},{submit:true}));try{if(editingActivityId){await updateHour(editingActivityId,submissionData);}else{await submitHours(submissionData);}toast.success(\"Actividad \".concat(editingActivityId?'actualizada':'guardada',\" con \\xE9xito.\"),{id:toastId,duration:1800});await refreshDailyActivities(selectedDate,String(employeeId));onSuccess===null||onSuccess===void 0?void 0:onSuccess();return true;}catch(e){console.error(e);toast.error('Ocurri√≥ un error al guardar.',{id:toastId});return false;}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{submit:false}));}};const handleSubmit=async e=>{e.preventDefault();if(Object.keys(errors).length){toast.error('Revisa los campos marcados');return;}const ok=await coreSubmit();if(ok)resetForm();};const handleDelete=async id=>{const prev=dailyActivities.find(a=>String(a.id)===String(id));try{setLoading(p=>_objectSpread(_objectSpread({},p),{},{delete:id}));await deleteHour(id);await refreshDailyActivities(selectedDate,String(employeeId));if(prev)triggerUndoBanner(prev);toast.error('Actividad eliminada');}catch(e){console.error(e);toast.error('No se pudo eliminar');}finally{setLoading(p=>_objectSpread(_objectSpread({},p),{},{delete:null}));}};const adjustHours=delta=>{const current=hoursNumber||0;const next=Math.max(0,Math.round((current+delta)*2)/2);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{hours:String(next)}));};useEffect(()=>{const onKey=e=>{if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='enter'){e.preventDefault();(async()=>{if(!loading.submit){const ok=await coreSubmit();if(ok)resetForm();}})();}if(e.key==='Escape'){resetForm();}};window.addEventListener('keydown',onKey);return()=>window.removeEventListener('keydown',onKey);},[coreSubmit,loading.submit,resetForm]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-svh overflow-y-auto bg-[#f2f6fd]\",children:[/*#__PURE__*/_jsx(Header,{userName:employeeName,onLogout:onLogout}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\\n\\n        /* \\uD83D\\uDC49 Fuerza saltos de l\\xEDnea en textos sin espacios y evita desbordes */\\n        .text-wrap, .text-wrap *{\\n          overflow-wrap: anywhere;\\n          word-break: break-word;\\n          hyphens: auto;\\n        }\\n      \"}),/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto container p-4 sm:p-6 lg:p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\",children:[/*#__PURE__*/_jsx(\"main\",{className:cn('lg:col-span-3'),children:/*#__PURE__*/_jsxs(Card,{className:\"relative z-10 flex flex-col text-wrap\",children:[/*#__PURE__*/_jsxs(CardHeader,{className:\"relative items-center text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-2\",children:[editingActivityId?/*#__PURE__*/_jsx(Pencil,{className:\"h-5 w-5\"}):/*#__PURE__*/_jsx(PlusCircle,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(CardTitle,{className:\"text-center\",children:editingActivityId?'Editar Actividad':'Registrar Actividad'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-4 top-4 text-xs\",children:editingActivityId?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\",children:\"Editando\"}):/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\",children:\"Creando\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-muted-foreground\",children:\"Registra tus horas del d\\xEDa para el proyecto seleccionado.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(Briefcase,{className:\"h-3.5 w-3.5\"}),\" \",formData.project_code||'‚Äî']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(ListChecks,{className:\"h-3.5 w-3.5\"}),\" \",formData.phase||'‚Äî']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(Pencil,{className:\"h-3.5 w-3.5\"}),\" \",formData.discipline||'‚Äî']}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\",children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"h-3.5 w-3.5\"}),\" \",formData.activity||'‚Äî']})]})]}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 w-full sm:max-w-xs\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"h-4 w-4\"}),\" Fecha\"]})}),/*#__PURE__*/_jsxs(Popover,{children:[/*#__PURE__*/_jsx(PopoverTrigger,{asChild:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outline\",className:cn('w-full justify-start font-normal h-10',!selectedDate&&'text-muted-foreground'),children:/*#__PURE__*/_jsx(\"span\",{children:format(selectedDate,'PPP',{locale:es})})})}),/*#__PURE__*/_jsx(PopoverContent,{className:\"w-auto p-0\",align:\"start\",children:/*#__PURE__*/_jsx(Calendar,{mode:\"single\",selected:selectedDate,onSelect:handleDateChange,initialFocus:true,locale:es})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"C\\xF3digo de Proyecto\",name:\"project_code\",value:formData.project_code,onValueChange:handleSelectChange,options:projects.map(p=>({value:p.code,label:p.code,dropdownLabel:\"\".concat(p.code,\" - \").concat(p.name)})),placeholder:\"Seleccione un proyecto\",loading:loading.projects,disabled:loading.projects,icon:/*#__PURE__*/_jsx(Briefcase,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\",children:\"Elige el proyecto para cargar los demas campos.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Folder,{className:\"h-4 w-4\"}),\" Nombre del Proyecto\"]})}),/*#__PURE__*/_jsx(Input,{value:selectedProjectName,readOnly:true,className:\"bg-muted/50\",\"aria-label\":\"Nombre de proyecto seleccionado\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"Etapa\",name:\"phase\",value:formData.phase,onValueChange:handleSelectChange,options:stages.map(s=>({value:s,label:s})),placeholder:\"Seleccione una etapa\",loading:loading.stages,disabled:!formData.project_code||loading.stages,icon:/*#__PURE__*/_jsx(ListChecks,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-muted-foreground\",children:\"Etapas disponibles para el proyecto elegido.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-wrap\",children:[/*#__PURE__*/_jsx(FormSelect,{label:\"Disciplina\",name:\"discipline\",value:formData.discipline,onValueChange:handleSelectChange,options:disciplines.map(d=>({value:d,label:d})),placeholder:\"Seleccione una disciplina\",loading:loading.disciplines,disabled:!formData.phase||loading.disciplines,icon:/*#__PURE__*/_jsx(Pencil,{className:\"h-4 w-4\"}),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-muted-foreground\",children:\"Se filtran seg\\xFAn la etapa seleccionada.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full md:w-[320px] text-wrap\",children:/*#__PURE__*/_jsx(FormSelect,{label:\"Actividad\",name:\"activity\",value:formData.activity,onValueChange:handleSelectChange,options:activities.map(a=>({value:a,label:a})),placeholder:\"Seleccione una actividad\",loading:loading.activities,disabled:!formData.discipline||loading.activities,icon:/*#__PURE__*/_jsx(ClipboardList,{className:\"h-4 w-4\"}),required:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"hours\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Clock,{className:\"h-4 w-4\"}),\" Horas \",/*#__PURE__*/_jsx(\"span\",{className:\"text-destructive\",children:\"*\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",className:\"h-10 w-10 shrink-0\",onClick:()=>adjustHours(-0.5),\"aria-label\":\"Restar 0.5h\",children:/*#__PURE__*/_jsx(Minus,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",className:\"h-10 w-10 shrink-0\",onClick:()=>adjustHours(0.5),\"aria-label\":\"Sumar 0.5h\",children:/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Input,{id:\"hours\",name:\"hours\",type:\"number\",value:formData.hours,onChange:handleChange,min:\"0\",step:\"0.5\",ref:hoursInputRef,className:\"h-10 w-[100px] shrink-0 rounded-md mr-0\"}),/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:isCurrentFavorite?'default':'outline',className:\"h-10 shrink-0\",onClick:toggleFavorite,title:isCurrentFavorite?'Quitar de favoritos':'Guardar como favorito',children:[/*#__PURE__*/_jsx(Star,{className:\"h-4 w-4 mr-2\"}),\" Favorito\"]})]})]}),favorites.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(\"div\",{ref:favScrollRef,onWheel:handleFavWheel,className:\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\",style:{overscrollBehaviorX:'contain',overscrollBehaviorY:'none',touchAction:'pan-x'},children:/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:favorites.map((fav,idx)=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>applyFavorite(fav),className:\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\",title:\"\".concat(fav.project_code,\" \\u2022 \").concat(fav.phase,\" \\u2022 \").concat(fav.discipline),children:[/*#__PURE__*/_jsx(Star,{className:\"h-3.5 w-3.5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:fav.activity})]},idx))})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2 w-full text-wrap\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"note\",className:\"block text-sm font-medium text-foreground/80 mb-1\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-4 w-4\"}),\" Nota (Opcional)\"]})}),/*#__PURE__*/_jsx(\"textarea\",{id:\"note\",name:\"note\",value:formData.note,onChange:handleChange,onKeyDown:handleNoteKeyDown,rows:2,className:\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\",placeholder:\"Descripci\\xF3n breve del trabajo realizado\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex items-center justify-end gap-3\",children:[/*#__PURE__*/_jsxs(Button,{type:\"submit\",onClick:e=>{e.preventDefault();handleSubmit(e);},disabled:loading.submit||Object.keys(errors).length>0,className:\"h-11\",children:[loading.submit?/*#__PURE__*/_jsx(Loader2,{className:\"mr-2 h-4 w-4 animate-spin\"}):/*#__PURE__*/_jsx(Save,{className:\"mr-2 h-4 w-4\"}),editingActivityId?'Actualizar':'Guardar']}),editingActivityId&&/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:\"outline\",onClick:resetForm,className:\"h-11\",children:[/*#__PURE__*/_jsx(XCircle,{className:\"mr-2 h-4 w-4\"}),\" Cancelar edici\\xF3n\"]})]})]})]})}),/*#__PURE__*/_jsx(\"aside\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(Card,{className:\"h-full text-wrap\",children:[/*#__PURE__*/_jsxs(CardHeader,{className:\"relative\",children:[/*#__PURE__*/_jsxs(CardTitle,{className:\"text-center flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"h-5 w-5\"}),\"Actividades del D\\xEDa\"]}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",size:\"icon\",title:\"Ordenar\",onClick:()=>setSortDir(d=>d==='asc'?'desc':'asc'),className:\"absolute right-4 top-4\",children:/*#__PURE__*/_jsx(ArrowUpDown,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CalendarIcon,{className:\"h-4 w-4\"}),\" \",format(selectedDate,'PPP',{locale:es})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\",children:[\"Total registros: \",dailyActivities.length]})]})]}),/*#__PURE__*/_jsx(CardContent,{children:loading.dailyActivities?/*#__PURE__*/_jsx(ActivityListSkeleton,{}):visibleActivities.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\",children:visibleActivities.map(activity=>/*#__PURE__*/_jsx(\"div\",{className:\"text-wrap\",children:/*#__PURE__*/_jsx(ActivityItem,{activity:activity,onEdit:handleEditActivity,onDelete:handleDelete})},activity.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\",children:/*#__PURE__*/_jsx(TotalHoursProgress,{totalHours:totalHoursToday,selectedDate:selectedDate})})]}):/*#__PURE__*/_jsx(EmptyState,{})})]})})]})}),undoData&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Registro eliminado.\"}),/*#__PURE__*/_jsxs(Button,{size:\"sm\",variant:\"outline\",onClick:handleUndoDelete,children:[/*#__PURE__*/_jsx(Undo2,{className:\"h-4 w-4 mr-1\"}),\" Deshacer\"]})]})]});};export default FormularioHoras;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","format","parseISO","es","Header","toast","Calendar","CalendarIcon","Briefcase","Save","Pencil","ListChecks","ClipboardList","XCircle","PlusCircle","Loader2","Folder","Star","ArrowUpDown","Minus","Plus","Info","Undo2","Clock","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","cn","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","submitHours","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","getDailyActivities","deleteHour","updateHour","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","initialFormData","employeeId","employee_id","String","project_code","phase","discipline","activity","hours","note","DRAFT_KEY","sortAZ","arr","sort","a","b","localeCompare","numeric","sensitivity","projectComparator","_a$code","_b$code","aCode","code","trim","bCode","aStartsWithLetter","test","bStartsWithLetter","FormularioHoras","_ref","onSuccess","employeeName","onLogout","formData","setFormData","selectedDate","setSelectedDate","Date","dailyActivities","setDailyActivities","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","editingActivityId","setEditingActivityId","FAV_KEY","concat","favorites","setFavorites","sortDir","setSortDir","isDirty","setIsDirty","loading","setLoading","submit","delete","hoursInputRef","undoTimerRef","favScrollRef","handleFavWheel","e","Math","abs","deltaY","deltaX","preventDefault","stopPropagation","currentTarget","scrollLeft","selectedProjectName","_projects$find","find","p","name","hoursNumber","_formData$hours","raw","replace","n","Number","isFinite","totalHoursToday","reduce","sum","errors","setErrors","newErrors","localStorage","getItem","draft","JSON","parse","prev","_objectSpread","_unused","setItem","stringify","_unused2","saveFavorites","next","currentFavObj","isCurrentFavorite","some","f","toggleFavorite","error","filter","message","success","visibleActivities","list","id","reverse","base","changed","undefined","Boolean","refreshDailyActivities","date","dateString","acts","console","fetchProjects","data","sorted","fetchStages","projectCode","cleaned","v","map","fetchDisciplines","stage","fetchActivities","applyFavorite","fav","st","includes","ds","ac","handleDateChange","handleChange","value","target","handleNoteKeyDown","key","shiftKey","handleSelectChange","updated","resetForm","handleEditActivity","_activity$hours","d","_unused3","window","scrollTo","top","behavior","undoData","setUndoData","triggerUndoBanner","current","clearTimeout","setTimeout","handleUndoDelete","coreSubmit","submissionData","toastId","duration","handleSubmit","Object","keys","length","ok","handleDelete","adjustHours","delta","max","round","onKey","ctrlKey","metaKey","toLowerCase","addEventListener","removeEventListener","className","children","userName","asChild","variant","locale","align","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","disabled","icon","required","readOnly","s","htmlFor","type","size","onClick","onChange","min","step","ref","title","onWheel","style","overscrollBehaviorX","overscrollBehaviorY","touchAction","idx","onKeyDown","rows","onEdit","onDelete","totalHours"],"sources":["D:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioHoras.tsx"],"sourcesContent":["// FormularioHoras.tsx\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\n\nimport { toast } from 'sonner';\nimport {\n  Calendar as CalendarIcon,\n  Briefcase,\n  Save,\n  Pencil,\n  ListChecks,\n  ClipboardList,\n  XCircle,\n  PlusCircle,\n  Loader2,\n  Folder,\n  Star,\n  ArrowUpDown,\n  Minus,\n  Plus,\n  Info,\n  Undo2,\n  Clock,\n} from 'lucide-react';\n\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { cn } from '../lib/utils';\n\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\n\nimport {\n  submitHours,\n  getProjects,\n  getProjectStages,\n  getDisciplinesByStage,\n  getActivitiesByDiscipline,\n  getDailyActivities,\n  deleteHour,\n  updateHour,\n  type DailyActivity,\n} from '../api/horasApi';\n\n// Props e interfaces\ninterface FormularioHorasProps {\n  onSuccess: () => void;\n  employeeId: number;\n  employeeName: string;\n  onLogout: () => void;\n}\n\ninterface Project { code: string; name: string }\n\ntype Activity = DailyActivity;\n\nconst initialFormData = (employeeId: number) => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '0',\n  note: '',\n});\n\nconst DRAFT_KEY = 'fh_form_draft_v1';\n\n// Helper: ordenar A-Z / 0-9\nconst sortAZ = (arr: string[]) =>\n  [...arr].sort((a, b) => a.localeCompare(b, 'es', { numeric: true, sensitivity: 'base' }));\n\n// Comparator: primero letras, luego n√∫meros\nconst projectComparator = (a: Project, b: Project) => {\n  const aCode = (a.code ?? '').trim();\n  const bCode = (b.code ?? '').trim();\n  const aStartsWithLetter = /^[A-Za-z√Å√â√ç√ì√ö√ú√ë]/i.test(aCode);\n  const bStartsWithLetter = /^[A-Za-z√Å√â√ç√ì√ö√ú√ë]/i.test(bCode);\n  if (aStartsWithLetter !== bStartsWithLetter) return aStartsWithLetter ? -1 : 1;\n  // dentro del mismo grupo, ordenar natural A-Z/0-9\n  return aCode.localeCompare(bCode, 'es', { numeric: true, sensitivity: 'base' });\n};\n\nconst FormularioHoras: React.FC<FormularioHorasProps> = ({ onSuccess, employeeId, employeeName, onLogout }) => {\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [stages, setStages] = useState<string[]>([]);\n  const [disciplines, setDisciplines] = useState<string[]>([]);\n  const [activities, setActivities] = useState<string[]>([]);\n  const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\n\n  type Favorite = { project_code: string; phase: string; discipline: string; activity: string };\n  const FAV_KEY = useMemo(() => `fh_favorites_v1_${employeeId}`, [employeeId]);\n  const [favorites, setFavorites] = useState<Favorite[]>([]);\n\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('asc');\n  const [isDirty, setIsDirty] = useState<boolean>(false);\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null as string | null,\n  });\n\n  const hoursInputRef = useRef<HTMLInputElement | null>(null);\n  const undoTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const favScrollRef = useRef<HTMLDivElement | null>(null);\n  const handleFavWheel = useCallback((e: React.WheelEvent<HTMLDivElement>) => {\n    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {\n      e.preventDefault();\n      e.stopPropagation();\n      e.currentTarget.scrollLeft += e.deltaY;\n    }\n  }, []);\n\n  const selectedProjectName = useMemo(\n    () => projects.find(p => p.code === formData.project_code)?.name || '',\n    [formData.project_code, projects]\n  );\n  const hoursNumber = useMemo(() => {\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n  const totalHoursToday = useMemo(\n    () => dailyActivities.reduce((sum, a) => sum + (Number(a.hours) || 0), 0),\n    [dailyActivities]\n  );\n\n  const [errors, setErrors] = useState<Partial<Record<keyof ReturnType<typeof initialFormData>, string>>>({});\n  useEffect(() => {\n    const newErrors: typeof errors = {};\n    if (!formData.project_code) newErrors.project_code = 'Selecciona un proyecto';\n    if (!formData.phase) newErrors.phase = 'Selecciona una etapa';\n    if (!formData.discipline) newErrors.discipline = 'Selecciona una disciplina';\n    if (!formData.activity) newErrors.activity = 'Selecciona una actividad';\n    if (!(hoursNumber > 0)) newErrors.hours = 'Ingresa horas v√°lidas (> 0)';\n    setErrors(newErrors);\n  }, [formData, hoursNumber]);\n\n  useEffect(() => {\n    const raw = localStorage.getItem(DRAFT_KEY);\n    if (raw) { try {\n      const draft = JSON.parse(raw);\n      setFormData((prev) => ({ ...prev, ...draft, employee_id: String(employeeId) }));\n    } catch {} }\n  }, [employeeId]);\n  useEffect(() => { localStorage.setItem(DRAFT_KEY, JSON.stringify(formData)); }, [formData]);\n\n  useEffect(() => {\n    const raw = localStorage.getItem(FAV_KEY);\n    if (raw) try { setFavorites(JSON.parse(raw)); } catch {}\n  }, [FAV_KEY]);\n  const saveFavorites = (next: Favorite[]) => { setFavorites(next); localStorage.setItem(FAV_KEY, JSON.stringify(next)); };\n\n  const currentFavObj = useMemo(() => {\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity) return null;\n    return { project_code: formData.project_code, phase: formData.phase, discipline: formData.discipline, activity: formData.activity } as Favorite;\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity]);\n  const isCurrentFavorite = useMemo(() => {\n    if (!currentFavObj) return false;\n    return favorites.some(f => JSON.stringify(f) === JSON.stringify(currentFavObj));\n  }, [favorites, currentFavObj]);\n\n  const toggleFavorite = () => {\n    if (!currentFavObj) { toast.error('Completa Proyecto, Etapa, Disciplina y Actividad para usar favoritos'); return; }\n    if (isCurrentFavorite) {\n      const next = favorites.filter(f => JSON.stringify(f) !== JSON.stringify(currentFavObj));\n      saveFavorites(next);\n      toast.message('Eliminado de favoritos');\n    } else {\n      saveFavorites([...favorites, currentFavObj]);\n      toast.success('Guardado en favoritos');\n    }\n  };\n\n  const visibleActivities = useMemo(() => {\n    let list = [...dailyActivities];\n    list.sort((a, b) => (a.id || '').localeCompare(b.id || ''));\n    if (sortDir === 'desc') list.reverse();\n    return list;\n  }, [dailyActivities, sortDir]);\n\n  useEffect(() => {\n    const base = initialFormData(employeeId);\n    const changed = JSON.stringify({ ...formData, employee_id: undefined }) !== JSON.stringify({ ...base, employee_id: undefined });\n    setIsDirty(changed || Boolean(editingActivityId));\n  }, [formData, editingActivityId, employeeId]);\n\n  const refreshDailyActivities = useCallback(async (date: Date, id: string) => {\n    setLoading((p) => ({ ...p, dailyActivities: true }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (e) {\n      toast.error('Error al cargar las actividades del d√≠a.');\n      console.error(e);\n    } finally {\n      setLoading((p) => ({ ...p, dailyActivities: false }));\n    }\n  }, []);\n\n  const fetchProjects = useCallback(async () => {\n    setLoading((p) => ({ ...p, projects: true }));\n    try {\n      const data = await getProjects();\n      const sorted = [...data].sort(projectComparator); // letras primero, luego n√∫meros\n      setProjects(sorted);\n    } catch (e) {\n      toast.error('Error al cargar proyectos.');\n    } finally {\n      setLoading((p) => ({ ...p, projects: false }));\n    }\n  }, []);\n\n  const fetchStages = useCallback(async (projectCode: string) => {\n    if (!projectCode) return [] as string[];\n    setLoading((p) => ({ ...p, stages: true }));\n    try {\n      const data = await getProjectStages(projectCode);\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setStages(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar etapas.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading((p) => ({ ...p, stages: false }));\n    }\n  }, []);\n\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\n    if (!projectCode || !stage) return [] as string[];\n    setLoading((p) => ({ ...p, disciplines: true }));\n    try {\n      const data = await getDisciplinesByStage(projectCode, stage);\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setDisciplines(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading((p) => ({ ...p, disciplines: false }));\n    }\n  }, []);\n\n  const fetchActivities = useCallback(async (projectCode: string, stage: string, discipline: string) => {\n    if (!projectCode || !stage || !discipline) return [] as string[];\n    setLoading((p) => ({ ...p, activities: true }));\n    try {\n      const data = await getActivitiesByDiscipline(projectCode, stage, discipline);\n      const cleaned = (data || []).filter((v: any) => v != null && String(v).trim() !== '').map(String);\n      const sorted = sortAZ(cleaned);\n      setActivities(sorted);\n      return sorted;\n    } catch (e) {\n      toast.error('Error al cargar actividades.');\n      setActivities([]);\n      return [];\n    } finally {\n      setLoading((p) => ({ ...p, activities: false }));\n    }\n  }, []);\n\n  const applyFavorite = useCallback(async (fav: Favorite) => {\n    try {\n      setFormData((prev) => ({ ...prev, project_code: fav.project_code, phase: '', discipline: '', activity: '' }));\n      const st = await fetchStages(fav.project_code);\n      if (st && st.includes(fav.phase)) {\n        const ds = await fetchDisciplines(fav.project_code, fav.phase);\n        if (ds && ds.includes(fav.discipline)) {\n          const ac = await fetchActivities(fav.project_code, fav.phase, fav.discipline);\n          if (ac && ac.includes(fav.activity)) {\n            setFormData({\n              employee_id: String(employeeId),\n              project_code: fav.project_code,\n              phase: fav.phase,\n              discipline: fav.discipline,\n              activity: fav.activity,\n              hours: '0',\n              note: '',\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo aplicar el favorito');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n\n  useEffect(() => { fetchProjects(); }, [fetchProjects]);\n  useEffect(() => { refreshDailyActivities(selectedDate, String(employeeId)); }, [selectedDate, employeeId, refreshDailyActivities]);\n\n  const handleDateChange = (date?: Date) => { if (date) setSelectedDate(date); };\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData((prev) => ({ ...prev, [name]: v }));\n  };\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => { if (e.key === 'Enter' && !e.shiftKey) e.preventDefault(); };\n\n  const handleSelectChange = async (name: keyof ReturnType<typeof initialFormData>, value: string) => {\n    const updated = { ...formData, [name]: value } as ReturnType<typeof initialFormData>;\n    switch (name) {\n      case 'project_code':\n        updated.phase = ''; updated.discipline = ''; updated.activity = '';\n        setFormData(updated); setStages([]); setDisciplines([]); setActivities([]);\n        if (value) await fetchStages(value);\n        break;\n      case 'phase':\n        updated.discipline = ''; updated.activity = '';\n        setFormData(updated); setDisciplines([]); setActivities([]);\n        if (value && updated.project_code) await fetchDisciplines(updated.project_code, value);\n        break;\n      case 'discipline':\n        updated.activity = '';\n        setFormData(updated); setActivities([]);\n        if (value && updated.project_code && updated.phase) await fetchActivities(updated.project_code, updated.phase, value);\n        break;\n      default:\n        setFormData(updated);\n    }\n  };\n\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n\n  const handleEditActivity = useCallback(async (activity: Activity) => {\n    try {\n      if (activity.date) {\n        try {\n          const d = typeof activity.date === 'string' ? parseISO(activity.date) : new Date(activity.date);\n          setSelectedDate(d);\n        } catch {}\n      }\n      if (activity.project_code) {\n        await fetchStages(activity.project_code);\n        if (activity.phase) await fetchDisciplines(activity.project_code, activity.phase);\n        if (activity.phase && activity.discipline) await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n      }\n      setFormData({\n        employee_id: String(employeeId),\n        project_code: activity.project_code || '',\n        phase: activity.phase || '',\n        discipline: activity.discipline || '',\n        activity: activity.activity || '',\n        hours: String(activity.hours ?? '0'),\n        note: activity.note || '',\n      });\n      setEditingActivityId(String(activity.id));\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    } catch (e) {\n      console.error(e);\n      toast.error('Error al cargar la actividad para edici√≥n');\n    }\n  }, [employeeId, fetchStages, fetchDisciplines, fetchActivities]);\n\n  const [undoData, setUndoData] = useState<Activity | null>(null);\n  const triggerUndoBanner = (activity: Activity) => {\n    setUndoData(activity);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = setTimeout(() => setUndoData(null), 8000);\n  };\n  const handleUndoDelete = async () => {\n    if (!undoData) return;\n    const a = undoData; setUndoData(null);\n    try {\n      await submitHours({\n        project_code: a.project_code,\n        phase: a.phase,\n        discipline: a.discipline,\n        activity: a.activity,\n        hours: a.hours,\n        note: a.note || '',\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        employee_id: employeeId,\n      });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      toast.success('Registro restaurado');\n    } catch (e) {\n      toast.error('No se pudo restaurar');\n    }\n  };\n\n  const coreSubmit = async () => {\n    const submissionData = {\n      project_code: formData.project_code,\n      phase: formData.phase,\n      discipline: formData.discipline,\n      activity: formData.activity,\n      hours: hoursNumber,\n      note: formData.note || '',\n      date: format(selectedDate, 'yyyy-MM-dd'),\n      employee_id: employeeId,\n    };\n\n    const toastId = toast.loading(editingActivityId ? 'Actualizando actividad...' : 'Guardando actividad...');\n    setLoading((p) => ({ ...p, submit: true }));\n\n    try {\n      if (editingActivityId) { await updateHour(editingActivityId, submissionData); }\n      else { await submitHours(submissionData); }\n\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con √©xito.`, { id: toastId, duration: 1800 });\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      onSuccess?.();\n      return true;\n    } catch (e) {\n      console.error(e);\n      toast.error('Ocurri√≥ un error al guardar.', { id: toastId });\n      return false;\n    } finally {\n      setLoading((p) => ({ ...p, submit: false }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (Object.keys(errors).length) { toast.error('Revisa los campos marcados'); return; }\n    const ok = await coreSubmit();\n    if (ok) resetForm();\n  };\n\n  const handleDelete = async (id: string) => {\n    const prev = dailyActivities.find(a => String(a.id) === String(id));\n    try {\n      setLoading(p => ({ ...p, delete: id }));\n      await deleteHour(id);\n      await refreshDailyActivities(selectedDate, String(employeeId));\n      if (prev) triggerUndoBanner(prev);\n      toast.error('Actividad eliminada');\n    } catch (e) {\n      console.error(e);\n      toast.error('No se pudo eliminar');\n    } finally {\n      setLoading(p => ({ ...p, delete: null }));\n    }\n  };\n\n  const adjustHours = (delta: number) => {\n    const current = hoursNumber || 0;\n    const next = Math.max(0, Math.round((current + delta) * 2) / 2);\n    setFormData((prev) => ({ ...prev, hours: String(next) }));\n  };\n\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => {\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'enter') {\n        e.preventDefault();\n        (async () => { if (!loading.submit) { const ok = await coreSubmit(); if (ok) resetForm(); } })();\n      }\n      if (e.key === 'Escape') { resetForm(); }\n    };\n    window.addEventListener('keydown', onKey);\n    return () => window.removeEventListener('keydown', onKey);\n  }, [coreSubmit, loading.submit, resetForm]);\n\n  return (\n    <div className=\"min-h-svh overflow-y-auto bg-[#f2f6fd]\">\n      <Header userName={employeeName} onLogout={onLogout} />\n\n      <style>{`\n        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }\n        .hide-scrollbar::-webkit-scrollbar { display: none; }\n        .fav-strip { overscroll-behavior-y: contain; touch-action: pan-x; }\n\n        /* üëâ Fuerza saltos de l√≠nea en textos sin espacios y evita desbordes */\n        .text-wrap, .text-wrap *{\n          overflow-wrap: anywhere;\n          word-break: break-word;\n          hyphens: auto;\n        }\n      `}</style>\n\n      <div className=\"mx-auto container p-4 sm:p-6 lg:p-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start\">\n          {/* PRINCIPAL */}\n          <main className={cn('lg:col-span-3')}>\n            <Card className=\"relative z-10 flex flex-col text-wrap\">\n              <CardHeader className=\"relative items-center text-center\">\n                <div className=\"flex items-center justify-center gap-2\">\n                  {editingActivityId ? <Pencil className=\"h-5 w-5\" /> : <PlusCircle className=\"h-5 w-5\" />}\n                  <CardTitle className=\"text-center\">\n                    {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\n                  </CardTitle>\n                </div>\n                <div className=\"absolute right-4 top-4 text-xs\">\n                  {editingActivityId ? (\n                    <span className=\"px-2 py-1 rounded-full bg-amber-100 text-amber-800\">Editando</span>\n                  ) : (\n                    <span className=\"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700\">Creando</span>\n                  )}\n                </div>\n                <p className=\"mt-2 text-sm text-muted-foreground\">\n                  Registra tus horas del d√≠a para el proyecto seleccionado.\n                </p>\n\n                <div className=\"mt-3 text-xs sm:text-sm text-foreground/80 flex flex-wrap justify-center gap-2\">\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\n                    <Briefcase className=\"h-3.5 w-3.5\" /> {formData.project_code || '‚Äî'}\n                  </span>\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\n                    <ListChecks className=\"h-3.5 w-3.5\" /> {formData.phase || '‚Äî'}\n                  </span>\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\n                    <Pencil className=\"h-3.5 w-3.5\" /> {formData.discipline || '‚Äî'}\n                  </span>\n                  <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border\">\n                    <ClipboardList className=\"h-3.5 w-3.5\" /> {formData.activity || '‚Äî'}\n                  </span>\n                </div>\n              </CardHeader>\n\n              <CardContent>\n                {/* Fecha */}\n                <div className=\"mb-4 w-full sm:max-w-xs\">\n                  <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                    <span className=\"inline-flex items-center gap-1\">\n                      <CalendarIcon className=\"h-4 w-4\" /> Fecha\n                    </span>\n                  </label>\n                  <Popover>\n                    <PopoverTrigger asChild>\n                      <Button variant=\"outline\" className={cn('w-full justify-start font-normal h-10', !selectedDate && 'text-muted-foreground')}>\n                        <span>{format(selectedDate, 'PPP', { locale: es })}</span>\n                      </Button>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                      <Calendar mode=\"single\" selected={selectedDate} onSelect={handleDateChange} initialFocus locale={es} />\n                    </PopoverContent>\n                  </Popover>\n                </div>\n\n                {/* GRID: columna izquierda m√°s estrecha */}\n                <div className=\"grid grid-cols-1 md:grid-cols-[320px_minmax(0,1fr)] gap-6 items-start\">\n                  {/* C√≥digo de Proyecto (col izq) */}\n                  <div className=\"text-wrap\">\n                    <FormSelect\n                      label=\"C√≥digo de Proyecto\"\n                      name=\"project_code\"\n                      value={formData.project_code}\n                      onValueChange={handleSelectChange as any}\n                      options={projects.map((p) => ({ value: p.code, label: p.code, dropdownLabel: `${p.code} - ${p.name}` }))}\n                      placeholder=\"Seleccione un proyecto\"\n                      loading={loading.projects}\n                      disabled={loading.projects}\n                      icon={<Briefcase className=\"h-4 w-4\" />}\n                      required\n                    />\n                    <p className=\"mt-1 text-[12px] text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis leading-none\">\n                      Elige el proyecto para cargar los demas campos.\n                    </p>\n                  </div>\n\n                  {/* Nombre del Proyecto (col der) */}\n                  <div className=\"space-y-2 text-wrap\">\n                    <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                      <span className=\"inline-flex items-center gap-1\"><Folder className=\"h-4 w-4\" /> Nombre del Proyecto</span>\n                    </label>\n                    <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" aria-label=\"Nombre de proyecto seleccionado\" />\n                  </div>\n\n                  {/* Etapa (izq) */}\n                  <div className=\"text-wrap\">\n                    <FormSelect\n                      label=\"Etapa\"\n                      name=\"phase\"\n                      value={formData.phase}\n                      onValueChange={handleSelectChange as any}\n                      options={stages.map((s) => ({ value: s, label: s }))}\n                      placeholder=\"Seleccione una etapa\"\n                      loading={loading.stages}\n                      disabled={!formData.project_code || loading.stages}\n                      icon={<ListChecks className=\"h-4 w-4\" />}\n                      required\n                    />\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Etapas disponibles para el proyecto elegido.</p>\n                  </div>\n\n                  {/* Disciplina (der) */}\n                  <div className=\"text-wrap\">\n                    <FormSelect\n                      label=\"Disciplina\"\n                      name=\"discipline\"\n                      value={formData.discipline}\n                      onValueChange={handleSelectChange as any}\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\n                      placeholder=\"Seleccione una disciplina\"\n                      loading={loading.disciplines}\n                      disabled={!formData.phase || loading.disciplines}\n                      icon={<Pencil className=\"h-4 w-4\" />}\n                      required\n                    />\n                    <p className=\"mt-1 text-xs text-muted-foreground\">Se filtran seg√∫n la etapa seleccionada.</p>\n                  </div>\n\n                  {/* Actividad (izq) */}\n                  <div className=\"w-full md:w-[320px] text-wrap\">\n                    <FormSelect\n                      label=\"Actividad\"\n                      name=\"activity\"\n                      value={formData.activity}\n                      onValueChange={handleSelectChange as any}\n                      options={activities.map((a) => ({ value: a, label: a }))}\n                      placeholder=\"Seleccione una actividad\"\n                      loading={loading.activities}\n                      disabled={!formData.discipline || loading.activities}\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\n                      required\n                    />\n                  </div>\n\n                  {/* Horas (der) ‚Äì input a la izquierda, botones a la derecha */}\n                  <div className=\"flex flex-col text-wrap\">\n                    <label htmlFor=\"hours\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Clock className=\"h-4 w-4\" /> Horas <span className=\"text-destructive\">*</span>\n                      </span>\n                    </label>\n\n                    <div className=\"flex items-center gap-1\">\n                      {/* Bot√≥n Restar */}\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        size=\"icon\"\n                        className=\"h-10 w-10 shrink-0\"\n                        onClick={() => adjustHours(-0.5)}\n                        aria-label=\"Restar 0.5h\"\n                      >\n                        <Minus className=\"h-4 w-4\" />\n                      </Button>\n\n                      {/* Bot√≥n Sumar */}\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        size=\"icon\"\n                        className=\"h-10 w-10 shrink-0\"\n                        onClick={() => adjustHours(0.5)}\n                        aria-label=\"Sumar 0.5h\"\n                      >\n                        <Plus className=\"h-4 w-4\" />\n                      </Button>\n\n                      {/* Input de horas */}\n                      <Input\n                        id=\"hours\"\n                        name=\"hours\"\n                        type=\"number\"\n                        value={formData.hours}\n                        onChange={handleChange}\n                        min=\"0\"\n                        step=\"0.5\"\n                        ref={hoursInputRef}\n                        className=\"h-10 w-[100px] shrink-0 rounded-md mr-0\"\n                      />\n\n                      {/* Bot√≥n Favorito */}\n                      <Button\n                        type=\"button\"\n                        variant={isCurrentFavorite ? 'default' : 'outline'}\n                        className=\"h-10 shrink-0\"\n                        onClick={toggleFavorite}\n                        title={isCurrentFavorite ? 'Quitar de favoritos' : 'Guardar como favorito'}\n                      >\n                        <Star className=\"h-4 w-4 mr-2\" /> Favorito\n                      </Button>\n                    </div>\n                  </div>\n\n                  {/* Chips de favoritos (ocupa ambas columnas) */}\n                  {favorites.length > 0 && (\n                    <div className=\"md:col-span-2\">\n                      <div\n                        ref={favScrollRef}\n                        onWheel={handleFavWheel}\n                        className=\"mt-1 overflow-x-auto whitespace-nowrap hide-scrollbar fav-strip\"\n                        style={{ overscrollBehaviorX: 'contain', overscrollBehaviorY: 'none', touchAction: 'pan-x' }}\n                      >\n                        <div className=\"flex gap-2\">\n                          {favorites.map((fav, idx) => (\n                            <button\n                              key={idx}\n                              type=\"button\"\n                              onClick={() => applyFavorite(fav)}\n                              className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full border bg-white hover:bg-muted text-xs shrink-0\"\n                              title={`${fav.project_code} ‚Ä¢ ${fav.phase} ‚Ä¢ ${fav.discipline}`}\n                            >\n                              <Star className=\"h-3.5 w-3.5\" />\n                              <span className=\"font-medium\">{fav.activity}</span>\n                            </button>\n                          ))}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Nota (Opcional) ‚Äì 2 l√≠neas */}\n                  <div className=\"md:col-span-2 w-full text-wrap\">\n                    <label htmlFor=\"note\" className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Info className=\"h-4 w-4\" /> Nota (Opcional)\n                      </span>\n                    </label>\n                    <textarea\n                      id=\"note\"\n                      name=\"note\"\n                      value={formData.note}\n                      onChange={handleChange}\n                      onKeyDown={handleNoteKeyDown}\n                      rows={2}\n                      className=\"flex h-19 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 whitespace-pre-wrap\"\n                      placeholder=\"Descripci√≥n breve del trabajo realizado\"\n                    />\n                  </div>\n                </div>\n\n                {/* Acciones */}\n                <div className=\"mt-6 flex items-center justify-end gap-3\">\n                  <Button\n                    type=\"submit\"\n                    onClick={(e) => { e.preventDefault(); handleSubmit(e as any); }}\n                    disabled={loading.submit || Object.keys(errors).length > 0}\n                    className=\"h-11\"\n                  >\n                    {loading.submit ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Save className=\"mr-2 h-4 w-4\" />}\n                    {editingActivityId ? 'Actualizar' : 'Guardar'}\n                  </Button>\n\n                  {editingActivityId && (\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"h-11\">\n                      <XCircle className=\"mr-2 h-4 w-4\" /> Cancelar edici√≥n\n                    </Button>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </main>\n\n          {/* LATERAL */}\n          <aside className=\"lg:col-span-2\">\n            <Card className=\"h-full text-wrap\">\n              <CardHeader className=\"relative\">\n                <CardTitle className=\"text-center flex items-center justify-center gap-2\">\n                  <ClipboardList className=\"h-5 w-5\" />\n                  Actividades del D√≠a\n                </CardTitle>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"icon\"\n                  title=\"Ordenar\"\n                  onClick={() => setSortDir((d) => (d === 'asc' ? 'desc' : 'asc'))}\n                  className=\"absolute right-4 top-4\"\n                >\n                  <ArrowUpDown className=\"h-4 w-4\" />\n                </Button>\n\n                <div className=\"text-sm text-muted-foreground flex items-center justify-center gap-3 mt-2\">\n                  <span className=\"inline-flex items-center gap-2\">\n                    <CalendarIcon className=\"h-4 w-4\" /> {format(selectedDate, 'PPP', { locale: es })}\n                  </span>\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full bg-muted/60 text-foreground/80\">\n                    Total registros: {dailyActivities.length}\n                  </span>\n                </div>\n              </CardHeader>\n\n              <CardContent>\n                {loading.dailyActivities ? (\n                  <ActivityListSkeleton />\n                ) : visibleActivities.length > 0 ? (\n                  <>\n                    {/* Lista sin overflow horizontal y con saltos de l√≠nea */}\n                    <div className=\"space-y-4 max-h-[520px] overflow-y-auto overflow-x-hidden pr-1 text-wrap\">\n                      {visibleActivities.map((activity) => (\n                        <div key={activity.id} className=\"text-wrap\">\n                          <ActivityItem\n                            activity={activity}\n                            onEdit={handleEditActivity}\n                            onDelete={handleDelete}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                    <div className=\"pt-3\">\n                      <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\n                    </div>\n                  </>\n                ) : (\n                  <EmptyState />\n                )}\n              </CardContent>\n            </Card>\n          </aside>\n        </div>\n      </div>\n\n      {undoData && (\n        <div className=\"fixed bottom-3 left-1/2 -translate-x-1/2 z-50 bg-red-50 border border-red-200 text-red-700 shadow rounded-full px-4 py-2 flex items-center gap-3\">\n          <span className=\"text-sm\">Registro eliminado.</span>\n          <Button size=\"sm\" variant=\"outline\" onClick={handleUndoDelete}>\n            <Undo2 className=\"h-4 w-4 mr-1\" /> Deshacer\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FormularioHoras;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}