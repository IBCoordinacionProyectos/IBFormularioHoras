{"ast":null,"code":"var _jsxFileName = \"D:\\\\formulario de horas\\\\FormularioHoras Version 1\\\\frontend\\\\src\\\\components\\\\FormularioHoras.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\nimport { toast } from 'sonner';\nimport { Calendar as CalendarIcon, Briefcase, Save, Pencil, ListChecks, ClipboardList, XCircle, PlusCircle, Loader2 } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { cn } from '../lib/utils';\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\nimport { submitHours, getProjects, getProjectStages, getDisciplinesByStage, getActivitiesByDiscipline, getDailyActivities, deleteHour } from '../api/horasApi';\n\n// Props e interfaces\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialFormData = employeeId => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '',\n  note: ''\n});\nconst FormularioHoras = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout\n}) => {\n  _s();\n  // State\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState([]);\n  const [projects, setProjects] = useState([]);\n  const [stages, setStages] = useState([]);\n  const [disciplines, setDisciplines] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [editingActivityId, setEditingActivityId] = useState(null);\n\n  // Loading\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null // ID de la actividad que se está eliminando o null\n  });\n\n  // Derivados\n  const totalHoursToday = useMemo(() => dailyActivities.reduce((sum, a) => sum + a.hours, 0), [dailyActivities]);\n  const selectedProjectName = useMemo(() => {\n    var _projects$find;\n    return ((_projects$find = projects.find(p => p.code === formData.project_code)) === null || _projects$find === void 0 ? void 0 : _projects$find.name) || '';\n  }, [formData.project_code, projects]);\n\n  // Normaliza horas: '1,5' -> 1.5\n  const hoursNumber = useMemo(() => {\n    var _formData$hours;\n    const raw = String((_formData$hours = formData.hours) !== null && _formData$hours !== void 0 ? _formData$hours : '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n\n  // Validación booleana real\n  const isFormValid = useMemo(() => {\n    const required = [formData.project_code, formData.phase, formData.discipline, formData.activity];\n    const allFilled = required.every(v => typeof v === 'string' ? v.trim().length > 0 : Boolean(v));\n    return allFilled && hoursNumber > 0;\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity, hoursNumber]);\n\n  // Fetchers\n  const refreshDailyActivities = useCallback(async (date, id) => {\n    setLoading(prev => ({\n      ...prev,\n      dailyActivities: true\n    }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (error) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(error);\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        dailyActivities: false\n      }));\n    }\n  }, []);\n  const fetchProjects = useCallback(async () => {\n    setLoading(prev => ({\n      ...prev,\n      projects: true\n    }));\n    try {\n      const projectData = await getProjects();\n      setProjects(projectData);\n    } catch (error) {\n      toast.error('Error al cargar proyectos.');\n      console.error(error);\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        projects: false\n      }));\n    }\n  }, []);\n  const fetchStages = useCallback(async projectCode => {\n    if (!projectCode) return;\n    setLoading(prev => ({\n      ...prev,\n      stages: true\n    }));\n    try {\n      const stageData = await getProjectStages(projectCode);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validStages = stageData.filter(stage => stage != null && String(stage).trim() !== '').map(String);\n      setStages(validStages);\n      return validStages;\n    } catch (error) {\n      console.error('Error al cargar las etapas:', error);\n      toast.error('Error al cargar las etapas del proyecto.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        stages: false\n      }));\n    }\n  }, []);\n  const fetchDisciplines = useCallback(async (projectCode, stage) => {\n    if (!projectCode || !stage) {\n      setDisciplines([]);\n      return [];\n    }\n    setLoading(prev => ({\n      ...prev,\n      disciplines: true\n    }));\n    try {\n      const disciplineData = await getDisciplinesByStage(projectCode, stage);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validDisciplines = disciplineData.filter(discipline => discipline != null && String(discipline).trim() !== '').map(String);\n      setDisciplines(validDisciplines);\n      return validDisciplines;\n    } catch (error) {\n      console.error('Error al cargar las disciplinas:', error);\n      toast.error('Error al cargar las disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        disciplines: false\n      }));\n    }\n  }, []);\n  const fetchActivities = useCallback(async (projectCode, stage, discipline) => {\n    if (!projectCode || !stage || !discipline) {\n      setActivities([]);\n      return [];\n    }\n    setLoading(prev => ({\n      ...prev,\n      activities: true\n    }));\n    try {\n      const activityData = await getActivitiesByDiscipline(projectCode, stage, discipline);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validActivities = activityData.filter(activity => activity != null && String(activity).trim() !== '').map(String);\n      setActivities(validActivities);\n      return validActivities;\n    } catch (error) {\n      console.error('Error al cargar las actividades:', error);\n      toast.error('Error al cargar las actividades.');\n      setActivities([]);\n      return [];\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        activities: false\n      }));\n    }\n  }, []);\n\n  // Effects\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n\n  // Handlers\n  const handleDateChange = date => {\n    if (date) {\n      setSelectedDate(date);\n      refreshDailyActivities(date, String(employeeId));\n    }\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData(prev => ({\n      ...prev,\n      [name]: v\n    }));\n  };\n\n  // Manejar la tecla Enter en el textarea de notas\n  const handleNoteKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n    }\n  };\n  const handleSelectChange = async (name, value) => {\n    // Crear una copia actualizada del formulario\n    const updatedFormData = {\n      ...formData,\n      [name]: value\n    };\n\n    // Manejar cambios en cascada basados en el campo modificado\n    switch (name) {\n      case 'project_code':\n        // Limpiar campos dependientes\n        updatedFormData.phase = '';\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n\n        // Limpiar estados de opciones\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n\n        // Cargar etapas si hay un proyecto seleccionado\n        if (value) {\n          await fetchStages(value);\n        }\n        break;\n      case 'phase':\n        // Limpiar campos dependientes\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n\n        // Limpiar estados de opciones dependientes\n        setDisciplines([]);\n        setActivities([]);\n\n        // Cargar disciplinas si hay una fase seleccionada\n        if (value && updatedFormData.project_code) {\n          await fetchDisciplines(updatedFormData.project_code, value);\n        }\n        break;\n      case 'discipline':\n        // Limpiar actividad\n        updatedFormData.activity = '';\n\n        // Limpiar actividades\n        setActivities([]);\n\n        // Cargar actividades si hay una disciplina seleccionada\n        if (value && updatedFormData.project_code && updatedFormData.phase) {\n          await fetchActivities(updatedFormData.project_code, updatedFormData.phase, value);\n        }\n        break;\n    }\n\n    // Actualizar el estado del formulario\n    setFormData(updatedFormData);\n  };\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n\n  // Precarga dependencias al editar + rellena form\n  const handleEditActivity = useCallback(async activity => {\n    try {\n      setLoading(prev => ({\n        ...prev,\n        form: true\n      }));\n\n      // Guardar el ID de la actividad que se está editando\n      setEditingActivityId(activity.id);\n\n      // Actualizar la fecha si es necesario\n      if (activity.date) {\n        try {\n          const activityDate = parseISO(activity.date);\n          // Solo actualizar la fecha si es diferente a la actual\n          if (format(activityDate, 'yyyy-MM-dd') !== format(selectedDate, 'yyyy-MM-dd')) {\n            await new Promise(resolve => {\n              setSelectedDate(activityDate);\n              // Esperar a que se complete la actualización de la fecha\n              setTimeout(resolve, 100);\n            });\n          }\n        } catch (error) {\n          console.error('Error al analizar la fecha:', error);\n        }\n      }\n\n      // 1. Primero establecer el proyecto en el formulario\n      const updatedFormData = {\n        ...formData,\n        project_code: activity.project_code || '',\n        phase: '',\n        discipline: '',\n        activity: '',\n        employee_id: String(activity.employee_id || employeeId),\n        hours: String(activity.hours || ''),\n        note: activity.note || ''\n      };\n\n      // 2. Cargar las etapas del proyecto\n      await fetchStages(activity.project_code);\n\n      // 3. Actualizar la fase en el formulario\n      updatedFormData.phase = activity.phase || '';\n      setFormData(updatedFormData);\n\n      // 4. Cargar las disciplinas para la fase\n      if (activity.phase) {\n        await fetchDisciplines(activity.project_code, activity.phase);\n\n        // 5. Actualizar la disciplina en el formulario\n        updatedFormData.discipline = activity.discipline || '';\n        setFormData(updatedFormData);\n\n        // 6. Cargar las actividades para la disciplina\n        if (activity.discipline) {\n          await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n\n          // 7. Actualizar la actividad en el formulario\n          updatedFormData.activity = activity.activity || '';\n          setFormData(updatedFormData);\n        }\n      }\n\n      // Desplazar al formulario\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    } catch (error) {\n      console.error('Error al cargar la actividad para edición:', error);\n      toast.error('Error al cargar la actividad para edición');\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        form: false\n      }));\n    }\n  }, [fetchStages, fetchDisciplines, fetchActivities, selectedDate, formData, employeeId]);\n  const handleDelete = async idToDelete => {\n    // Crear un ID único para esta notificación\n    const toastId = `delete-toast-${idToDelete}`;\n\n    // Mostrar diálogo de confirmación\n    toast.custom(t => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-warning text-warning-foreground p-4 rounded-lg shadow-lg max-w-md w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col space-y-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-lg\",\n          children: \"\\xBFEliminar actividad?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm\",\n          children: \"Esta acci\\xF3n no se puede deshacer.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end space-x-2 mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toast.dismiss(toastId),\n            className: \"px-4 py-2 text-sm font-medium rounded bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: async () => {\n              try {\n                setLoading(prev => ({\n                  ...prev,\n                  delete: idToDelete\n                }));\n                await deleteHour(idToDelete);\n\n                // Cerrar el toast\n                toast.dismiss(toastId);\n\n                // Mostrar mensaje de éxito\n                toast.success('Actividad eliminada correctamente', {\n                  duration: 3000\n                });\n\n                // Actualizar la lista de actividades\n                refreshDailyActivities(selectedDate, String(employeeId));\n\n                // Si la actividad eliminada es la que se estaba editando, limpiar el formulario\n                if (editingActivityId === idToDelete) {\n                  resetForm();\n                }\n              } catch (error) {\n                console.error('Error al eliminar la actividad:', error);\n                toast.error('Error al eliminar la actividad. Por favor, intente nuevamente.', {\n                  duration: 4000\n                });\n              } finally {\n                setLoading(prev => ({\n                  ...prev,\n                  delete: null\n                }));\n              }\n            },\n            disabled: loading.delete === idToDelete,\n            className: \"px-4 py-2 text-sm font-medium rounded bg-destructive text-destructive-foreground hover:bg-destructive/90 transition-colors flex items-center\",\n            children: loading.delete === idToDelete ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"mr-2 h-4 w-4 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 19\n              }, this), \"Eliminando...\"]\n            }, void 0, true) : 'Eliminar'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }, this), {\n      id: toastId,\n      duration: 10000,\n      position: 'top-center'\n    });\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    // Validar campos requeridos\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity || !formData.hours) {\n      toast.error('Por favor complete todos los campos requeridos.', {\n        duration: 3000\n      });\n      return;\n    }\n\n    // Validar formato de horas\n    const hoursValue = parseFloat(formData.hours.replace(',', '.'));\n    if (isNaN(hoursValue) || hoursValue <= 0) {\n      toast.error('Por favor ingrese un número válido de horas.', {\n        duration: 3000\n      });\n      return;\n    }\n    setLoading(prev => ({\n      ...prev,\n      submit: true\n    }));\n    try {\n      var _projects$find2;\n      // Preparar datos para enviar\n      const submissionData = {\n        ...formData,\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        project_name: ((_projects$find2 = projects.find(p => p.code === formData.project_code)) === null || _projects$find2 === void 0 ? void 0 : _projects$find2.name) || formData.project_code,\n        hours: hoursValue,\n        // Usar el valor numérico normalizado\n        employee_id: employeeId,\n        id: editingActivityId || undefined\n      };\n\n      // Enviar datos\n      await submitHours(submissionData);\n\n      // Mostrar mensaje de éxito\n      toast.success(`Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`, {\n        duration: 3000,\n        style: {\n          backgroundColor: '#28a745',\n          color: 'white',\n          border: 'none',\n          fontSize: '14px',\n          padding: '12px 20px',\n          borderRadius: '4px'\n        }\n      });\n\n      // Limpiar formulario y actualizar lista de actividades\n      resetForm();\n      refreshDailyActivities(selectedDate, String(employeeId));\n\n      // Llamar a la función de éxito si existe\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (error) {\n      console.error('Error al guardar la actividad:', error);\n      toast.error('Error al guardar la actividad. Por favor, intente nuevamente.', {\n        duration: 4000,\n        style: {\n          backgroundColor: '#dc3545',\n          color: 'white',\n          fontSize: '14px',\n          padding: '12px 20px',\n          borderRadius: '4px'\n        }\n      });\n    } finally {\n      setLoading(prev => ({\n        ...prev,\n        submit: false\n      }));\n    }\n  };\n\n  // Render\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      userName: employeeName,\n      onLogout: onLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mx-auto p-4 sm:p-6 lg:p-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 lg:grid-cols-5 gap-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"main\", {\n          className: \"lg:col-span-3\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            className: \"relative z-10\",\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              children: /*#__PURE__*/_jsxDEV(CardTitle, {\n                className: \"flex items-center justify-center\",\n                children: [editingActivityId ? /*#__PURE__*/_jsxDEV(Pencil, {\n                  className: \"mr-2 h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 573,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(PlusCircle, {\n                  className: \"mr-2 h-5 w-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 575,\n                  columnNumber: 21\n                }, this), editingActivityId ? 'Editar Actividad' : 'Registrar Actividad']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 571,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 570,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: /*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: handleSubmit,\n                className: \"space-y-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full md:w-1/3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"date\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: \"Fecha\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 583,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Popover, {\n                    children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n                      asChild: true,\n                      children: /*#__PURE__*/_jsxDEV(Button, {\n                        variant: \"outline\",\n                        className: cn('w-full justify-start text-left font-normal', !selectedDate && 'text-muted-foreground'),\n                        children: [/*#__PURE__*/_jsxDEV(CalendarIcon, {\n                          className: \"mr-2 h-4 w-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 599,\n                          columnNumber: 27\n                        }, this), selectedDate ? /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: format(selectedDate, 'PPP', {\n                            locale: es\n                          })\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 601,\n                          columnNumber: 29\n                        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: \"Seleccione una fecha\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 603,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 592,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 591,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n                      className: \"w-auto p-0\",\n                      children: /*#__PURE__*/_jsxDEV(Calendar, {\n                        mode: \"single\",\n                        selected: selectedDate,\n                        onSelect: handleDateChange,\n                        initialFocus: true,\n                        locale: es\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 609,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 608,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 590,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 582,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n                  children: [/*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"C\\xF3digo de Proyecto\",\n                    name: \"project_code\",\n                    value: formData.project_code,\n                    onValueChange: handleSelectChange,\n                    options: projects.map(p => ({\n                      value: p.code,\n                      label: p.code,\n                      // En el trigger solo se ve el código\n                      dropdownLabel: `${p.code} - ${p.name}` // En la lista: código - nombre\n                    })),\n                    placeholder: \"Seleccione un proyecto\",\n                    loading: loading.projects,\n                    disabled: loading.projects,\n                    icon: /*#__PURE__*/_jsxDEV(Briefcase, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 634,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 621,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"space-y-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                      children: \"Nombre del Proyecto\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 639,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      value: selectedProjectName,\n                      readOnly: true,\n                      className: \"bg-muted/50\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 642,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 638,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Etapa\",\n                    name: \"phase\",\n                    value: formData.phase,\n                    onValueChange: handleSelectChange,\n                    options: stages.map(s => ({\n                      value: s,\n                      label: s\n                    })),\n                    placeholder: \"Seleccione una etapa\",\n                    loading: loading.stages,\n                    disabled: !formData.project_code || loading.stages,\n                    icon: /*#__PURE__*/_jsxDEV(ListChecks, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 654,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 645,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Disciplina\",\n                    name: \"discipline\",\n                    value: formData.discipline,\n                    onValueChange: handleSelectChange,\n                    options: disciplines.map(d => ({\n                      value: d,\n                      label: d\n                    })),\n                    placeholder: \"Seleccione una disciplina\",\n                    loading: loading.disciplines,\n                    disabled: !formData.phase || loading.disciplines,\n                    icon: /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 667,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 658,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(FormSelect, {\n                    label: \"Actividad\",\n                    name: \"activity\",\n                    value: formData.activity,\n                    onValueChange: handleSelectChange,\n                    options: activities.map(a => ({\n                      value: a,\n                      label: a\n                    })),\n                    placeholder: \"Seleccione una actividad\",\n                    loading: loading.activities,\n                    disabled: !formData.discipline || loading.activities,\n                    icon: /*#__PURE__*/_jsxDEV(ClipboardList, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 680,\n                      columnNumber: 29\n                    }, this),\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 671,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"space-y-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      htmlFor: \"hours\",\n                      className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                      children: [\"Horas \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-destructive\",\n                        children: \"*\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 689,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 685,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      id: \"hours\",\n                      name: \"hours\",\n                      type: \"number\",\n                      value: formData.hours,\n                      onChange: handleChange,\n                      min: \"0.5\",\n                      step: \"0.5\",\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 691,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 684,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 620,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"note\",\n                    className: \"block text-sm font-medium text-foreground/80 mb-1\",\n                    children: \"Nota (Opcional)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 705,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    id: \"note\",\n                    name: \"note\",\n                    value: formData.note,\n                    onChange: handleChange,\n                    onKeyDown: handleNoteKeyDown,\n                    rows: 3,\n                    className: \"flex h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n                    placeholder: \"Escriba una nota (opcional)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 711,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 704,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-end items-center gap-3 pt-4\",\n                  children: [editingActivityId && /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"button\",\n                    variant: \"outline\",\n                    onClick: resetForm,\n                    children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                      className: \"mr-2 h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 726,\n                      columnNumber: 25\n                    }, this), \"Cancelar Edici\\xF3n\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 725,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"submit\",\n                    disabled: !isFormValid || loading.submit,\n                    className: \"min-w-[150px]\",\n                    children: [loading.submit ? /*#__PURE__*/_jsxDEV(Loader2, {\n                      className: \"mr-2 h-4 w-4 animate-spin\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 737,\n                      columnNumber: 25\n                    }, this) : /*#__PURE__*/_jsxDEV(Save, {\n                      className: \"mr-2 h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 739,\n                      columnNumber: 25\n                    }, this), editingActivityId ? 'Actualizar' : 'Guardar']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 731,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 723,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 581,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 580,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"lg:col-span-2\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n              children: /*#__PURE__*/_jsxDEV(CardTitle, {\n                className: \"text-center\",\n                children: \"Actividades del D\\xEDa\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 752,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 751,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-4\",\n                children: loading.dailyActivities ? /*#__PURE__*/_jsxDEV(ActivityListSkeleton, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 757,\n                  columnNumber: 21\n                }, this) : dailyActivities.length > 0 ? dailyActivities.map(activity => /*#__PURE__*/_jsxDEV(ActivityItem, {\n                  activity: activity,\n                  onEdit: handleEditActivity,\n                  onDelete: handleDelete\n                }, activity.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 760,\n                  columnNumber: 23\n                }, this)) : /*#__PURE__*/_jsxDEV(EmptyState, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 768,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 755,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-6\",\n                children: /*#__PURE__*/_jsxDEV(TotalHoursProgress, {\n                  totalHours: totalHoursToday,\n                  selectedDate: selectedDate\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 772,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 771,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 754,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 750,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 749,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 566,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 563,\n    columnNumber: 5\n  }, this);\n};\n_s(FormularioHoras, \"k4AyuxVXnZqaRfu5aE6Grn+CPZU=\");\n_c = FormularioHoras;\nexport default FormularioHoras;\nvar _c;\n$RefreshReg$(_c, \"FormularioHoras\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","format","parseISO","es","Header","toast","Calendar","CalendarIcon","Briefcase","Save","Pencil","ListChecks","ClipboardList","XCircle","PlusCircle","Loader2","Card","CardContent","CardHeader","CardTitle","Button","Input","Popover","PopoverContent","PopoverTrigger","cn","FormSelect","ActivityItem","ActivityListSkeleton","EmptyState","TotalHoursProgress","submitHours","getProjects","getProjectStages","getDisciplinesByStage","getActivitiesByDiscipline","getDailyActivities","deleteHour","jsxDEV","_jsxDEV","Fragment","_Fragment","initialFormData","employeeId","employee_id","String","project_code","phase","discipline","activity","hours","note","FormularioHoras","onSuccess","employeeName","onLogout","_s","formData","setFormData","selectedDate","setSelectedDate","Date","dailyActivities","setDailyActivities","projects","setProjects","stages","setStages","disciplines","setDisciplines","activities","setActivities","editingActivityId","setEditingActivityId","loading","setLoading","submit","delete","totalHoursToday","reduce","sum","a","selectedProjectName","_projects$find","find","p","code","name","hoursNumber","_formData$hours","raw","replace","trim","n","Number","isFinite","isFormValid","required","allFilled","every","v","length","Boolean","refreshDailyActivities","date","id","prev","dateString","acts","error","console","fetchProjects","projectData","fetchStages","projectCode","stageData","validStages","filter","stage","map","fetchDisciplines","disciplineData","validDisciplines","fetchActivities","activityData","validActivities","handleDateChange","handleChange","e","value","target","handleNoteKeyDown","key","shiftKey","preventDefault","handleSelectChange","updatedFormData","resetForm","handleEditActivity","form","activityDate","Promise","resolve","setTimeout","window","scrollTo","top","behavior","handleDelete","idToDelete","toastId","custom","t","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","dismiss","success","duration","disabled","position","handleSubmit","hoursValue","parseFloat","isNaN","_projects$find2","submissionData","project_name","undefined","style","backgroundColor","color","border","fontSize","padding","borderRadius","userName","onSubmit","htmlFor","asChild","variant","locale","mode","selected","onSelect","initialFocus","label","onValueChange","options","dropdownLabel","placeholder","icon","readOnly","s","d","type","onChange","min","step","onKeyDown","rows","onEdit","onDelete","totalHours","_c","$RefreshReg$"],"sources":["D:/formulario de horas/FormularioHoras Version 1/frontend/src/components/FormularioHoras.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { format, parseISO } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport Header from './Header';\n\nimport { toast } from 'sonner';\nimport {\n  Calendar as CalendarIcon,\n  Briefcase,\n  Save,\n  Pencil,\n  ListChecks,\n  ClipboardList,\n  XCircle,\n  PlusCircle,\n  Loader2,\n} from 'lucide-react';\n\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Calendar } from './ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\nimport { cn } from '../lib/utils';\n\nimport { FormSelect } from './formulario/FormSelect';\nimport { ActivityItem } from './formulario/ActivityItem';\nimport { ActivityListSkeleton } from './formulario/ActivityListSkeleton';\nimport { EmptyState } from './formulario/EmptyState';\nimport { TotalHoursProgress } from './formulario/TotalHoursProgress';\n\nimport {\n  submitHours,\n  getProjects,\n  getProjectStages,\n  getDisciplinesByStage,\n  getActivitiesByDiscipline,\n  getDailyActivities,\n  deleteHour,\n} from '../api/horasApi';\n\n// Props e interfaces\ninterface FormularioHorasProps {\n  onSuccess: () => void;\n  employeeId: number;\n  employeeName: string;\n  onLogout: () => void;\n}\n\ninterface Project {\n  code: string;\n  name: string;\n}\n\ninterface Activity {\n  id: number;\n  date: string;\n  employee_id: number;\n  project_code: string;\n  project_name: string;\n  phase: string;\n  discipline: string;\n  activity: string;\n  hours: number;\n  note: string;\n}\n\nconst initialFormData = (employeeId: number) => ({\n  employee_id: String(employeeId),\n  project_code: '',\n  phase: '',\n  discipline: '',\n  activity: '',\n  hours: '',\n  note: '',\n});\n\nconst FormularioHoras: React.FC<FormularioHorasProps> = ({\n  onSuccess,\n  employeeId,\n  employeeName,\n  onLogout,\n}) => {\n  // State\n  const [formData, setFormData] = useState(initialFormData(employeeId));\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dailyActivities, setDailyActivities] = useState<Activity[]>([]);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [stages, setStages] = useState<string[]>([]);\n  const [disciplines, setDisciplines] = useState<string[]>([]);\n  const [activities, setActivities] = useState<string[]>([]);\n  const [editingActivityId, setEditingActivityId] = useState<number | null>(null);\n\n  // Loading\n  const [loading, setLoading] = useState({\n    submit: false,\n    projects: true,\n    stages: false,\n    disciplines: false,\n    activities: false,\n    dailyActivities: true,\n    delete: null as number | null, // ID de la actividad que se está eliminando o null\n  });\n\n  // Derivados\n  const totalHoursToday = useMemo(\n    () => dailyActivities.reduce((sum, a) => sum + a.hours, 0),\n    [dailyActivities]\n  );\n\n  const selectedProjectName = useMemo(\n    () => projects.find((p) => p.code === formData.project_code)?.name || '',\n    [formData.project_code, projects]\n  );\n\n  // Normaliza horas: '1,5' -> 1.5\n  const hoursNumber = useMemo(() => {\n    const raw = String(formData.hours ?? '').replace(',', '.').trim();\n    const n = Number(raw);\n    return Number.isFinite(n) ? n : 0;\n  }, [formData.hours]);\n\n  // Validación booleana real\n  const isFormValid = useMemo(() => {\n    const required = [\n      formData.project_code,\n      formData.phase,\n      formData.discipline,\n      formData.activity,\n    ];\n    const allFilled = required.every((v) =>\n      typeof v === 'string' ? v.trim().length > 0 : Boolean(v)\n    );\n    return allFilled && hoursNumber > 0;\n  }, [formData.project_code, formData.phase, formData.discipline, formData.activity, hoursNumber]);\n\n  // Fetchers\n  const refreshDailyActivities = useCallback(async (date: Date, id: string) => {\n    setLoading((prev) => ({ ...prev, dailyActivities: true }));\n    try {\n      const dateString = format(date, 'yyyy-MM-dd');\n      const acts = await getDailyActivities(dateString, Number(id));\n      setDailyActivities(acts);\n    } catch (error) {\n      toast.error('Error al cargar las actividades del día.');\n      console.error(error);\n    } finally {\n      setLoading((prev) => ({ ...prev, dailyActivities: false }));\n    }\n  }, []);\n\n  const fetchProjects = useCallback(async () => {\n    setLoading((prev) => ({ ...prev, projects: true }));\n    try {\n      const projectData = await getProjects();\n      setProjects(projectData);\n    } catch (error) {\n      toast.error('Error al cargar proyectos.');\n      console.error(error);\n    } finally {\n      setLoading((prev) => ({ ...prev, projects: false }));\n    }\n  }, []);\n\n  const fetchStages = useCallback(async (projectCode: string) => {\n    if (!projectCode) return;\n    \n    setLoading((prev) => ({ ...prev, stages: true }));\n    try {\n      const stageData = await getProjectStages(projectCode);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validStages = stageData\n        .filter((stage: any) => stage != null && String(stage).trim() !== '')\n        .map(String);\n      \n      setStages(validStages);\n      return validStages;\n    } catch (error) {\n      console.error('Error al cargar las etapas:', error);\n      toast.error('Error al cargar las etapas del proyecto.');\n      setStages([]);\n      return [];\n    } finally {\n      setLoading((prev) => ({ ...prev, stages: false }));\n    }\n  }, []);\n\n  const fetchDisciplines = useCallback(async (projectCode: string, stage: string) => {\n    if (!projectCode || !stage) {\n      setDisciplines([]);\n      return [];\n    }\n    \n    setLoading((prev) => ({ ...prev, disciplines: true }));\n    try {\n      const disciplineData = await getDisciplinesByStage(projectCode, stage);\n      // Filtrar valores nulos o vacíos y convertir a string\n      const validDisciplines = disciplineData\n        .filter((discipline: any) => discipline != null && String(discipline).trim() !== '')\n        .map(String);\n      \n      setDisciplines(validDisciplines);\n      return validDisciplines;\n    } catch (error) {\n      console.error('Error al cargar las disciplinas:', error);\n      toast.error('Error al cargar las disciplinas.');\n      setDisciplines([]);\n      return [];\n    } finally {\n      setLoading((prev) => ({ ...prev, disciplines: false }));\n    }\n  }, []);\n\n  const fetchActivities = useCallback(\n    async (projectCode: string, stage: string, discipline: string) => {\n      if (!projectCode || !stage || !discipline) {\n        setActivities([]);\n        return [];\n      }\n      \n      setLoading((prev) => ({ ...prev, activities: true }));\n      try {\n        const activityData = await getActivitiesByDiscipline(projectCode, stage, discipline);\n        // Filtrar valores nulos o vacíos y convertir a string\n        const validActivities = activityData\n          .filter((activity: any) => activity != null && String(activity).trim() !== '')\n          .map(String);\n        \n        setActivities(validActivities);\n        return validActivities;\n      } catch (error) {\n        console.error('Error al cargar las actividades:', error);\n        toast.error('Error al cargar las actividades.');\n        setActivities([]);\n        return [];\n      } finally {\n        setLoading((prev) => ({ ...prev, activities: false }));\n      }\n    },\n    []\n  );\n\n  // Effects\n  useEffect(() => {\n    fetchProjects();\n  }, [fetchProjects]);\n\n  useEffect(() => {\n    refreshDailyActivities(selectedDate, String(employeeId));\n  }, [selectedDate, employeeId, refreshDailyActivities]);\n\n  // Handlers\n  const handleDateChange = (date: Date | undefined) => {\n    if (date) {\n      setSelectedDate(date);\n      refreshDailyActivities(date, String(employeeId));\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    const v = name === 'hours' ? value.replace(',', '.') : value;\n    setFormData((prev) => ({ ...prev, [name]: v }));\n  };\n\n  // Manejar la tecla Enter en el textarea de notas\n  const handleNoteKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n    }\n  };\n\n  const handleSelectChange = async (name: string, value: string) => {\n    // Crear una copia actualizada del formulario\n    const updatedFormData = { ...formData, [name]: value };\n\n    // Manejar cambios en cascada basados en el campo modificado\n    switch (name) {\n      case 'project_code':\n        // Limpiar campos dependientes\n        updatedFormData.phase = '';\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n        \n        // Limpiar estados de opciones\n        setStages([]);\n        setDisciplines([]);\n        setActivities([]);\n        \n        // Cargar etapas si hay un proyecto seleccionado\n        if (value) {\n          await fetchStages(value);\n        }\n        break;\n        \n      case 'phase':\n        // Limpiar campos dependientes\n        updatedFormData.discipline = '';\n        updatedFormData.activity = '';\n        \n        // Limpiar estados de opciones dependientes\n        setDisciplines([]);\n        setActivities([]);\n        \n        // Cargar disciplinas si hay una fase seleccionada\n        if (value && updatedFormData.project_code) {\n          await fetchDisciplines(updatedFormData.project_code, value);\n        }\n        break;\n        \n      case 'discipline':\n        // Limpiar actividad\n        updatedFormData.activity = '';\n        \n        // Limpiar actividades\n        setActivities([]);\n        \n        // Cargar actividades si hay una disciplina seleccionada\n        if (value && updatedFormData.project_code && updatedFormData.phase) {\n          await fetchActivities(\n            updatedFormData.project_code, \n            updatedFormData.phase, \n            value\n          );\n        }\n        break;\n    }\n\n    // Actualizar el estado del formulario\n    setFormData(updatedFormData);\n  };\n\n  const resetForm = useCallback(() => {\n    setFormData(initialFormData(employeeId));\n    setEditingActivityId(null);\n  }, [employeeId]);\n\n  // Precarga dependencias al editar + rellena form\n  const handleEditActivity = useCallback(\n    async (activity: Activity) => {\n      try {\n        setLoading(prev => ({ ...prev, form: true }));\n        \n        // Guardar el ID de la actividad que se está editando\n        setEditingActivityId(activity.id);\n        \n        // Actualizar la fecha si es necesario\n        if (activity.date) {\n          try {\n            const activityDate = parseISO(activity.date);\n            // Solo actualizar la fecha si es diferente a la actual\n            if (format(activityDate, 'yyyy-MM-dd') !== format(selectedDate, 'yyyy-MM-dd')) {\n              await new Promise<void>((resolve) => {\n                setSelectedDate(activityDate);\n                // Esperar a que se complete la actualización de la fecha\n                setTimeout(resolve, 100);\n              });\n            }\n          } catch (error) {\n            console.error('Error al analizar la fecha:', error);\n          }\n        }\n\n        // 1. Primero establecer el proyecto en el formulario\n        const updatedFormData = {\n          ...formData,\n          project_code: activity.project_code || '',\n          phase: '',\n          discipline: '',\n          activity: '',\n          employee_id: String(activity.employee_id || employeeId),\n          hours: String(activity.hours || ''),\n          note: activity.note || '',\n        };\n        \n        // 2. Cargar las etapas del proyecto\n        await fetchStages(activity.project_code);\n        \n        // 3. Actualizar la fase en el formulario\n        updatedFormData.phase = activity.phase || '';\n        setFormData(updatedFormData);\n        \n        // 4. Cargar las disciplinas para la fase\n        if (activity.phase) {\n          await fetchDisciplines(activity.project_code, activity.phase);\n          \n          // 5. Actualizar la disciplina en el formulario\n          updatedFormData.discipline = activity.discipline || '';\n          setFormData(updatedFormData);\n          \n          // 6. Cargar las actividades para la disciplina\n          if (activity.discipline) {\n            await fetchActivities(activity.project_code, activity.phase, activity.discipline);\n            \n            // 7. Actualizar la actividad en el formulario\n            updatedFormData.activity = activity.activity || '';\n            setFormData(updatedFormData);\n          }\n        }\n\n        // Desplazar al formulario\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n        \n      } catch (error) {\n        console.error('Error al cargar la actividad para edición:', error);\n        toast.error('Error al cargar la actividad para edición');\n      } finally {\n        setLoading(prev => ({ ...prev, form: false }));\n      }\n    },\n    [fetchStages, fetchDisciplines, fetchActivities, selectedDate, formData, employeeId]\n  );\n\n  const handleDelete = async (idToDelete: number) => {\n    // Crear un ID único para esta notificación\n    const toastId = `delete-toast-${idToDelete}`;\n    \n    // Mostrar diálogo de confirmación\n    toast.custom((t) => (\n      <div className=\"bg-warning text-warning-foreground p-4 rounded-lg shadow-lg max-w-md w-full\">\n        <div className=\"flex flex-col space-y-3\">\n          <h3 className=\"font-semibold text-lg\">¿Eliminar actividad?</h3>\n          <p className=\"text-sm\">Esta acción no se puede deshacer.</p>\n          <div className=\"flex justify-end space-x-2 mt-2\">\n            <button\n              onClick={() => toast.dismiss(toastId)}\n              className=\"px-4 py-2 text-sm font-medium rounded bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors\"\n            >\n              Cancelar\n            </button>\n            <button\n              onClick={async () => {\n                try {\n                  setLoading(prev => ({ ...prev, delete: idToDelete }));\n                  await deleteHour(idToDelete);\n                  \n                  // Cerrar el toast\n                  toast.dismiss(toastId);\n                  \n                  // Mostrar mensaje de éxito\n                  toast.success('Actividad eliminada correctamente', { \n                    duration: 3000,\n                  });\n                  \n                  // Actualizar la lista de actividades\n                  refreshDailyActivities(selectedDate, String(employeeId));\n                  \n                  // Si la actividad eliminada es la que se estaba editando, limpiar el formulario\n                  if (editingActivityId === idToDelete) {\n                    resetForm();\n                  }\n                  \n                } catch (error) {\n                  console.error('Error al eliminar la actividad:', error);\n                  toast.error('Error al eliminar la actividad. Por favor, intente nuevamente.', { \n                    duration: 4000,\n                  });\n                } finally {\n                  setLoading(prev => ({ ...prev, delete: null }));\n                }\n              }}\n              disabled={loading.delete === idToDelete}\n              className=\"px-4 py-2 text-sm font-medium rounded bg-destructive text-destructive-foreground hover:bg-destructive/90 transition-colors flex items-center\"\n            >\n              {loading.delete === idToDelete ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Eliminando...\n                </>\n              ) : (\n                'Eliminar'\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    ), {\n      id: toastId,\n      duration: 10000,\n      position: 'top-center',\n    });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validar campos requeridos\n    if (!formData.project_code || !formData.phase || !formData.discipline || !formData.activity || !formData.hours) {\n      toast.error('Por favor complete todos los campos requeridos.', { duration: 3000 });\n      return;\n    }\n\n    // Validar formato de horas\n    const hoursValue = parseFloat(formData.hours.replace(',', '.'));\n    if (isNaN(hoursValue) || hoursValue <= 0) {\n      toast.error('Por favor ingrese un número válido de horas.', { duration: 3000 });\n      return;\n    }\n\n    setLoading((prev) => ({ ...prev, submit: true }));\n\n    try {\n      // Preparar datos para enviar\n      const submissionData = {\n        ...formData,\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        project_name: projects.find(p => p.code === formData.project_code)?.name || formData.project_code,\n        hours: hoursValue, // Usar el valor numérico normalizado\n        employee_id: employeeId,\n        id: editingActivityId || undefined,\n      };\n\n      // Enviar datos\n      await submitHours(submissionData);\n      \n      // Mostrar mensaje de éxito\n      toast.success(\n        `Actividad ${editingActivityId ? 'actualizada' : 'guardada'} con éxito.`,\n        {\n          duration: 3000,\n          style: { \n            backgroundColor: '#28a745', \n            color: 'white', \n            border: 'none',\n            fontSize: '14px',\n            padding: '12px 20px',\n            borderRadius: '4px'\n          },\n        }\n      );\n      \n      // Limpiar formulario y actualizar lista de actividades\n      resetForm();\n      refreshDailyActivities(selectedDate, String(employeeId));\n      \n      // Llamar a la función de éxito si existe\n      if (onSuccess) {\n        onSuccess();\n      }\n      \n    } catch (error) {\n      console.error('Error al guardar la actividad:', error);\n      toast.error(\n        'Error al guardar la actividad. Por favor, intente nuevamente.', \n        { \n          duration: 4000,\n          style: { \n            backgroundColor: '#dc3545', \n            color: 'white',\n            fontSize: '14px',\n            padding: '12px 20px',\n            borderRadius: '4px'\n          } \n        }\n      );\n    } finally {\n      setLoading((prev) => ({ ...prev, submit: false }));\n    }\n  };\n\n  // Render\n  return (\n    <div>\n      <Header userName={employeeName} onLogout={onLogout} />\n      <div className=\"container mx-auto p-4 sm:p-6 lg:p-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-8\">\n          <main className=\"lg:col-span-3\">\n            {/* z-10 evita que el Popover tape el botón */}\n            <Card className=\"relative z-10\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-center\">\n                  {editingActivityId ? (\n                    <Pencil className=\"mr-2 h-5 w-5\" />\n                  ) : (\n                    <PlusCircle className=\"mr-2 h-5 w-5\" />\n                  )}\n                  {editingActivityId ? 'Editar Actividad' : 'Registrar Actividad'}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\n                  <div className=\"w-full md:w-1/3\">\n                    <label\n                      htmlFor=\"date\"\n                      className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                    >\n                      Fecha\n                    </label>\n\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <Button\n                          variant=\"outline\"\n                          className={cn(\n                            'w-full justify-start text-left font-normal',\n                            !selectedDate && 'text-muted-foreground'\n                          )}\n                        >\n                          <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                          {selectedDate ? (\n                            <span>{format(selectedDate, 'PPP', { locale: es })}</span>\n                          ) : (\n                            <span>Seleccione una fecha</span>\n                          )}\n                        </Button>\n                      </PopoverTrigger>\n\n                      <PopoverContent className=\"w-auto p-0\">\n                        <Calendar\n                          mode=\"single\"\n                          selected={selectedDate}\n                          onSelect={handleDateChange}\n                          initialFocus\n                          locale={es}\n                        />\n                      </PopoverContent>\n                    </Popover>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <FormSelect\n                      label=\"Código de Proyecto\"\n                      name=\"project_code\"\n                      value={formData.project_code}\n                      onValueChange={handleSelectChange}\n                      options={projects.map((p) => ({\n                        value: p.code,\n                        label: p.code, // En el trigger solo se ve el código\n                        dropdownLabel: `${p.code} - ${p.name}`, // En la lista: código - nombre\n                      }))}\n                      placeholder=\"Seleccione un proyecto\"\n                      loading={loading.projects}\n                      disabled={loading.projects}\n                      icon={<Briefcase className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <div className=\"space-y-2\">\n                      <label className=\"block text-sm font-medium text-foreground/80 mb-1\">\n                        Nombre del Proyecto\n                      </label>\n                      <Input value={selectedProjectName} readOnly className=\"bg-muted/50\" />\n                    </div>\n\n                    <FormSelect\n                      label=\"Etapa\"\n                      name=\"phase\"\n                      value={formData.phase}\n                      onValueChange={handleSelectChange}\n                      options={stages.map((s) => ({ value: s, label: s }))}\n                      placeholder=\"Seleccione una etapa\"\n                      loading={loading.stages}\n                      disabled={!formData.project_code || loading.stages}\n                      icon={<ListChecks className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <FormSelect\n                      label=\"Disciplina\"\n                      name=\"discipline\"\n                      value={formData.discipline}\n                      onValueChange={handleSelectChange}\n                      options={disciplines.map((d) => ({ value: d, label: d }))}\n                      placeholder=\"Seleccione una disciplina\"\n                      loading={loading.disciplines}\n                      disabled={!formData.phase || loading.disciplines}\n                      icon={<Pencil className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <FormSelect\n                      label=\"Actividad\"\n                      name=\"activity\"\n                      value={formData.activity}\n                      onValueChange={handleSelectChange}\n                      options={activities.map((a) => ({ value: a, label: a }))}\n                      placeholder=\"Seleccione una actividad\"\n                      loading={loading.activities}\n                      disabled={!formData.discipline || loading.activities}\n                      icon={<ClipboardList className=\"h-4 w-4\" />}\n                      required\n                    />\n\n                    <div className=\"space-y-2\">\n                      <label\n                        htmlFor=\"hours\"\n                        className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                      >\n                        Horas <span className=\"text-destructive\">*</span>\n                      </label>\n                      <Input\n                        id=\"hours\"\n                        name=\"hours\"\n                        type=\"number\"\n                        value={formData.hours}\n                        onChange={handleChange}\n                        min=\"0.5\"\n                        step=\"0.5\"\n                        required\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label\n                      htmlFor=\"note\"\n                      className=\"block text-sm font-medium text-foreground/80 mb-1\"\n                    >\n                      Nota (Opcional)\n                    </label>\n                    <textarea\n                      id=\"note\"\n                      name=\"note\"\n                      value={formData.note}\n                      onChange={handleChange}\n                      onKeyDown={handleNoteKeyDown}\n                      rows={3}\n                      className=\"flex h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n                      placeholder=\"Escriba una nota (opcional)\"\n                    />\n                  </div>\n\n                  <div className=\"flex justify-end items-center gap-3 pt-4\">\n                    {editingActivityId && (\n                      <Button type=\"button\" variant=\"outline\" onClick={resetForm}>\n                        <XCircle className=\"mr-2 h-4 w-4\" />\n                        Cancelar Edición\n                      </Button>\n                    )}\n\n                    <Button\n                      type=\"submit\"\n                      disabled={!isFormValid || loading.submit}\n                      className=\"min-w-[150px]\"\n                    >\n                      {loading.submit ? (\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Save className=\"mr-2 h-4 w-4\" />\n                      )}\n                      {editingActivityId ? 'Actualizar' : 'Guardar'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </main>\n\n          <aside className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-center\">Actividades del Día</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {loading.dailyActivities ? (\n                    <ActivityListSkeleton />\n                  ) : dailyActivities.length > 0 ? (\n                    dailyActivities.map((activity) => (\n                      <ActivityItem\n                        key={activity.id}\n                        activity={activity}\n                        onEdit={handleEditActivity}\n                        onDelete={handleDelete}\n                      />\n                    ))\n                  ) : (\n                    <EmptyState />\n                  )}\n                </div>\n                <div className=\"mt-6\">\n                  <TotalHoursProgress totalHours={totalHoursToday} selectedDate={selectedDate} />\n                </div>\n              </CardContent>\n            </Card>\n          </aside>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default FormularioHoras;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}